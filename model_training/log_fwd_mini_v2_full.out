nohup: ignoring input
4
4
4
4
Starting fresh run with new ID: cj2japi4 (ignoring existing wandb_run_id.txt)

rank: 3

rank: 2
Load custom tokenizer from cache/gpt2_neuro_tokenizer
Load custom tokenizer from cache/gpt2_neuro_tokenizer

rank: 1
Load custom tokenizer from cache/gpt2_neuro_tokenizer
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
wandb: Currently logged in as: kenotron. Use `wandb login --relogin` to force relogin
len(train_dataloader) = 1048
len(train_dataloader) = 1048
len(train_dataloader) = 1048
wandb: wandb version 0.19.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.2
wandb: Run data is saved locally in /datadrive1/ken/projects/backwards/model_training/wandb/run-20250328_142040-cj2japi4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run soft-valley-339
wandb: ‚≠êÔ∏è View project at https://wandb.ai/kenotron/brainlessgpt
wandb: üöÄ View run at https://wandb.ai/kenotron/brainlessgpt/runs/cj2japi4

rank: 0
Load custom tokenizer from cache/gpt2_neuro_tokenizer
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
len(train_dataloader) = 1048
After prepare, len(train_dataloader) = 262
Start training
After prepare, len(train_dataloader) = 262
Start training
After prepare, len(train_dataloader) = 262
Start training
After prepare, len(train_dataloader) = 262
Start training

rank 0 | epoch 0 | step 0 | batch 0


Running epoch 0, step 0, batch 0

rank 1 | epoch 0 | step 0 | batch 0


Running epoch 0, step 0, batch 0
Sampled inputs[:2]: tensor([[    0,  7303,    12,  ...,  1085,   413,   711],
        [    0, 27342,    17,  ...,  5125,  3244,   287]], device='cuda:0')
Sampled inputs[:2]: tensor([[   0,  825, 1243,  ...,   15,   22,   42],
        [   0,  669,  292,  ..., 4032,  271, 4442]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 3 | epoch 0 | step 0 | batch 0


Running epoch 0, step 0, batch 0

rank 2 | epoch 0 | step 0 | batch 0


Running epoch 0, step 0, batch 0
Sampled inputs[:2]: tensor([[    0,    30,  1869,  ...,  4998, 44266,    12],
        [    0,   669,  1528,  ..., 21826,   259,  5024]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 7555, 3908,  ...,  259, 8477,  278],
        [   0,  623,   12,  ..., 4792, 6572,  300]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 0, Loss: 1.3781282901763916
rank: 2, step 0, Loss: 1.3782353401184082
rank: 3, step 0, Loss: 1.374083161354065
rank: 1, step 0, Loss: 1.3736037015914917




rank 3 | epoch 0 | step 1 | batch 1
rank 2 | epoch 0 | step 1 | batch 1


rank 1 | epoch 0 | step 1 | batch 1


Running epoch 0, step 1, batch 1


Running epoch 0, step 1, batch 1


Running epoch 0, step 1, batch 1

rank 0 | epoch 0 | step 1 | batch 1


Running epoch 0, step 1, batch 1
Sampled inputs[:2]: tensor([[    0,  2270,  3279,  ...,   380,   475,   768],
        [    0,   344,  8260,  ..., 16020, 18216, 11348]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,    14,  7870,  ...,   284,   830,   292],
        [    0,  4356, 12286,  ...,  3352,   275,  2879]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   301,   298,  ..., 10030,   300,  3780],
        [    0, 29073,   916,  ...,    12,   287,   850]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[    0,  3235,   471,  ...,  1967,  4273,  2738],
        [    0,  2165,  9311,  ..., 10570,   437,   266]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 1, Loss: 1.3743900060653687
rank: 1, step 1, Loss: 1.3754276037216187
rank: 2, step 1, Loss: 1.376225233078003
rank: 0, step 1, Loss: 1.3752291202545166




rank 3 | epoch 0 | step 2 | batch 2
rank 0 | epoch 0 | step 2 | batch 2

rank 2 | epoch 0 | step 2 | batch 2

rank 1 | epoch 0 | step 2 | batch 2


Running epoch 0, step 2, batch 2


Running epoch 0, step 2, batch 2



Running epoch 0, step 2, batch 2


Running epoch 0, step 2, batch 2
Sampled inputs[:2]: tensor([[    0,   266,  5528,  ...,   685,   266,  1231],
        [    0,  2561,  4994,  ..., 10407,   287,  1339]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  259, 1143,  ...,  593,  360,  278],
        [   0,  300, 7239,  ..., 2283, 4890,   14]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   374,  5195,  ...,   266,  5555,    14],
        [    0,   344,   259,  ...,  6787, 10045,  9799]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  2372,  1319,  ...,  1253,   292, 34166],
        [    0,   437,   266,  ...,   266, 16084,  1781]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 2, Loss: 1.3780685663223267
rank: 2, step 2, Loss: 1.3756003379821777
rank: 1, step 2, Loss: 1.3806228637695312
rank: 0, step 2, Loss: 1.3781237602233887




rank 0 | epoch 0 | step 3 | batch 3

rank 3 | epoch 0 | step 3 | batch 3
rank 2 | epoch 0 | step 3 | batch 3

rank 1 | epoch 0 | step 3 | batch 3


Running epoch 0, step 3, batch 3


Running epoch 0, step 3, batch 3


Running epoch 0, step 3, batch 3



Running epoch 0, step 3, batch 3
Sampled inputs[:2]: tensor([[   0, 3658,  271,  ...,  278,  970,   12],
        [   0,    5, 7523,  ...,  199, 8871,  266]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  298,  374,  ...,  298,  413,   28],
        [   0,  266, 3634,  ...,  694,  266, 1784]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  4667,   446,  ...,  1868, 16028,   669],
        [    0,  1943,  1837,  ...,   870,   287,   266]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,   275,  2576,  3588],
        [    0,   221,   474,  ..., 19245,   565,    14]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 3, Loss: 1.3746083974838257
rank: 1, step 3, Loss: 1.3761365413665771
rank: 2, step 3, Loss: 1.3751813173294067
rank: 3, step 3, Loss: 1.3748332262039185




rank 0 | epoch 0 | step 4 | batch 4


Running epoch 0, step 4, batch 4

rank 3 | epoch 0 | step 4 | batch 4

rank 1 | epoch 0 | step 4 | batch 4


Running epoch 0, step 4, batch 4

rank 2 | epoch 0 | step 4 | batch 4


Running epoch 0, step 4, batch 4


Running epoch 0, step 4, batch 4
Sampled inputs[:2]: tensor([[    0,    27,  3961,  ...,   462,   221,   474],
        [    0,  1526,   422,  ..., 22454,   409, 31482]], device='cuda:0')Sampled inputs[:2]: tensor([[   0, 3125,  271,  ..., 1041, 1032,   15],
        [   0,  995,   13,  ..., 3494,  367, 6768]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   380,   981,  ...,   567,  5407,   472],
        [    0,  6143,   642,  ...,   199, 14300,    41]], device='cuda:1')Sampled inputs[:2]: tensor([[   0,   76,   15,  ...,   14,  333,  199],
        [   0,  367, 3704,  ..., 1746,   14,  759]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



rank: 3, step 4, Loss: 1.3764057159423828
rank: 2, step 4, Loss: 1.3760123252868652
rank: 1, step 4, Loss: 1.3808878660202026
rank: 0, step 4, Loss: 1.3779361248016357




rank 3 | epoch 0 | step 5 | batch 5

rank 1 | epoch 0 | step 5 | batch 5
rank 2 | epoch 0 | step 5 | batch 5


Running epoch 0, step 5, batch 5



Running epoch 0, step 5, batch 5


Running epoch 0, step 5, batch 5

rank 0 | epoch 0 | step 5 | batch 5


Running epoch 0, step 5, batch 5
Sampled inputs[:2]: tensor([[    0,   843,    14,  ...,   659,   271, 10511],
        [    0,    13, 38195,  ...,   950,   298,   257]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   89, 2023,  ...,  271,   13,  704],
        [   0,  493,  221,  ...,  259,  726, 2786]], device='cuda:1')Sampled inputs[:2]: tensor([[   0, 4665,  909,  ..., 3607,  259, 1108],
        [   0, 4385,  342,  ..., 3644,  775,  874]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 6328,   12,  ...,  417,  199, 1726],
        [   0,   19,  669,  ...,   14, 4053,  352]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 5, Loss: 1.3767560720443726
rank: 3, step 5, Loss: 1.3793458938598633
rank: 0, step 5, Loss: 1.374396562576294

rank: 2, step 5, Loss: 1.3729788064956665



rank 3 | epoch 0 | step 6 | batch 6

rank 1 | epoch 0 | step 6 | batch 6

rank 2 | epoch 0 | step 6 | batch 6
rank 0 | epoch 0 | step 6 | batch 6


Running epoch 0, step 6, batch 6


Running epoch 0, step 6, batch 6


Running epoch 0, step 6, batch 6



Running epoch 0, step 6, batch 6
Sampled inputs[:2]: tensor([[   0,    9,  292,  ...,  944,  278, 1758],
        [   0,  287,  358,  ...,  328, 1704, 3227]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   25,   26,  ...,    9,  287,  298],
        [   0,  278,  634,  ...,  598, 1722,  591]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  5489,    80,  ...,   221,   380,   333],
        [    0,  5750,   642,  ...,   221, 15441,   644]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   328,   957,  ...,   298,   275,  8570],
        [    0,   300, 11040,  ...,   266,  1736,  3487]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 6, Loss: 1.3761378526687622
rank: 1, step 6, Loss: 1.376885175704956
rank: 0, step 6, Loss: 1.376728892326355
rank: 2, step 6, Loss: 1.3779277801513672




rank 3 | epoch 0 | step 7 | batch 7
rank 1 | epoch 0 | step 7 | batch 7

rank 2 | epoch 0 | step 7 | batch 7

rank 0 | epoch 0 | step 7 | batch 7


Running epoch 0, step 7, batch 7


Running epoch 0, step 7, batch 7


Running epoch 0, step 7, batch 7



Running epoch 0, step 7, batch 7
Sampled inputs[:2]: tensor([[    0,   792,    83,  ...,   300,   768,   932],
        [    0,  3412,  1707,  ..., 11114,    15,  1821]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   970,    13,  ..., 13798,    14,  1841],
        [    0, 41855,     9,  ..., 33073,   401,  4528]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  7036,   278,  ...,   221,   290,   446],
        [    0,   400, 27972,  ..., 22726,  1871,    14]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   287,  2269,  ..., 22413,   391,   266],
        [    0,   600,    14,  ...,   221,  8187,  1802]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 7, Loss: 1.3751144409179688
rank: 1, step 7, Loss: 1.3760758638381958
rank: 2, step 7, Loss: 1.3749045133590698
rank: 0, step 7, Loss: 1.3772367238998413



Graident accumulation at epoch 0, step 7, batch 7
Graident accumulation at epoch 0, step 7, batch 7
Graident accumulation at epoch 0, step 7, batch 7
Graident accumulation at epoch 0, step 7, batch 7

rank 3 | epoch 0 | step 8 | batch 8

rank 1 | epoch 0 | step 8 | batch 8

rank 0 | epoch 0 | step 8 | batch 8

Running epoch 0, step 8, batch 8


Running epoch 0, step 8, batch 8


rank 2 | epoch 0 | step 8 | batch 8


Running epoch 0, step 8, batch 8

Running epoch 0, step 8, batch 8

Sampled inputs[:2]: tensor([[    0,   944,   278,  ...,  2374,   699,  8867],
        [    0, 39224,    34,  ...,   401,  1716,   271]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  1412, 11275,  ...,   668, 14849,   367],
        [    0,   257,   298,  ...,  3768,   271,   266]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1615,   328,  ...,   266,  3133,   963],
        [    0,    67,   695,  ...,   437,   266, 44563]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    12, 32425,  ...,   389,   221,   494],
        [    0, 25938,   359,  ...,    36, 15859,   504]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 8, Loss: 1.387484073638916
rank: 1, step 8, Loss: 1.38116455078125
rank: 2, step 8, Loss: 1.3786263465881348
rank: 0, step 8, Loss: 1.3793302774429321




rank 0 | epoch 0 | step 9 | batch 9


Running epoch 0, step 9, batch 9
rank 3 | epoch 0 | step 9 | batch 9


rank 2 | epoch 0 | step 9 | batch 9


Running epoch 0, step 9, batch 9

rank 1 | epoch 0 | step 9 | batch 9

Running epoch 0, step 9, batch 9



Running epoch 0, step 9, batch 9
Sampled inputs[:2]: tensor([[    0,   461,  1169,  ..., 14135,  2771,    13],
        [    0,  2258, 10315,  ...,  4185,  9433,   221]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   266,  4908,  ...,  1209,   328,  1603],
        [    0, 10334,    17,  ...,   391,  1566, 24837]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,    14,  1032,  ...,   292,   494,  2065],
        [    0,   266, 10262,  ...,   271,  3437,  4392]], device='cuda:2')


Sampled inputs[:2]: tensor([[   0,   26, 4044,  ..., 9531,  365,  993],
        [   0, 3968,  446,  ...,   22,  722,  342]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 9, Loss: 1.3747303485870361
rank: 0, step 9, Loss: 1.379740834236145
rank: 1, step 9, Loss: 1.3736279010772705
rank: 2, step 9, Loss: 1.3813679218292236




rank 0 | epoch 0 | step 10 | batch 10


Running epoch 0, step 10, batch 10
rank 3 | epoch 0 | step 10 | batch 10


rank 2 | epoch 0 | step 10 | batch 10


Running epoch 0, step 10, batch 10


Running epoch 0, step 10, batch 10

rank 1 | epoch 0 | step 10 | batch 10


Running epoch 0, step 10, batch 10
Sampled inputs[:2]: tensor([[    0,   367,  3675,  ...,    22,  3180,    14],
        [    0, 12686, 18519,  ...,   328,   912,  3978]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  278, 7524,  ..., 1288,  669,  352],
        [   0,   12,  298,  ...,  292,   36,    9]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   278, 30377,  ...,    13,    83,  2908],
        [    0,   367,  3399,  ..., 13481,   408,  6944]], device='cuda:2')


Sampled inputs[:2]: tensor([[   0,   12,  342,  ..., 3458,  271,  266],
        [   0,  843, 3365,  ..., 1136, 1615,  292]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 10, Loss: 1.3795760869979858
rank: 1, step 10, Loss: 1.3783795833587646
rank: 2, step 10, Loss: 1.3769632577896118

rank: 0, step 10, Loss: 1.380441427230835



rank 0 | epoch 0 | step 11 | batch 11
rank 3 | epoch 0 | step 11 | batch 11



Running epoch 0, step 11, batch 11

rank 1 | epoch 0 | step 11 | batch 11

rank 2 | epoch 0 | step 11 | batch 11

Running epoch 0, step 11, batch 11


Running epoch 0, step 11, batch 11


Running epoch 0, step 11, batch 11

Sampled inputs[:2]: tensor([[   0,  417,  199,  ..., 8762, 4204,  391],
        [   0, 3308,  259,  ...,   14, 6349, 1389]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   292,    40,  ..., 26995,   278,   717],
        [    0,   271,  3403,  ...,  6168,   300,  2257]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0, 14949,    12,  ...,   669, 10168,  7166],
        [    0,  4448,    12,  ...,  3183,   328,  9559]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  275, 2101,  ..., 1145,  590, 1619],
        [   0,   13, 4831,  ...,  333,  199, 2038]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 11, Loss: 1.3772679567337036
rank: 2, step 11, Loss: 1.3766958713531494
rank: 1, step 11, Loss: 1.3763172626495361
rank: 0, step 11, Loss: 1.3838766813278198




rank 0 | epoch 0 | step 12 | batch 12

rank 3 | epoch 0 | step 12 | batch 12

Running epoch 0, step 12, batch 12

rank 2 | epoch 0 | step 12 | batch 12

rank 1 | epoch 0 | step 12 | batch 12

Running epoch 0, step 12, batch 12




Running epoch 0, step 12, batch 12


Running epoch 0, step 12, batch 12
Sampled inputs[:2]: tensor([[    0,  1581, 11884,  ...,  7031,   689,   527],
        [    0,    12,  1197,  ...,   352,  2513,   266]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,  271, 4219,  ...,  644,   14, 3607],
        [   0,  668, 2474,  ...,  668, 4599,  360]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  278, 8608,  ...,  293, 1608,  391],
        [   0, 4154,   12,  ...,   14,  560,  199]], device='cuda:0')Sampled inputs[:2]: tensor([[    0, 43788,    12,  ...,    12,  6288,   391],
        [    0,   401,  9370,  ...,     9,   287,   518]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 12, Loss: 1.3775012493133545
rank: 2, step 12, Loss: 1.3769426345825195
rank: 1, step 12, Loss: 1.3772884607315063
rank: 3, step 12, Loss: 1.3787339925765991




rank 0 | epoch 0 | step 13 | batch 13

rank 3 | epoch 0 | step 13 | batch 13

Running epoch 0, step 13, batch 13

rank 1 | epoch 0 | step 13 | batch 13


Running epoch 0, step 13, batch 13



Running epoch 0, step 13, batch 13

rank 2 | epoch 0 | step 13 | batch 13


Running epoch 0, step 13, batch 13
Sampled inputs[:2]: tensor([[    0,  1575,  4384,  ...,   328,   722,  6124],
        [    0, 16028,   669,  ...,   292,  6502,  7050]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  874,  590,  ...,  300,  867,  638],
        [   0,  726, 8241,  ...,  266, 5994,    9]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 3448,  278,  ...,  380,  333,  199],
        [   0,  271,  266,  ..., 8122, 1387,  616]], device='cuda:1')

Sampled inputs[:2]: tensor([[    0, 31571,    13,  ...,   367,  2177,   271],
        [    0, 21801, 13084,  ...,  1738,  2946,    12]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 13, Loss: 1.3760402202606201
rank: 3, step 13, Loss: 1.3754429817199707
rank: 0, step 13, Loss: 1.3835172653198242
rank: 2, step 13, Loss: 1.3737101554870605




rank 3 | epoch 0 | step 14 | batch 14

rank 1 | epoch 0 | step 14 | batch 14


Running epoch 0, step 14, batch 14

rank 2 | epoch 0 | step 14 | batch 14
rank 0 | epoch 0 | step 14 | batch 14


Running epoch 0, step 14, batch 14


Running epoch 0, step 14, batch 14



Running epoch 0, step 14, batch 14
Sampled inputs[:2]: tensor([[    0,    12,   266,  ...,    13,   635,    13],
        [    0,   369, 19287,  ..., 12502,  6626,   292]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 20080, 11069,  ...,   300,  5768,   271],
        [    0,  7066,  2737,  ...,  2269,   271,   927]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 1142,   87,  ..., 2273,  287,  829],
        [   0,  591, 2036,  ...,  266, 1027,  278]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  445,   16,  ..., 7747, 5308, 6216],
        [   0,   12, 9248,  ..., 2673, 4239,  292]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 14, Loss: 1.3783541917800903
rank: 1, step 14, Loss: 1.3773425817489624
rank: 2, step 14, Loss: 1.3832534551620483
rank: 0, step 14, Loss: 1.3729172945022583




rank 3 | epoch 0 | step 15 | batch 15
rank 0 | epoch 0 | step 15 | batch 15


Running epoch 0, step 15, batch 15



Running epoch 0, step 15, batch 15
rank 1 | epoch 0 | step 15 | batch 15
rank 2 | epoch 0 | step 15 | batch 15




Running epoch 0, step 15, batch 15

Running epoch 0, step 15, batch 15

Sampled inputs[:2]: tensor([[    0,  5635,   328,  ...,   287, 27260,   271],
        [    0,   471,   590,  ...,  5007,    13,  2920]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 4350,   14,  ...,  266, 9479,  944],
        [   0,  360, 2374,  ...,  221,  474,  357]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   266, 15794,  ...,  3128,  6479,  2626],
        [    0,   287,   768,  ...,   221,   474,   221]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,   266, 28695,  ...,   278,   266,  6087],
        [    0,   949, 11135,  ...,   278,   772,    13]], device='cuda:2')


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



rank: 1, step 15, Loss: 1.3786120414733887
rank: 0, step 15, Loss: 1.3769571781158447
rank: 2, step 15, Loss: 1.3763337135314941

rank: 3, step 15, Loss: 1.3766865730285645


Graident accumulation at epoch 0, step 15, batch 15
Graident accumulation at epoch 0, step 15, batch 15
Graident accumulation at epoch 0, step 15, batch 15
Graident accumulation at epoch 0, step 15, batch 15

rank 3 | epoch 0 | step 16 | batch 16


Running epoch 0, step 16, batch 16

rank 1 | epoch 0 | step 16 | batch 16

rank 0 | epoch 0 | step 16 | batch 16

Running epoch 0, step 16, batch 16
rank 2 | epoch 0 | step 16 | batch 16



Running epoch 0, step 16, batch 16



Running epoch 0, step 16, batch 16
Sampled inputs[:2]: tensor([[    0,    12,   616,  ...,   278,   266,  2907],
        [    0, 22599,  1336,  ...,   729,   923,    13]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   292,  2908,  ..., 16658,  7440,   271],
        [    0,  2426,   699,  ...,   221,  1551,   720]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   300,  3808,  ...,   496,    14,  1364],
        [    0,  1420,  2337,  ...,   722, 28860,   287]], device='cuda:2')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  4855, 15679,  ...,   278,   266,  1912],
        [    0,   271,   266,  ...,    70,    27,  5311]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 16, Loss: 1.294252634048462
rank: 1, step 16, Loss: 1.2953059673309326
rank: 2, step 16, Loss: 1.3010252714157104
rank: 0, step 16, Loss: 1.3014439344406128




rank 0 | epoch 0 | step 17 | batch 17
rank 3 | epoch 0 | step 17 | batch 17

rank 2 | epoch 0 | step 17 | batch 17



Running epoch 0, step 17, batch 17


Running epoch 0, step 17, batch 17


Running epoch 0, step 17, batch 17

rank 1 | epoch 0 | step 17 | batch 17


Running epoch 0, step 17, batch 17
Sampled inputs[:2]: tensor([[    0,   600,   518,  ...,  3134,   278, 37342],
        [    0,    13,    41,  ...,     5,   271,  2936]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 14165,    14,  ..., 34395, 31103,  6905],
        [    0,   806,   300,  ...,   360,  4918,  1106]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 2939,   14,  ..., 1702, 1481,  278],
        [   0,  281,   82,  ..., 2485,  417,  199]], device='cuda:0')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,   401,  1576,   271],
        [    0, 17508,    65,  ...,  8848, 13900,   796]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 17, Loss: 1.3063682317733765
rank: 3, step 17, Loss: 1.303137183189392
rank: 0, step 17, Loss: 1.2936699390411377
rank: 2, step 17, Loss: 1.3048628568649292




rank 0 | epoch 0 | step 18 | batch 18
rank 3 | epoch 0 | step 18 | batch 18


Running epoch 0, step 18, batch 18


rank 1 | epoch 0 | step 18 | batch 18
rank 2 | epoch 0 | step 18 | batch 18



Running epoch 0, step 18, batch 18

Running epoch 0, step 18, batch 18

Running epoch 0, step 18, batch 18


Sampled inputs[:2]: tensor([[   0, 4902,  518,  ..., 5493, 3227,  278],
        [   0, 1850,  311,  ..., 3655, 3133, 9000]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  5685,   565,  ..., 23968,    14,   381],
        [    0,   278,  6653,  ...,  7524,   271, 28279]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   508,  1548,  ...,   494, 10792,     9],
        [    0,    41,     7,  ...,   496,    14,  4075]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   271, 28279,  ...,   367,   806,   271],
        [    0,   287, 39084,  ...,   266,  1817,  1589]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 18, Loss: 1.303252100944519
rank: 1, step 18, Loss: 1.2994877099990845
rank: 0, step 18, Loss: 1.299486517906189
rank: 2, step 18, Loss: 1.299250841140747




rank 0 | epoch 0 | step 19 | batch 19
rank 3 | epoch 0 | step 19 | batch 19



Running epoch 0, step 19, batch 19


Running epoch 0, step 19, batch 19
rank 1 | epoch 0 | step 19 | batch 19



Running epoch 0, step 19, batch 19

rank 2 | epoch 0 | step 19 | batch 19


Running epoch 0, step 19, batch 19
Sampled inputs[:2]: tensor([[    0,    18,    14,  ...,   300,   275,  1184],
        [    0,  2255, 21868,  ...,   591,  5902,   259]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 3634, 3444,  ...,  642, 2156,  266],
        [   0,   13, 5005,  ...,  654,  344,  259]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   199,   769,  ...,   380,   560,   199],
        [    0,   380,  6119,  ..., 11823,   287,  6797]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  2706,   292,  ...,    13,  8954,    13],
        [    0,   668,  1837,  ...,  4381,    14, 11451]], device='cuda:2')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 19, Loss: 1.297405481338501
rank: 1, step 19, Loss: 1.3100793361663818
rank: 2, step 19, Loss: 1.298571228981018
rank: 0, step 19, Loss: 1.2961900234222412




rank 0 | epoch 0 | step 20 | batch 20
rank 3 | epoch 0 | step 20 | batch 20



Running epoch 0, step 20, batch 20


Running epoch 0, step 20, batch 20
rank 1 | epoch 0 | step 20 | batch 20

rank 2 | epoch 0 | step 20 | batch 20



Running epoch 0, step 20, batch 20


Running epoch 0, step 20, batch 20
Sampled inputs[:2]: tensor([[    0,    14,    22,  ...,  1319,   271,   266],
        [    0, 26473,  2117,  ...,    13,  3292,   950]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  824,   14,  ...,  278, 9328, 1049],
        [   0, 2220, 1110,  ...,  382,   18,   13]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  1552,   271,  ...,    13,   287,   995],
        [    0,   365,   984,  ..., 18562,  4237, 31813]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3398,   271,  ...,    13,  1581, 13600],
        [    0,    12,  3367,  ..., 16917, 12221, 12138]], device='cuda:2')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 20, Loss: 1.2980389595031738
rank: 1, step 20, Loss: 1.2979135513305664

rank: 2, step 20, Loss: 1.2957450151443481
rank: 0, step 20, Loss: 1.2953718900680542



rank 0 | epoch 0 | step 21 | batch 21

rank 3 | epoch 0 | step 21 | batch 21

Running epoch 0, step 21, batch 21


Running epoch 0, step 21, batch 21


rank 1 | epoch 0 | step 21 | batch 21

rank 2 | epoch 0 | step 21 | batch 21


Running epoch 0, step 21, batch 21


Running epoch 0, step 21, batch 21
Sampled inputs[:2]: tensor([[    0,   935,   508,  ...,   287, 41582,    12],
        [    0,   642,   287,  ...,   800,    12,  3338]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   298,   894,  ...,   396,   298,   527],
        [    0,   298, 22296,  ...,   287,  6494,   644]], device='cuda:0')

Sampled inputs[:2]: tensor([[   0, 1176,   13,  ..., 1919,  221,  380],
        [   0, 2579,  278,  ...,   56,    9,  271]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    20, 13016,  ...,    14,  2743,   516],
        [    0,  2771,  2070,  ...,   221,   396,   298]], device='cuda:2')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 0, step 21, Loss: 1.2924764156341553
rank: 1, step 21, Loss: 1.2824900150299072
rank: 3, step 21, Loss: 1.3016892671585083
rank: 2, step 21, Loss: 1.2992446422576904




rank 3 | epoch 0 | step 22 | batch 22


Running epoch 0, step 22, batch 22

rank 1 | epoch 0 | step 22 | batch 22

rank 2 | epoch 0 | step 22 | batch 22


Running epoch 0, step 22, batch 22


Running epoch 0, step 22, batch 22

rank 0 | epoch 0 | step 22 | batch 22


Running epoch 0, step 22, batch 22Sampled inputs[:2]: tensor([[   0, 3087,  342,  ...,   14,  381, 1416],
        [   0,   45, 6556,  ..., 1477,  352, 1611]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  496,   14,  ..., 1034, 4679,  278],
        [   0,  401,  266,  ...,  266, 2236, 1458]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 3353,   17,  ...,  596,   12,  461],
        [   0, 1823,   12,  ..., 1874,  271,  266]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   259,  1380,  ...,   287, 10221,   280],
        [    0,   278,  1295,  ...,  4337,   271,  1268]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 22, Loss: 1.2977919578552246
rank: 3, step 22, Loss: 1.3008161783218384
rank: 2, step 22, Loss: 1.300816297531128
rank: 0, step 22, Loss: 1.2960176467895508




rank 3 | epoch 0 | step 23 | batch 23


Running epoch 0, step 23, batch 23

rank 0 | epoch 0 | step 23 | batch 23
rank 1 | epoch 0 | step 23 | batch 23
rank 2 | epoch 0 | step 23 | batch 23




Running epoch 0, step 23, batch 23

Running epoch 0, step 23, batch 23



Running epoch 0, step 23, batch 23
Sampled inputs[:2]: tensor([[    0, 12305,  1179,  ...,  6321,   600,   271],
        [    0,   292, 21215,  ...,   266,   818,  1527]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  1526,  3502,  ..., 11727,  3736,  1661],
        [    0,   515,   266,  ...,    18,  3770,  1345]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   609,   271,  ...,   287, 15506, 14476],
        [    0,  1356,   634,  ...,  6604,   634,    14]], device='cuda:1')


Sampled inputs[:2]: tensor([[   0, 1920,   19,  ..., 5232,  796, 1303],
        [   0, 1500,  367,  ...,  344, 4250,  287]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 23, Loss: 1.2988290786743164
rank: 2, step 23, Loss: 1.2996304035186768
rank: 3, step 23, Loss: 1.2980128526687622
rank: 1, step 23, Loss: 1.2861326932907104



Graident accumulation at epoch 0, step 23, batch 23
Graident accumulation at epoch 0, step 23, batch 23
Graident accumulation at epoch 0, step 23, batch 23
Graident accumulation at epoch 0, step 23, batch 23

rank 3 | epoch 0 | step 24 | batch 24


Running epoch 0, step 24, batch 24

rank 0 | epoch 0 | step 24 | batch 24

rank 1 | epoch 0 | step 24 | batch 24
rank 2 | epoch 0 | step 24 | batch 24



Running epoch 0, step 24, batch 24

Running epoch 0, step 24, batch 24

Running epoch 0, step 24, batch 24


Sampled inputs[:2]: tensor([[   0, 4215, 1478,  ...,  644,  409, 3803],
        [   0,   12, 3067,  ..., 1381,  278, 5011]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   560, 23501,  ...,   292,   494,   221],
        [    0,  1034,   287,  ...,  9677,    13,  6687]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   437,  1690,  ...,  1274, 10695, 10762],
        [    0,   365,  1410,  ...,    12,  1478, 16062]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  1295,   898,  ...,   298, 38754,    66],
        [    0, 49018,   292,  ...,  8774,   642,   365]], device='cuda:2')


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 24, Loss: 1.2845443487167358
rank: 3, step 24, Loss: 1.2636897563934326
rank: 0, step 24, Loss: 1.2573046684265137
rank: 2, step 24, Loss: 1.2664967775344849




rank 0 | epoch 0 | step 25 | batch 25
rank 3 | epoch 0 | step 25 | batch 25



Running epoch 0, step 25, batch 25


Running epoch 0, step 25, batch 25
rank 1 | epoch 0 | step 25 | batch 25


rank 2 | epoch 0 | step 25 | batch 25


Running epoch 0, step 25, batch 25


Running epoch 0, step 25, batch 25
Sampled inputs[:2]: tensor([[    0,  5105,   271,  ...,   308,  3056,  3640],
        [    0,    14,  1062,  ..., 10417,    13, 30579]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  360,  259,  ...,   12,  358,   19],
        [   0, 2025,  287,  ...,  381, 1487, 3506]], device='cuda:0')
Sampled inputs[:2]: tensor([[   0,  266, 1034,  ..., 6153,  263,  472],
        [   0,   14, 4494,  ..., 4830,  368,  266]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 1688,  790,  ...,  546,  696,   12],
        [   0, 2229,  352,  ..., 4988,   33,   13]], device='cuda:2')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 1, step 25, Loss: 1.2668770551681519
rank: 3, step 25, Loss: 1.261874794960022
rank: 2, step 25, Loss: 1.2713781595230103



rank: 0, step 25, Loss: 1.275321125984192

rank 3 | epoch 0 | step 26 | batch 26


Running epoch 0, step 26, batch 26

rank 1 | epoch 0 | step 26 | batch 26
rank 2 | epoch 0 | step 26 | batch 26



Running epoch 0, step 26, batch 26

Running epoch 0, step 26, batch 26

Sampled inputs[:2]: tensor([[    0,   895,  4110,  ...,  1578,  1245,    13],
        [    0,  4566,   300,  ...,   271,  1644, 16473]], device='cuda:3')

rank 0 | epoch 0 | step 26 | batch 26Sampled inputs[:2]: tensor([[    0,   287,   266,  ..., 10238,    12, 39004],
        [    0,  1110, 26330,  ...,  1558,   674,  2351]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,   616,  2002,  ..., 19763,   642,   342],
        [    0,   278,  4575,  ...,  1220,   278,  4575]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]




Running epoch 0, step 26, batch 26
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 2341, 7956,  ..., 2355,  413,   72],
        [   0, 2680,  271,  ..., 4971,  278,  266]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 26, Loss: 1.2611383199691772
rank: 3, step 26, Loss: 1.2757920026779175
rank: 0, step 26, Loss: 1.2660187482833862
rank: 2, step 26, Loss: 1.2716389894485474




rank 3 | epoch 0 | step 27 | batch 27


Running epoch 0, step 27, batch 27

rank 1 | epoch 0 | step 27 | batch 27


Running epoch 0, step 27, batch 27

rank 0 | epoch 0 | step 27 | batch 27

rank 2 | epoch 0 | step 27 | batch 27


Running epoch 0, step 27, batch 27


Running epoch 0, step 27, batch 27
Sampled inputs[:2]: tensor([[   0, 1550,  685,  ...,  943, 1239,  996],
        [   0,  996, 2226,  ..., 5322,  287,  452]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 19191,   266,  ...,   287,   843,  1528],
        [    0,   446,  1845,  ...,   422,   221,   474]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  1597,   278,  ...,    20,    38,   446],
        [    0,    14,   475,  ...,  2117,  2792, 12848]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,   21, 1304,  ..., 3577,   13, 2497],
        [   0,  271, 2862,  ...,  287, 5699,   18]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 27, Loss: 1.2665448188781738
rank: 0, step 27, Loss: 1.2745040655136108
rank: 1, step 27, Loss: 1.259333610534668
rank: 2, step 27, Loss: 1.2591980695724487




rank 0 | epoch 0 | step 28 | batch 28
rank 3 | epoch 0 | step 28 | batch 28



Running epoch 0, step 28, batch 28


Running epoch 0, step 28, batch 28

rank 2 | epoch 0 | step 28 | batch 28


Running epoch 0, step 28, batch 28

rank 1 | epoch 0 | step 28 | batch 28


Running epoch 0, step 28, batch 28
Sampled inputs[:2]: tensor([[    0, 10064,   768,  ...,   266,  2816,   278],
        [    0,  4710,    12,  ...,  3969,     9, 11692]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   409,   729,  ...,   391,   266,   996],
        [    0,    14,  2729,  ...,   266,  1659, 14362]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    12,  3454,  ...,   717,  1765, 14906],
        [    0,    12,   287,  ...,   365,  1943,   259]], device='cuda:2')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[    0,  1171,  2926,  ...,   259,  4288,   654],
        [    0,   352,   721,  ...,   634, 17642,   278]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 28, Loss: 1.264828085899353
rank: 3, step 28, Loss: 1.2720977067947388
rank: 0, step 28, Loss: 1.2636749744415283

rank: 1, step 28, Loss: 1.2681742906570435



rank 0 | epoch 0 | step 29 | batch 29
rank 3 | epoch 0 | step 29 | batch 29


Running epoch 0, step 29, batch 29


rank 2 | epoch 0 | step 29 | batch 29
rank 1 | epoch 0 | step 29 | batch 29



Running epoch 0, step 29, batch 29

Running epoch 0, step 29, batch 29

Running epoch 0, step 29, batch 29


Sampled inputs[:2]: tensor([[    0,  1387,   369,  ..., 15722,    14,  8157],
        [    0,   369,   726,  ...,    83,   409,   729]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   680,   401,  ...,  2872,   292, 23535],
        [    0, 11435,  1226,  ...,    13,  1875,  6394]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  6541,   287,  ...,  1061,  4786,   292],
        [    0, 23070,   367,  ...,   287,   790,  3252]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0, 33315,   266,  ...,    12,  1126,    14],
        [    0,  7180,   266,  ...,  1805,    12,   221]], device='cuda:0')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 29, Loss: 1.269906997680664
rank: 2, step 29, Loss: 1.2675632238388062
rank: 1, step 29, Loss: 1.2614259719848633
rank: 3, step 29, Loss: 1.2745074033737183




rank 3 | epoch 0 | step 30 | batch 30

rank 0 | epoch 0 | step 30 | batch 30

Running epoch 0, step 30, batch 30

rank 2 | epoch 0 | step 30 | batch 30



Running epoch 0, step 30, batch 30

rank 1 | epoch 0 | step 30 | batch 30


Running epoch 0, step 30, batch 30

Running epoch 0, step 30, batch 30

Sampled inputs[:2]: tensor([[    0,   334,   344,  ...,   266,  4141,   287],
        [    0,   221,   264,  ...,  3613,  3222, 14000]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   266, 15324,  ...,   943,  1613,  7178],
        [    0,   879,    27,  ...,  3958,  2875,    14]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   953,   328,  ...,  2245,    12,  1253],
        [    0,   634,   631,  ...,  3431,   287, 27947]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,  380,  333,  ..., 8127,  504,  679],
        [   0, 4337, 2057,  ..., 3020, 1722,  369]], device='cuda:0')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 30, Loss: 1.262256383895874
rank: 3, step 30, Loss: 1.2693835496902466
rank: 0, step 30, Loss: 1.2653615474700928
rank: 2, step 30, Loss: 1.2656605243682861




rank 0 | epoch 0 | step 31 | batch 31
rank 3 | epoch 0 | step 31 | batch 31



Running epoch 0, step 31, batch 31

rank 1 | epoch 0 | step 31 | batch 31
rank 2 | epoch 0 | step 31 | batch 31

Running epoch 0, step 31, batch 31



Running epoch 0, step 31, batch 31

Running epoch 0, step 31, batch 31


Sampled inputs[:2]: tensor([[    0,   266,  3574,  ...,  7052,  3829,   292],
        [    0,   474,   221,  ..., 32291,   360,  2458]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  9088,  7217,  ...,   199, 17822,   278],
        [    0,    15,    19,  ...,   266,  6391,  1777]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  2663,    12,  ..., 24113,   497,    14],
        [    0,   199,  3289,  ...,  2269,  6476,   271]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0, 14094,    83,  ...,  1431,   221,   287],
        [    0, 18322,   287,  ...,   953,   271,   221]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 31, Loss: 1.2528482675552368
rank: 1, step 31, Loss: 1.2662392854690552
rank: 3, step 31, Loss: 1.2533159255981445
rank: 2, step 31, Loss: 1.269331693649292



Graident accumulation at epoch 0, step 31, batch 31
Graident accumulation at epoch 0, step 31, batch 31
Graident accumulation at epoch 0, step 31, batch 31
Graident accumulation at epoch 0, step 31, batch 31

rank 3 | epoch 0 | step 32 | batch 32


Running epoch 0, step 32, batch 32

rank 2 | epoch 0 | step 32 | batch 32

rank 1 | epoch 0 | step 32 | batch 32


Running epoch 0, step 32, batch 32


Running epoch 0, step 32, batch 32

rank 0 | epoch 0 | step 32 | batch 32
Sampled inputs[:2]: tensor([[    0,     7, 22455,  ...,    14,   747,  1501],
        [    0, 34525,  2008,  ...,  1194,   300, 11120]], device='cuda:3')


Running epoch 0, step 32, batch 32
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   300,   266,  ...,   271,  4111,  1188],
        [    0, 50208,   292,  ...,   408,   266,  3775]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  9829,   292,  ...,  2928,  1029,   271],
        [    0,   275,  1184,  ...,   328, 46278,  2117]], device='cuda:2')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 3253, 1573,  ...,  298,  358,   14],
        [   0,   17, 2736,  ...,  352,  422,   13]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 32, Loss: 1.2462090253829956
rank: 0, step 32, Loss: 1.24819815158844
rank: 3, step 32, Loss: 1.250368356704712

rank: 2, step 32, Loss: 1.2493232488632202



rank 0 | epoch 0 | step 33 | batch 33
rank 3 | epoch 0 | step 33 | batch 33



Running epoch 0, step 33, batch 33


Running epoch 0, step 33, batch 33
rank 1 | epoch 0 | step 33 | batch 33


rank 2 | epoch 0 | step 33 | batch 33


Running epoch 0, step 33, batch 33


Running epoch 0, step 33, batch 33
Sampled inputs[:2]: tensor([[    0, 28011,    12,  ...,   346,   462,   221],
        [    0,   638,  2708,  ..., 28492,  1814,    12]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  1480,   518,  ...,   445,    28,   445],
        [    0,    12,   287,  ...,   199,   769, 18432]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,   300,  6263,  ..., 18488,  1665,  1640],
        [    0,   413,    28,  ...,   328, 37605,  6499]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 6574, 1707,  ...,   14, 5077,   12],
        [   0,  417,  199,  ...,   13,   20, 6248]], device='cuda:2')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 1, step 33, Loss: 1.2627747058868408
rank: 3, step 33, Loss: 1.24626624584198
rank: 2, step 33, Loss: 1.2504874467849731
rank: 0, step 33, Loss: 1.246209979057312




rank 3 | epoch 0 | step 34 | batch 34


Running epoch 0, step 34, batch 34

rank 0 | epoch 0 | step 34 | batch 34

rank 2 | epoch 0 | step 34 | batch 34
rank 1 | epoch 0 | step 34 | batch 34



Running epoch 0, step 34, batch 34

Running epoch 0, step 34, batch 34

Running epoch 0, step 34, batch 34


Sampled inputs[:2]: tensor([[   0, 1503,  369,  ..., 1336,  271, 8429],
        [   0,   12, 2085,  ...,  287,  593, 4137]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  2530,   634,  ...,    15,  8808,     9],
        [    0,   271,   266,  ...,  2805,   607, 10848]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,    83,   292,  ...,   445,    11, 16109],
        [    0,  2523, 10780,  ...,  1041,    26, 13745]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 7185,  328,  ..., 1427, 1477, 1061],
        [   0,  292,   17,  ...,  265, 6943,   14]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 34, Loss: 1.2500253915786743
rank: 0, step 34, Loss: 1.255246877670288
rank: 3, step 34, Loss: 1.244962453842163
rank: 1, step 34, Loss: 1.2488341331481934




rank 3 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35

rank 1 | epoch 0 | step 35 | batch 35

rank 2 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35


Running epoch 0, step 35, batch 35

rank 0 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35
Sampled inputs[:2]: tensor([[   0, 1874,  300,  ...,   14, 5372,   12],
        [   0,  271, 3421,  ...,  306,  472,  346]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  278,  565,  ..., 1125, 5222,  287],
        [   0,  792,  287,  ...,  706, 9751,  278]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,     9,  8720,  ...,  1657,  1090, 27975],
        [    0,    12,   266,  ...,   674,   369,   259]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   598,   278,  ...,   437,   266,  2388],
        [    0, 27366,   504,  ...,  1358,   365,  6883]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 35, Loss: 1.2438647747039795
rank: 1, step 35, Loss: 1.2385653257369995
rank: 2, step 35, Loss: 1.2516798973083496
rank: 3, step 35, Loss: 1.232827067375183




rank 0 | epoch 0 | step 36 | batch 36
rank 3 | epoch 0 | step 36 | batch 36



Running epoch 0, step 36, batch 36

rank 1 | epoch 0 | step 36 | batch 36

Running epoch 0, step 36, batch 36
rank 2 | epoch 0 | step 36 | batch 36



Running epoch 0, step 36, batch 36

Running epoch 0, step 36, batch 36


Sampled inputs[:2]: tensor([[   0, 3179,  221,  ...,  910,  706, 1102],
        [   0,  292,  685,  ...,  278, 3281,  298]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   300, 16683,  ...,  8709,    40,  9817],
        [    0,    14,   475,  ...,  4103,   278,  4190]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0, 18901,     5,  ...,  2253,   278, 17423],
        [    0, 17471,  4778,  ...,  2177,   271,   266]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  1184,   271,  ...,  7225,   292,   474],
        [    0,   365,  1941,  ..., 38029,  1790, 44066]], device='cuda:0')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 36, Loss: 1.2442479133605957
rank: 1, step 36, Loss: 1.253018856048584
rank: 0, step 36, Loss: 1.2486106157302856
rank: 2, step 36, Loss: 1.2308443784713745




rank 3 | epoch 0 | step 37 | batch 37

rank 0 | epoch 0 | step 37 | batch 37

Running epoch 0, step 37, batch 37



Running epoch 0, step 37, batch 37
rank 1 | epoch 0 | step 37 | batch 37

rank 2 | epoch 0 | step 37 | batch 37



Running epoch 0, step 37, batch 37


Running epoch 0, step 37, batch 37
Sampled inputs[:2]: tensor([[    0,  3761,    12,  ...,  3476, 20966,   391],
        [    0,  2698,   221,  ...,  8352,  5680,   782]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,    14,   475,  ...,  7903,   266, 27772],
        [    0, 10026,   992,  ...,   273,  2831,  8716]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,    13,  1581,  ...,    13, 11628, 14876],
        [    0,   462,   221,  ...,    29,   413,  1801]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   981,    12,  ...,   266, 12907,  6670],
        [    0, 23809, 27646,  ...,   266,  3373,   554]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 37, Loss: 1.2549262046813965
rank: 1, step 37, Loss: 1.2541120052337646
rank: 2, step 37, Loss: 1.2591346502304077

rank: 0, step 37, Loss: 1.2358386516571045



rank 3 | epoch 0 | step 38 | batch 38


Running epoch 0, step 38, batch 38

rank 2 | epoch 0 | step 38 | batch 38
rank 1 | epoch 0 | step 38 | batch 38


rank 0 | epoch 0 | step 38 | batch 38

Running epoch 0, step 38, batch 38

Running epoch 0, step 38, batch 38




Running epoch 0, step 38, batch 38Sampled inputs[:2]: tensor([[    0,   287,   271,  ...,  1039,  4186,    13],
        [    0,   266,  5232,  ...,  2719,    13, 25385]], device='cuda:3')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   273,    14,  ...,   271,   266, 25408],
        [    0, 12165,    12,  ...,  2860, 10718,   278]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   287,  1070,  ...,   292,   221,   374],
        [    0,  1603,    27,  ..., 19959, 22776,   328]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  6668,   565,  ...,   360,   259,  8166],
        [    0,    12, 30621,  ...,   578,  3126,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 38, Loss: 1.2538996934890747
rank: 1, step 38, Loss: 1.2408711910247803
rank: 3, step 38, Loss: 1.256052017211914
rank: 0, step 38, Loss: 1.2556787729263306




rank 3 | epoch 0 | step 39 | batch 39
rank 0 | epoch 0 | step 39 | batch 39


Running epoch 0, step 39, batch 39


rank 1 | epoch 0 | step 39 | batch 39

rank 2 | epoch 0 | step 39 | batch 39

Running epoch 0, step 39, batch 39



Running epoch 0, step 39, batch 39

Running epoch 0, step 39, batch 39

Sampled inputs[:2]: tensor([[   0,   12, 3518,  ..., 1580, 2573,  409],
        [   0, 1858,  499,  ...,   14, 1032,   14]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  5007,  7551,  ...,     9,  2095,   300],
        [    0, 12456,    14,  ...,  1822,  1016,   365]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  2805,   391,  ...,    12,   259,  1420],
        [    0, 31550,    14,  ...,   278,   266,  4901]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0, 41638,  4573,  ...,   259,   790,  1416],
        [    0,    21,    14,  ...,  1159,  1978, 33323]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 39, Loss: 1.2473571300506592
rank: 2, step 39, Loss: 1.2544642686843872
rank: 3, step 39, Loss: 1.238775610923767
rank: 1, step 39, Loss: 1.2474440336227417



Graident accumulation at epoch 0, step 39, batch 39
Graident accumulation at epoch 0, step 39, batch 39
Graident accumulation at epoch 0, step 39, batch 39
Graident accumulation at epoch 0, step 39, batch 39

rank 3 | epoch 0 | step 40 | batch 40


Running epoch 0, step 40, batch 40

rank 1 | epoch 0 | step 40 | batch 40
rank 2 | epoch 0 | step 40 | batch 40


rank 0 | epoch 0 | step 40 | batch 40

Running epoch 0, step 40, batch 40

Running epoch 0, step 40, batch 40


Sampled inputs[:2]: tensor([[    0,   266,  1527,  ...,  2525,    14, 11570],
        [    0, 15152,  1106,  ...,   607,   266,  2529]], device='cuda:3')


Running epoch 0, step 40, batch 40
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3227,  300,  ..., 1817, 5709,  300],
        [   0, 2853,  590,  ..., 1351, 2927,   12]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,   259,  2697,  ...,  1722, 12673, 15053],
        [    0, 16371,    12,  ...,  1296,   680,  1098]], device='cuda:2')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  2853, 21042,  ...,  4120,   607, 11176],
        [    0,   221,   527,  ...,   417,   199, 30714]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 40, Loss: 1.2186007499694824
rank: 1, step 40, Loss: 1.2393856048583984
rank: 2, step 40, Loss: 1.2332619428634644
rank: 0, step 40, Loss: 1.2395129203796387




rank 3 | epoch 0 | step 41 | batch 41

rank 0 | epoch 0 | step 41 | batch 41

Running epoch 0, step 41, batch 41


rank 1 | epoch 0 | step 41 | batch 41

rank 2 | epoch 0 | step 41 | batch 41

Running epoch 0, step 41, batch 41


Running epoch 0, step 41, batch 41


Running epoch 0, step 41, batch 41

Sampled inputs[:2]: tensor([[    0, 23530,  6713,  ...,  2813,   518,   266],
        [    0,  2355,  2728,  ...,   554,  9025,   368]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   409, 15720,  ...,    12,   287,  2350],
        [    0,  3779,    12,  ...,    12, 12774, 14261]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  7879,  5435,  ...,  1586, 12115,   271],
        [    0,  9611,   278,  ...,   278,   638,   600]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   607, 32336,  ...,  4787,   367,  1255],
        [    0,   417,   199,  ...,  1853,    12,   709]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 41, Loss: 1.2380213737487793
rank: 1, step 41, Loss: 1.2470393180847168

rank: 0, step 41, Loss: 1.234062910079956

rank: 2, step 41, Loss: 1.2370054721832275


rank 3 | epoch 0 | step 42 | batch 42


Running epoch 0, step 42, batch 42

rank 0 | epoch 0 | step 42 | batch 42

rank 1 | epoch 0 | step 42 | batch 42


Running epoch 0, step 42, batch 42


Running epoch 0, step 42, batch 42

rank 2 | epoch 0 | step 42 | batch 42


Running epoch 0, step 42, batch 42
Sampled inputs[:2]: tensor([[    0,    12,  4567,  ...,  4154,  1799, 11883],
        [    0,   659,   278,  ...,  4032,  1109,   721]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,    18,   271,  ...,  4868,   963,   271],
        [    0, 17442,  2416,  ...,  7244,    66, 16907]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   729,  3430,  ...,  9715,    13, 42383],
        [    0, 24062, 11234,  ...,  4252,   300,   970]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0, 15165,   287,  ..., 15049,   278,   266],
        [    0,    13, 23070,  ...,   266,   319,    13]], device='cuda:2')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 42, Loss: 1.2314703464508057
rank: 1, step 42, Loss: 1.22777259349823
rank: 2, step 42, Loss: 1.2396571636199951
rank: 0, step 42, Loss: 1.2319927215576172




rank 3 | epoch 0 | step 43 | batch 43

rank 2 | epoch 0 | step 43 | batch 43


Running epoch 0, step 43, batch 43
rank 0 | epoch 0 | step 43 | batch 43


Running epoch 0, step 43, batch 43



Running epoch 0, step 43, batch 43
rank 1 | epoch 0 | step 43 | batch 43



Running epoch 0, step 43, batch 43
Sampled inputs[:2]: tensor([[    0, 32444,    41,  ...,    14,    18,    59],
        [    0,   287,  3284,  ...,   221,   493,   221]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  2612,   271,  ...,   369,  9862,   287],
        [    0,   292, 12376,  ...,   380, 20878, 13900]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 1336,  278,  ...,  266, 3269,  278],
        [   0,  452,  298,  ...,  287, 1575, 7856]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,  272,  352,  ...,  590, 4361,  446],
        [   0,  365,  925,  ...,  909,  598,  328]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 43, Loss: 1.2358276844024658
rank: 3, step 43, Loss: 1.2426776885986328
rank: 0, step 43, Loss: 1.2273558378219604
rank: 2, step 43, Loss: 1.2439496517181396




rank 0 | epoch 0 | step 44 | batch 44
rank 3 | epoch 0 | step 44 | batch 44

rank 2 | epoch 0 | step 44 | batch 44


Running epoch 0, step 44, batch 44


Running epoch 0, step 44, batch 44


rank 1 | epoch 0 | step 44 | batch 44


Running epoch 0, step 44, batch 44

Running epoch 0, step 44, batch 44

Sampled inputs[:2]: tensor([[    0,  3592,   417,  ...,  4893,   328,   266],
        [    0,   333,   199,  ...,   287,  4299, 31928]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  1008,   266,  ...,  1941,   437,  1626],
        [    0,   292,   221,  ...,   796, 12886,   694]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1796,  342,  ...,  668, 2903,  518],
        [   0,  858,   13,  ..., 2253,  847,  300]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   554,  1034,  ...,  3313,   365,   654],
        [    0, 22387,   292,  ...,   352,  3097,   996]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 44, Loss: 1.2474337816238403
rank: 1, step 44, Loss: 1.2394212484359741
rank: 3, step 44, Loss: 1.2315071821212769
rank: 2, step 44, Loss: 1.2176023721694946




rank 0 | epoch 0 | step 45 | batch 45
rank 2 | epoch 0 | step 45 | batch 45
rank 3 | epoch 0 | step 45 | batch 45




Running epoch 0, step 45, batch 45


Running epoch 0, step 45, batch 45


Running epoch 0, step 45, batch 45
rank 1 | epoch 0 | step 45 | batch 45



Running epoch 0, step 45, batch 45
Sampled inputs[:2]: tensor([[    0,   352, 13159,  ...,  3111,   394,    14],
        [    0,   508,   586,  ...,   445,    29,   445]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,   13, 7805,  ..., 2733,   12,  287],
        [   0,  278,  266,  ..., 5503,  259, 1036]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  395, 5949,  ...,  341,   13,  635],
        [   0,   14, 1845,  ...,  806,  352,  408]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  287, 3609,  ..., 3661, 5944,  838],
        [   0,  344, 3693,  ..., 1782, 3679,  292]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 45, Loss: 1.2337547540664673
rank: 1, step 45, Loss: 1.2472509145736694
rank: 0, step 45, Loss: 1.2288631200790405
rank: 2, step 45, Loss: 1.2383058071136475




rank 3 | epoch 0 | step 46 | batch 46
rank 2 | epoch 0 | step 46 | batch 46


rank 0 | epoch 0 | step 46 | batch 46

Running epoch 0, step 46, batch 46

Running epoch 0, step 46, batch 46



rank 1 | epoch 0 | step 46 | batch 46


Running epoch 0, step 46, batch 46

Running epoch 0, step 46, batch 46

Sampled inputs[:2]: tensor([[    0,   285,    53,  ...,   259,  5012,  3037],
        [    0,   292, 23242,  ...,  6494,  3560,  1528]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    12,  1197,  ...,   516,  1136,  9774],
        [    0,   368, 46614,  ...,  1070,   278,  1028]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   591,  1545,  ...,    71,   462,   221],
        [    0,   721,  1717,  ...,   278, 26029,    12]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  391, 7750,  ..., 4133,  271,  668],
        [   0,  287, 4579,  ...,  909,   12,  344]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 46, Loss: 1.249639868736267
rank: 3, step 46, Loss: 1.236301302909851
rank: 0, step 46, Loss: 1.227982521057129
rank: 2, step 46, Loss: 1.243324637413025




rank 2 | epoch 0 | step 47 | batch 47
rank 3 | epoch 0 | step 47 | batch 47



Running epoch 0, step 47, batch 47

Running epoch 0, step 47, batch 47


rank 1 | epoch 0 | step 47 | batch 47

rank 0 | epoch 0 | step 47 | batch 47

Running epoch 0, step 47, batch 47



Running epoch 0, step 47, batch 47
Sampled inputs[:2]: tensor([[    0, 47831,   266,  ...,    66,    17, 20005],
        [    0, 13856,   278,  ...,    14,    69,   462]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   650,    14,  ...,  3687,   278, 26952],
        [    0,   775,   266,  ...,   409,   328,  5768]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  3217, 16714,  ...,   462,   221,   474],
        [    0,  7203,   271,  ...,    12,   275,  3338]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[   0,   14, 1266,  ..., 2288,  417,  199],
        [   0,   17,  590,  ..., 1412,   35, 5015]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 47, Loss: 1.2455781698226929
rank: 2, step 47, Loss: 1.221824049949646
rank: 1, step 47, Loss: 1.2421727180480957
rank: 0, step 47, Loss: 1.2366849184036255



Graident accumulation at epoch 0, step 47, batch 47Graident accumulation at epoch 0, step 47, batch 47

Graident accumulation at epoch 0, step 47, batch 47
Graident accumulation at epoch 0, step 47, batch 47

rank 3 | epoch 0 | step 48 | batch 48


Running epoch 0, step 48, batch 48

rank 2 | epoch 0 | step 48 | batch 48


Running epoch 0, step 48, batch 48

rank 0 | epoch 0 | step 48 | batch 48
rank 1 | epoch 0 | step 48 | batch 48



Running epoch 0, step 48, batch 48


Running epoch 0, step 48, batch 48
Sampled inputs[:2]: tensor([[    0,  1531,    14,  ...,  6169,    17,     9],
        [    0,   221,   380,  ...,   630,  3765, 19107]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  2548,   720,  ...,  1795,  1109, 32948],
        [    0,   199,  7513,  ...,   271,   259,   957]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 2383, 9843,  ...,  401, 3959,  300],
        [   0, 6132,  300,  ...,   37,  271,  259]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   292,   380,  ...,  1725,   271,   266],
        [    0,   278, 11554,  ...,  4713,  1039, 17088]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 48, Loss: 1.225224256515503
rank: 1, step 48, Loss: 1.2271336317062378
rank: 0, step 48, Loss: 1.2197166681289673
rank: 3, step 48, Loss: 1.215460181236267




rank 0 | epoch 0 | step 49 | batch 49
rank 2 | epoch 0 | step 49 | batch 49
rank 3 | epoch 0 | step 49 | batch 49



Running epoch 0, step 49, batch 49

Running epoch 0, step 49, batch 49



rank 1 | epoch 0 | step 49 | batch 49


Running epoch 0, step 49, batch 49

Running epoch 0, step 49, batch 49

Sampled inputs[:2]: tensor([[    0,  5182,   446,  ...,   417,   199,    50],
        [    0,    12,   546,  ..., 24994, 31107,   266]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1029,  6068,  ..., 18017,   300,   259],
        [    0,   471,  6210,  ...,  4274,   344, 11451]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   360,  3285,  ...,   423,  3579,   468],
        [    0, 23842,   342,  ...,   365,  4011, 10151]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   266,  9076,  ...,   490,   437, 41298],
        [    0,  1172,   365,  ...,  1119, 15573,  3701]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 49, Loss: 1.211073637008667
rank: 2, step 49, Loss: 1.2238084077835083
rank: 1, step 49, Loss: 1.2386850118637085
rank: 0, step 49, Loss: 1.234521508216858




rank 0 | epoch 0 | step 50 | batch 50
rank 2 | epoch 0 | step 50 | batch 50
rank 3 | epoch 0 | step 50 | batch 50



Running epoch 0, step 50, batch 50

Running epoch 0, step 50, batch 50




Running epoch 0, step 50, batch 50
rank 1 | epoch 0 | step 50 | batch 50



Running epoch 0, step 50, batch 50
Sampled inputs[:2]: tensor([[   0, 1716,  271,  ...,  292,   78, 1365],
        [   0, 6957,  271,  ..., 9094,  266, 4320]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  259, 2561,  ...,   77, 4830,  292],
        [   0,  328,  266,  ...,  271,  706,   13]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   508,  3282,  ...,   334,   287, 31884],
        [    0,  6369,  3335,  ..., 23951,  8461,    66]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   221,   380,  ...,  3990,   717,    12],
        [    0,  1211, 11131,  ..., 31480,   565,   446]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 50, Loss: 1.21062433719635
rank: 1, step 50, Loss: 1.2136662006378174
rank: 2, step 50, Loss: 1.2375062704086304
rank: 0, step 50, Loss: 1.2276403903961182




rank 3 | epoch 0 | step 51 | batch 51

rank 2 | epoch 0 | step 51 | batch 51

rank 0 | epoch 0 | step 51 | batch 51

Running epoch 0, step 51, batch 51


Running epoch 0, step 51, batch 51


rank 1 | epoch 0 | step 51 | batch 51


Running epoch 0, step 51, batch 51

Running epoch 0, step 51, batch 51

Sampled inputs[:2]: tensor([[    0,  9029,   634,  ...,  1424,  6872,   292],
        [    0,    12, 47869,  ...,   259,  5698,    13]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   271,   266,  ..., 14308,   278,  9452],
        [    0,  4645,  7688,  ..., 26535,   471,   287]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 2923,  391,  ...,   14, 5424,  298],
        [   0, 1732,  292,  ..., 3440, 4010, 1487]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0, 25241,   717,  ...,   413,    16,    14],
        [    0,   446,   475,  ...,   300,   729, 11566]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 51, Loss: 1.2367345094680786
rank: 1, step 51, Loss: 1.2273170948028564
rank: 3, step 51, Loss: 1.2225185632705688



rank: 0, step 51, Loss: 1.2341103553771973

rank 3 | epoch 0 | step 52 | batch 52
rank 2 | epoch 0 | step 52 | batch 52


rank 0 | epoch 0 | step 52 | batch 52

Running epoch 0, step 52, batch 52

Running epoch 0, step 52, batch 52



rank 1 | epoch 0 | step 52 | batch 52


Running epoch 0, step 52, batch 52

Running epoch 0, step 52, batch 52

Sampled inputs[:2]: tensor([[   0, 1074, 1593,  ...,  992, 1810,  300],
        [   0,  659,  278,  ...,  769, 1728,  278]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   14,  221,  ...,  298,  408, 1849],
        [   0,   14, 3609,  ...,  298,  413,   29]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  3825,  1626,  ...,  5096,  3775,   266],
        [    0, 45050,   342,  ...,  3729,   287, 27888]], device='cuda:0')Sampled inputs[:2]: tensor([[    0, 15372, 10123,  ...,  1782,    12,   266],
        [    0,  3699,  3058,  ...,   820,  5327,  8055]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 52, Loss: 1.223531723022461
rank: 1, step 52, Loss: 1.2371336221694946
rank: 2, step 52, Loss: 1.2316941022872925


rank: 0, step 52, Loss: 1.2233607769012451


rank 3 | epoch 0 | step 53 | batch 53
rank 2 | epoch 0 | step 53 | batch 53



Running epoch 0, step 53, batch 53

Running epoch 0, step 53, batch 53


rank 1 | epoch 0 | step 53 | batch 53


Running epoch 0, step 53, batch 53

rank 0 | epoch 0 | step 53 | batch 53


Running epoch 0, step 53, batch 53
Sampled inputs[:2]: tensor([[   0, 4323, 8213,  ..., 1153,  278, 4258],
        [   0,   14, 3449,  ...,   12, 2665,    5]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  1103,   271,  ...,   957,   756,   368],
        [    0, 10215,   408,  ...,  6071,   360,  1317]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  4113,   709,  ..., 22407,  3231,  1130],
        [    0,  3941,   257,  ...,    50,   699, 13374]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1075,   940,  ...,  3780,    13,  4467],
        [    0, 10205,   342,  ...,  6354, 12230,     9]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 53, Loss: 1.2243268489837646
rank: 3, step 53, Loss: 1.2017279863357544
rank: 0, step 53, Loss: 1.2226277589797974
rank: 2, step 53, Loss: 1.223923683166504




rank 3 | epoch 0 | step 54 | batch 54

rank 2 | epoch 0 | step 54 | batch 54

Running epoch 0, step 54, batch 54



Running epoch 0, step 54, batch 54

rank 0 | epoch 0 | step 54 | batch 54


Running epoch 0, step 54, batch 54

rank 1 | epoch 0 | step 54 | batch 54Sampled inputs[:2]: tensor([[    0,  1756,   271,  ...,   259, 48595, 19882],
        [    0,    24,    15,  ...,   221,   380,   417]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  278, 1059,  ...,  300, 1877,   13],
        [   0, 4929, 4214,  ..., 1172,  591, 4422]], device='cuda:2')


Running epoch 0, step 54, batch 54
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   344, 14017,  ...,    65,   298,   634],
        [    0,  4110,   271,  ...,   944,   278,  3230]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,   422,    13,  ..., 14026,   368,  4999],
        [    0,  1171,   341,  ...,   278, 14713,    18]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 54, Loss: 1.2165281772613525
rank: 1, step 54, Loss: 1.2226651906967163
rank: 2, step 54, Loss: 1.2297991514205933
rank: 0, step 54, Loss: 1.2426109313964844




rank 3 | epoch 0 | step 55 | batch 55
rank 2 | epoch 0 | step 55 | batch 55



Running epoch 0, step 55, batch 55

Running epoch 0, step 55, batch 55


rank 1 | epoch 0 | step 55 | batch 55


Running epoch 0, step 55, batch 55

rank 0 | epoch 0 | step 55 | batch 55


Running epoch 0, step 55, batch 55Sampled inputs[:2]: tensor([[    0, 19641,   437,  ...,  2992,   518,   266],
        [    0,   300,   369,  ...,    12,   970,    12]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    16,    14,  ...,  5148,   259,  1951],
        [    0, 11541,  4784,  ...,  2837, 38541,    12]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,  1235,    14,  ...,  3301,   549,    14],
        [    0,  1128,   292,  ...,  1485,   287, 11833]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   199,  1139,  ...,    13,  1303, 26330],
        [    0,  4602,  2387,  ..., 11616,    14, 18434]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 55, Loss: 1.2363373041152954
rank: 2, step 55, Loss: 1.2347356081008911
rank: 3, step 55, Loss: 1.240501046180725
rank: 1, step 55, Loss: 1.224298119544983



Graident accumulation at epoch 0, step 55, batch 55
Graident accumulation at epoch 0, step 55, batch 55
Graident accumulation at epoch 0, step 55, batch 55
Graident accumulation at epoch 0, step 55, batch 55

rank 3 | epoch 0 | step 56 | batch 56
rank 2 | epoch 0 | step 56 | batch 56



Running epoch 0, step 56, batch 56

Running epoch 0, step 56, batch 56


rank 1 | epoch 0 | step 56 | batch 56

rank 0 | epoch 0 | step 56 | batch 56

Running epoch 0, step 56, batch 56

Sampled inputs[:2]: tensor([[    0,  1781,   659,  ...,    12,  1478,    14],
        [    0, 25228,  1168,  ...,  2728,    27,   298]], device='cuda:2')


Running epoch 0, step 56, batch 56Sampled inputs[:2]: tensor([[    0,  1665,  6306,  ...,   300, 10204,   582],
        [    0,    14, 12285,  ...,   616,   515,   352]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3630, 2199,  ..., 4157,   27, 4765],
        [   0,  342,  516,  ...,   12,  729, 3701]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1765, 5370,  ..., 1711,  292,  380],
        [   0,  391, 1351,  ...,   13,   40,    9]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 56, Loss: 1.21807861328125
rank: 1, step 56, Loss: 1.2166954278945923
rank: 0, step 56, Loss: 1.2271873950958252
rank: 2, step 56, Loss: 1.2222728729248047




rank 3 | epoch 0 | step 57 | batch 57

rank 2 | epoch 0 | step 57 | batch 57


Running epoch 0, step 57, batch 57


Running epoch 0, step 57, batch 57

rank 1 | epoch 0 | step 57 | batch 57
rank 0 | epoch 0 | step 57 | batch 57


Running epoch 0, step 57, batch 57



Running epoch 0, step 57, batch 57
Sampled inputs[:2]: tensor([[    0,  5160,   278,  ...,   496,    14, 46919],
        [    0, 18774,  4916,  ..., 35093,    19,    50]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,    9,  278,  ...,  278,  298,  452],
        [   0, 1184, 1451,  ...,  934,  352,  266]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  494,  221,  ...,  437,  266, 2143],
        [   0,  391, 9095,  ...,  417,  199, 2038]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 4998, 1921,  ...,  968,  266, 1136],
        [   0, 1420, 6319,  ...,  292, 4895, 4050]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 57, Loss: 1.2250078916549683
rank: 1, step 57, Loss: 1.2400109767913818
rank: 2, step 57, Loss: 1.2380725145339966
rank: 0, step 57, Loss: 1.2153571844100952




rank 2 | epoch 0 | step 58 | batch 58
rank 3 | epoch 0 | step 58 | batch 58



Running epoch 0, step 58, batch 58

Running epoch 0, step 58, batch 58


rank 1 | epoch 0 | step 58 | batch 58

rank 0 | epoch 0 | step 58 | batch 58

Running epoch 0, step 58, batch 58



Running epoch 0, step 58, batch 58
Sampled inputs[:2]: tensor([[    0,  2546,   300,  ...,    14,  1075,   756],
        [    0,    76,   472,  ..., 21215,   472,   346]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 15689,   278,  ..., 12016,   271,  4353],
        [    0,  2720,    14,  ...,   300, 15867,   368]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   328,   266,  ...,   352, 13107,  4302],
        [    0,    14,    20,  ...,   607,  8386,    88]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 48214,   287,  ...,   494,  8524,    12],
        [    0,   352,   266,  ...,  2416,   287,   300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 58, Loss: 1.2215148210525513
rank: 2, step 58, Loss: 1.2333219051361084
rank: 1, step 58, Loss: 1.231215476989746
rank: 3, step 58, Loss: 1.2182462215423584




rank 2 | epoch 0 | step 59 | batch 59

rank 3 | epoch 0 | step 59 | batch 59


Running epoch 0, step 59, batch 59


Running epoch 0, step 59, batch 59

rank 1 | epoch 0 | step 59 | batch 59


Running epoch 0, step 59, batch 59

rank 0 | epoch 0 | step 59 | batch 59


Running epoch 0, step 59, batch 59
Sampled inputs[:2]: tensor([[    0, 14576,  6617,  ...,    17,   367,  1608],
        [    0,  6847,   437,  ...,    17,    14,    16]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 38232,   446,  ...,   287,  2456, 29919],
        [    0,  2042,  2909,  ...,    14, 15061,  5742]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  767, 1345,  ...,  276,  327,  328],
        [   0,   13, 6913,  ...,  278, 1317, 4470]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,  266, 1336,  ..., 1841, 9705, 1219],
        [   0, 1751,  287,  ..., 6079, 1059,  287]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 59, Loss: 1.2296794652938843
rank: 3, step 59, Loss: 1.2300549745559692

rank: 2, step 59, Loss: 1.2244786024093628

rank: 0, step 59, Loss: 1.2276660203933716


rank 3 | epoch 0 | step 60 | batch 60
rank 2 | epoch 0 | step 60 | batch 60



Running epoch 0, step 60, batch 60

Running epoch 0, step 60, batch 60


rank 1 | epoch 0 | step 60 | batch 60


Running epoch 0, step 60, batch 60

rank 0 | epoch 0 | step 60 | batch 60


Running epoch 0, step 60, batch 60
Sampled inputs[:2]: tensor([[   0, 9855,  278,  ...,  266, 3134,  278],
        [   0, 6477,   12,  ..., 2931,  221,  445]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 2173,  292,  ...,  344, 8106,  344],
        [   0,  278, 5717,  ..., 5342, 5147,   14]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   292, 41192,  ..., 34298,  8741,   271],
        [    0,   199,  5990,  ...,   278,   638,  5513]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  346,  462,  ..., 2915,  275, 2565],
        [   0,  923,   13,  ...,  300, 8262,   12]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 60, Loss: 1.2144737243652344
rank: 1, step 60, Loss: 1.2314825057983398
rank: 0, step 60, Loss: 1.2287001609802246

rank: 2, step 60, Loss: 1.2176687717437744



rank 3 | epoch 0 | step 61 | batch 61
rank 2 | epoch 0 | step 61 | batch 61



Running epoch 0, step 61, batch 61

Running epoch 0, step 61, batch 61


rank 1 | epoch 0 | step 61 | batch 61


Running epoch 0, step 61, batch 61

rank 0 | epoch 0 | step 61 | batch 61
Sampled inputs[:2]: tensor([[   0, 1603,  694,  ...,   36,   18,  298],
        [   0,  270,  472,  ...,  292,   73,   14]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  927,  259,  ...,  328, 9430, 2330],
        [   0,   20,   13,  ...,  496,   14, 1032]], device='cuda:3')

Running epoch 0, step 61, batch 61

Sampled inputs[:2]: tensor([[   0,  300, 2607,  ..., 1279,  368,  266],
        [   0, 1854,  292,  ...,  328, 1360,   14]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,  1034,  1928,    15],
        [    0,    13, 23904,  ...,   560,  8840,    26]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 61, Loss: 1.2364848852157593
rank: 1, step 61, Loss: 1.235880970954895
rank: 0, step 61, Loss: 1.2064446210861206
rank: 2, step 61, Loss: 1.231601595878601




rank 2 | epoch 0 | step 62 | batch 62
rank 3 | epoch 0 | step 62 | batch 62

rank 0 | epoch 0 | step 62 | batch 62


Running epoch 0, step 62, batch 62


Running epoch 0, step 62, batch 62



Running epoch 0, step 62, batch 62
rank 1 | epoch 0 | step 62 | batch 62



Running epoch 0, step 62, batch 62
Sampled inputs[:2]: tensor([[    0,  3908,   300,  ..., 10874,  2667,   518],
        [    0,   298,  2230,  ...,  2300,  3698,  4764]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   843,  2621,  ...,  4589,   278, 14266],
        [    0,   266,  1513,  ...,   367,  1941,   344]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1254,  2921,  ...,  1888, 33569,  3201],
        [    0,   510,    13,  ...,  3454,   513,    13]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   278,  2097,  ...,  1754,   287,   631],
        [    0,   341, 22766,  ...,   271,   266,  1176]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 62, Loss: 1.2118725776672363
rank: 3, step 62, Loss: 1.233559489250183


rank: 2, step 62, Loss: 1.2257403135299683

rank: 0, step 62, Loss: 1.2311921119689941

rank 3 | epoch 0 | step 63 | batch 63
rank 2 | epoch 0 | step 63 | batch 63

rank 0 | epoch 0 | step 63 | batch 63


Running epoch 0, step 63, batch 63


Running epoch 0, step 63, batch 63


rank 1 | epoch 0 | step 63 | batch 63


Running epoch 0, step 63, batch 63

Running epoch 0, step 63, batch 63

Sampled inputs[:2]: tensor([[    0,  2733,   278,  ..., 10936,    14,  6593],
        [    0,  3159,   278,  ...,   266,  2545,   863]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  5689,   271,  ...,   352,  9985,  3260],
        [    0,   266,  1176,  ...,   199, 17791,  3662]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   456,    17,  ...,  1553, 29477,  2713],
        [    0,   292,   494,  ...,   259, 14134, 11544]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  4994,  8429,  ...,    12,   795,   596],
        [    0,    13,  2497,  ..., 27714,   278,   266]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 63, Loss: 1.2194875478744507
rank: 2, step 63, Loss: 1.2189769744873047
rank: 1, step 63, Loss: 1.2167458534240723

rank: 0, step 63, Loss: 1.2335025072097778


Graident accumulation at epoch 0, step 63, batch 63
Graident accumulation at epoch 0, step 63, batch 63
Graident accumulation at epoch 0, step 63, batch 63
Graident accumulation at epoch 0, step 63, batch 63

rank 3 | epoch 0 | step 64 | batch 64

rank 2 | epoch 0 | step 64 | batch 64


Running epoch 0, step 64, batch 64


Running epoch 0, step 64, batch 64

rank 0 | epoch 0 | step 64 | batch 64
rank 1 | epoch 0 | step 64 | batch 64


Running epoch 0, step 64, batch 64



Running epoch 0, step 64, batch 64Sampled inputs[:2]: tensor([[    0,   342, 43937,  ...,   298,   413,    29],
        [    0,   659,   278,  ...,   593,  2177,   266]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  996, 2226,  ...,  516, 3470,   14],
        [   0, 1098,  259,  ..., 6572, 1477,   12]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0, 25778,  3804,  ...,  2354,    12,   554],
        [    0,   409,  3669,  ...,    12,   374,    20]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,   677, 35427,  ..., 30465,  2783,     9],
        [    0,   346,   462,  ..., 37683,    14,  1500]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 64, Loss: 1.214743971824646
rank: 1, step 64, Loss: 1.2141989469528198
rank: 2, step 64, Loss: 1.2079099416732788

rank: 0, step 64, Loss: 1.2123653888702393



rank 0 | epoch 0 | step 65 | batch 65

rank 3 | epoch 0 | step 65 | batch 65


Running epoch 0, step 65, batch 65


Running epoch 0, step 65, batch 65
rank 2 | epoch 0 | step 65 | batch 65



Running epoch 0, step 65, batch 65

rank 1 | epoch 0 | step 65 | batch 65


Running epoch 0, step 65, batch 65
Sampled inputs[:2]: tensor([[   0, 2974,  278,  ...,  365, 8758,  271],
        [   0,   14,  292,  ..., 1385,   12,  287]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 8840,   26,  ...,   28,   16,   14],
        [   0,  221,  380,  ...,  508, 1853,   14]], device='cuda:0')Sampled inputs[:2]: tensor([[   0, 1234,  278,  ..., 8635,  271,  546],
        [   0, 4494,   12,  ...,  341, 1619,   12]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1039,   259,  ...,   221,   685,   546],
        [    0, 16763,  1538,  ...,   631,  3299,   437]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 65, Loss: 1.2237821817398071
rank: 3, step 65, Loss: 1.2152155637741089
rank: 0, step 65, Loss: 1.2199625968933105

rank: 2, step 65, Loss: 1.2201110124588013



rank 3 | epoch 0 | step 66 | batch 66
rank 2 | epoch 0 | step 66 | batch 66



Running epoch 0, step 66, batch 66

Running epoch 0, step 66, batch 66


rank 1 | epoch 0 | step 66 | batch 66


Running epoch 0, step 66, batch 66

rank 0 | epoch 0 | step 66 | batch 66


Running epoch 0, step 66, batch 66
Sampled inputs[:2]: tensor([[    0, 33792,   352,  ...,   278,   546, 30495],
        [    0,   367,  2063,  ...,  3022,   221,   733]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  257,  298,  ..., 1878,  328,  259],
        [   0,  759, 4585,  ...,  360,  300,  670]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   401,   953,  ..., 10914,   554,  2360],
        [    0,    14,   475,  ...,  6895,  5842,  2239]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   409, 35049,  ...,    12,   699,   394],
        [    0,   598,   696,  ...,  4048,  1795,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 66, Loss: 1.2163569927215576
rank: 1, step 66, Loss: 1.2204058170318604
rank: 2, step 66, Loss: 1.2113935947418213
rank: 0, step 66, Loss: 1.2061265707015991




rank 3 | epoch 0 | step 67 | batch 67
rank 0 | epoch 0 | step 67 | batch 67
rank 2 | epoch 0 | step 67 | batch 67



Running epoch 0, step 67, batch 67

Running epoch 0, step 67, batch 67



rank 1 | epoch 0 | step 67 | batch 67

Running epoch 0, step 67, batch 67


Running epoch 0, step 67, batch 67

Sampled inputs[:2]: tensor([[    0,  9458,   278,  ...,    15,  5251, 27858],
        [    0, 12324,  7368,  ...,   365,   726,  3595]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  7061,   437,  ...,   278,  9500,    18],
        [    0,   382,  9279,  ...,   445, 37790,     9]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,     9,  9925,  ...,   527, 23286,  6062],
        [    0,   461,   654,  ...,  6548,  7171,    14]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    14,   496,  ...,   368,   259,   490],
        [    0, 16803,   965,  ..., 36064,    12, 13769]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 67, Loss: 1.210572361946106
rank: 1, step 67, Loss: 1.2227025032043457
rank: 0, step 67, Loss: 1.210054636001587
rank: 2, step 67, Loss: 1.2406221628189087




rank 0 | epoch 0 | step 68 | batch 68
rank 2 | epoch 0 | step 68 | batch 68
rank 3 | epoch 0 | step 68 | batch 68




Running epoch 0, step 68, batch 68

Running epoch 0, step 68, batch 68



Running epoch 0, step 68, batch 68
rank 1 | epoch 0 | step 68 | batch 68



Running epoch 0, step 68, batch 68
Sampled inputs[:2]: tensor([[    0,  1159,   278,  ...,     9,   271,   266],
        [    0,  5597, 11929,  ...,   271,   275,   955]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   12,  344,  ..., 2337, 1122,  408],
        [   0,  689, 2149,  ..., 4263,   14,  292]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  1295,   508,  ...,   829,   772,   278],
        [    0,    14, 30840,  ...,   287,   932,    14]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  6795,  1728,  ...,   578,    19,    14],
        [    0,     9,   298,  ...,    12, 24079,   287]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 68, Loss: 1.2176955938339233
rank: 1, step 68, Loss: 1.2245800495147705
rank: 2, step 68, Loss: 1.2017128467559814



rank: 0, step 68, Loss: 1.225447654724121

rank 3 | epoch 0 | step 69 | batch 69
rank 2 | epoch 0 | step 69 | batch 69



Running epoch 0, step 69, batch 69

Running epoch 0, step 69, batch 69


rank 1 | epoch 0 | step 69 | batch 69


Running epoch 0, step 69, batch 69

rank 0 | epoch 0 | step 69 | batch 69
Sampled inputs[:2]: tensor([[    0,   266, 27347,  ...,   368,  3367,    13],
        [    0,  6408,   391,  ...,   870,   278,   266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   342,   266,  ...,   199,   395, 11578],
        [    0,  5159,   292,  ...,   772,   271,  3728]], device='cuda:3')


Running epoch 0, step 69, batch 69

Sampled inputs[:2]: tensor([[    0,  2140,    12,  ...,   696,   688,  1998],
        [    0, 16765,   367,  ..., 30192,  7038,  8135]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 6088, 1172,  ...,  546,  401,  925],
        [   0,  278, 2088,  ...,   69,   14,   71]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 69, Loss: 1.222294569015503
rank: 2, step 69, Loss: 1.2112185955047607
rank: 1, step 69, Loss: 1.2049108743667603
rank: 0, step 69, Loss: 1.2051289081573486




rank 2 | epoch 0 | step 70 | batch 70
rank 3 | epoch 0 | step 70 | batch 70


rank 0 | epoch 0 | step 70 | batch 70

Running epoch 0, step 70, batch 70

Running epoch 0, step 70, batch 70



rank 1 | epoch 0 | step 70 | batch 70


Running epoch 0, step 70, batch 70

Running epoch 0, step 70, batch 70

Sampled inputs[:2]: tensor([[   0,  504,  409,  ..., 5863, 2621,  824],
        [   0, 1295, 1178,  ..., 4808,  287,  996]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   923,  2583,  ..., 11385,    14,  1062],
        [    0, 18125, 16419,  ...,   278,   638, 11744]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  474,  513,  ...,  221, 2951, 7773],
        [   0, 1356,   18,  ...,   31,  333,  199]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0, 17471,  7279,  ...,   328,  6179,   287],
        [    0,   266,  1441,  ...,  1817,  1589,   278]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 70, Loss: 1.225156307220459
rank: 2, step 70, Loss: 1.2256410121917725
rank: 1, step 70, Loss: 1.2225730419158936

rank: 0, step 70, Loss: 1.2234876155853271



rank 3 | epoch 0 | step 71 | batch 71
rank 0 | epoch 0 | step 71 | batch 71

rank 2 | epoch 0 | step 71 | batch 71


Running epoch 0, step 71, batch 71

Running epoch 0, step 71, batch 71




Running epoch 0, step 71, batch 71
rank 1 | epoch 0 | step 71 | batch 71



Running epoch 0, step 71, batch 71
Sampled inputs[:2]: tensor([[   0, 2626,   13,  ...,  300,  369,  259],
        [   0,  292,   41,  ...,  271, 9536,  287]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   328, 16219,  ..., 14559,   351,   587],
        [    0,   680,   271,  ..., 12942,   271,   266]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   300,   259,  ...,   352, 12080,   634],
        [    0,  1371,   287,  ...,   689,   278, 12774]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   266, 15957,  ...,  1556, 45044,   271],
        [    0,   689,    13,  ...,   756,   271, 31773]], device='cuda:1')



Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 71, Loss: 1.2151027917861938
rank: 1, step 71, Loss: 1.2301874160766602
rank: 2, step 71, Loss: 1.2355413436889648
rank: 0, step 71, Loss: 1.2177391052246094



Graident accumulation at epoch 0, step 71, batch 71
Graident accumulation at epoch 0, step 71, batch 71
Graident accumulation at epoch 0, step 71, batch 71
Graident accumulation at epoch 0, step 71, batch 71

rank 3 | epoch 0 | step 72 | batch 72

rank 2 | epoch 0 | step 72 | batch 72


Running epoch 0, step 72, batch 72


Running epoch 0, step 72, batch 72

rank 1 | epoch 0 | step 72 | batch 72


Running epoch 0, step 72, batch 72

rank 0 | epoch 0 | step 72 | batch 72
Sampled inputs[:2]: tensor([[    0, 15411,  4286,  ...,  3337,   300,  2257],
        [    0,  1607, 26394,  ...,    19,   471,    14]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  278, 6481,  ...,   13, 8970,   12],
        [   0,   12,  496,  ...,  437,  266, 3767]], device='cuda:2')


Running epoch 0, step 72, batch 72
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   634, 10095,  ...,   367, 24607,   287],
        [    0,    14,  3921,  ...,   199,  2038,  1963]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3473,   278,  ..., 11743,   472,   346],
        [    0,   266,  1254,  ...,   369,  2870,   300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 72, Loss: 1.2120405435562134
rank: 3, step 72, Loss: 1.218603491783142
rank: 2, step 72, Loss: 1.2145172357559204
rank: 0, step 72, Loss: 1.2243794202804565




rank 0 | epoch 0 | step 73 | batch 73
rank 2 | epoch 0 | step 73 | batch 73

rank 3 | epoch 0 | step 73 | batch 73



Running epoch 0, step 73, batch 73

Running epoch 0, step 73, batch 73



Running epoch 0, step 73, batch 73

rank 1 | epoch 0 | step 73 | batch 73


Running epoch 0, step 73, batch 73
Sampled inputs[:2]: tensor([[    0,  5151,   292,  ..., 13658,   401,  1070],
        [    0,   792,   342,  ..., 12152,  9904,  1239]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1526,  341,  ...,  271, 4401, 3341],
        [   0,  287,  271,  ..., 5090,  631, 3276]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1979,   352,  ...,   292,  1591,   446],
        [    0, 24674,   513,  ...,  6099,    12,  4863]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3646, 1340,  ...,   13, 7800, 2872],
        [   0, 2379,   13,  ...,  287,  259, 2193]], device='cuda:1')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 73, Loss: 1.190401554107666
rank: 1, step 73, Loss: 1.217373013496399
rank: 2, step 73, Loss: 1.2217530012130737



rank: 0, step 73, Loss: 1.2088112831115723

rank 2 | epoch 0 | step 74 | batch 74

rank 3 | epoch 0 | step 74 | batch 74


Running epoch 0, step 74, batch 74


Running epoch 0, step 74, batch 74

rank 1 | epoch 0 | step 74 | batch 74


Running epoch 0, step 74, batch 74

rank 0 | epoch 0 | step 74 | batch 74


Running epoch 0, step 74, batch 74
Sampled inputs[:2]: tensor([[   0, 2328,  271,  ...,  706,   13, 8961],
        [   0, 9657,  300,  ...,   12,  271,  266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   287,  1410,  ...,  1255,  1699,   328],
        [    0,    14, 13078,  ...,  1994,    12,   287]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    14, 49045,  ...,    12,   706,   409],
        [    0,   292, 17181,  ...,   634,  5039,   266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   381,  1659,  ...,  1403,   271,  6324],
        [    0,  3829,   278,  ..., 11978,     9,   968]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 74, Loss: 1.2065389156341553
rank: 3, step 74, Loss: 1.1995594501495361
rank: 2, step 74, Loss: 1.220167636871338


rank: 0, step 74, Loss: 1.2148170471191406


rank 3 | epoch 0 | step 75 | batch 75
rank 2 | epoch 0 | step 75 | batch 75



Running epoch 0, step 75, batch 75

Running epoch 0, step 75, batch 75


rank 1 | epoch 0 | step 75 | batch 75


Running epoch 0, step 75, batch 75

rank 0 | epoch 0 | step 75 | batch 75


Running epoch 0, step 75, batch 75Sampled inputs[:2]: tensor([[    0,   278,  2305,  ...,  2529, 34181,  4555],
        [    0,  6809,   344,  ...,    14,  1266,   795]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  3227,   278,  ...,  2950,    14, 15544],
        [    0,    14,  8058,  ..., 10316,   352,   266]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,   287, 17044,  ...,   496,    14,  1841],
        [    0,   271,   259,  ...,  4511,    14,   333]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2667,  365,  ..., 9281, 1631, 9123],
        [   0,  586, 1016,  ..., 7151, 8280,  300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 75, Loss: 1.2187602519989014
rank: 3, step 75, Loss: 1.2033079862594604
rank: 0, step 75, Loss: 1.223578929901123

rank: 2, step 75, Loss: 1.2098463773727417



rank 0 | epoch 0 | step 76 | batch 76

rank 2 | epoch 0 | step 76 | batch 76
rank 3 | epoch 0 | step 76 | batch 76



Running epoch 0, step 76, batch 76

Running epoch 0, step 76, batch 76

Running epoch 0, step 76, batch 76



rank 1 | epoch 0 | step 76 | batch 76


Running epoch 0, step 76, batch 76
Sampled inputs[:2]: tensor([[    0,    12,   344,  ..., 10482,   950, 15744],
        [    0,  3577,    12,  ...,  4222,  2137, 31332]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 10705,   401,  ...,   768,  2392,   368],
        [    0,   266,   824,  ...,  1799,   287,  6250]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 1730, 2068,  ...,  445, 2704,  445],
        [   0,  342, 4781,  ...,  630,  940,  271]], device='cuda:0')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  300, 1635,  ...,  437,  266, 1136],
        [   0,  221,  474,  ...,   12,  259, 1220]], device='cuda:1')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 76, Loss: 1.2159451246261597
rank: 1, step 76, Loss: 1.2073347568511963
rank: 2, step 76, Loss: 1.2234264612197876
rank: 0, step 76, Loss: 1.2100005149841309




rank 2 | epoch 0 | step 77 | batch 77
rank 3 | epoch 0 | step 77 | batch 77
rank 0 | epoch 0 | step 77 | batch 77



Running epoch 0, step 77, batch 77

Running epoch 0, step 77, batch 77




Running epoch 0, step 77, batch 77
rank 1 | epoch 0 | step 77 | batch 77



Running epoch 0, step 77, batch 77
Sampled inputs[:2]: tensor([[   0,  765,  292,  ...,  623,   12, 7117],
        [   0, 6508, 4305,  ...,  806, 3888, 4431]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 6762,  689,  ..., 7061,   14,  381],
        [   0,  635,   13,  ...,  292,   20,  445]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  278, 5798,  ...,  266,  729, 1798],
        [   0,   17,  292,  ..., 2269, 3887,  278]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  278,  554,  ...,  365, 3125,  271],
        [   0, 1067,  408,  ..., 4657, 1016,  271]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 77, Loss: 1.2028650045394897
rank: 1, step 77, Loss: 1.1964313983917236
rank: 2, step 77, Loss: 1.1978765726089478
rank: 0, step 77, Loss: 1.2224071025848389




rank 2 | epoch 0 | step 78 | batch 78
rank 3 | epoch 0 | step 78 | batch 78



Running epoch 0, step 78, batch 78

Running epoch 0, step 78, batch 78


rank 1 | epoch 0 | step 78 | batch 78


Running epoch 0, step 78, batch 78

rank 0 | epoch 0 | step 78 | batch 78
Sampled inputs[:2]: tensor([[    0,    12,  2212,  ..., 12415,  2131,   287],
        [    0,  3001,  3325,  ..., 16332,  2661,  1200]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    19,     9,  ..., 11504,   446,   381],
        [    0, 19720,    12,  ...,  1239,    12, 22324]], device='cuda:3')


Running epoch 0, step 78, batch 78
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 4108,   85,  ...,   40,   12, 1530],
        [   0,   16,   52,  ...,   12,  298,  374]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   221,  4070,  ...,  1061,  3189,    26],
        [    0,   271,  4136,  ...,  5052, 14552,  3339]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 78, Loss: 1.2219133377075195
rank: 3, step 78, Loss: 1.1971561908721924
rank: 0, step 78, Loss: 1.2182793617248535

rank: 2, step 78, Loss: 1.2195441722869873



rank 3 | epoch 0 | step 79 | batch 79
rank 2 | epoch 0 | step 79 | batch 79



Running epoch 0, step 79, batch 79

Running epoch 0, step 79, batch 79


rank 1 | epoch 0 | step 79 | batch 79

rank 0 | epoch 0 | step 79 | batch 79

Running epoch 0, step 79, batch 79



Running epoch 0, step 79, batch 79
Sampled inputs[:2]: tensor([[    0, 48705,   292,  ...,   266,  2548,  2697],
        [    0,    34,     9,  ...,    19,    14, 45576]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   199,  2834,  ...,  1236,   768,  4316],
        [    0,   300, 13523,  ..., 42438,   786,  1416]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 5699,   20,  ..., 3502, 2051,  266],
        [   0, 1487,  409,  ..., 6979, 1273,  496]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  292,  380,  ..., 9636,  417,  199],
        [   0,   35, 3815,  ...,  278, 7097, 4601]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 79, Loss: 1.2083138227462769
rank: 1, step 79, Loss: 1.2310903072357178
rank: 2, step 79, Loss: 1.1962333917617798

rank: 0, step 79, Loss: 1.219773769378662


Graident accumulation at epoch 0, step 79, batch 79
Graident accumulation at epoch 0, step 79, batch 79
Graident accumulation at epoch 0, step 79, batch 79
Graident accumulation at epoch 0, step 79, batch 79
Saving checkpoint at epoch 0, step 79, batch 79
Saving checkpoint at epoch 0, step 79, batch 79
Saving checkpoint at epoch 0, step 79, batch 79
Epoch 0 | Batch 79/262 | Training PPL: 17295.30151774386 | time 7.9183571338653564
Saving checkpoint at epoch 0, step 79, batch 79

rank 1 | epoch 0 | step 80 | batch 80


Running epoch 0, step 80, batch 80
Sampled inputs[:2]: tensor([[    0,  3756,    13,  ...,  1704,   278,  5851],
        [    0,   521,   486,  ...,   278, 25182,   271]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Epoch 0 | Validation PPL: 15842.94824258871 | Learning rate: 1.628035421558293e-05

rank 3 | epoch 0 | step 80 | batch 80
rank 2 | epoch 0 | step 80 | batch 80



Running epoch 0, step 80, batch 80

Running epoch 0, step 80, batch 80

Sampled inputs[:2]: tensor([[    0,   445,    29,  ..., 20247,   272,   298],
        [    0,  5896,   352,  ...,  1168,   767,  1390]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 4258,  717,  ...,   34,  609, 1169],
        [   0,  266, 2057,  ...,   88, 1801,   66]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Checkpoint saved to exp/gpt2_scratch_neuro_tokenizer_bayes_fwd_mini/checkpoint.0_79, AFTER epoch 0, step 79

rank 0 | epoch 0 | step 80 | batch 80


Running epoch 0, step 80, batch 80
Sampled inputs[:2]: tensor([[   0,  394,  292,  ..., 1711,  365,  897],
        [   0, 3440, 5745,  ...,  360, 4998,  654]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 80, Loss: 1.197102665901184
rank: 3, step 80, Loss: 1.2149226665496826
rank: 2, step 80, Loss: 1.2239365577697754
rank: 1, step 80, Loss: 1.2301231622695923




rank 2 | epoch 0 | step 81 | batch 81
rank 3 | epoch 0 | step 81 | batch 81



Running epoch 0, step 81, batch 81

Running epoch 0, step 81, batch 81


rank 0 | epoch 0 | step 81 | batch 81


Running epoch 0, step 81, batch 81
Sampled inputs[:2]: tensor([[    0, 26396,    83,  ...,   292,    18,   590],
        [    0,   287, 19777,  ...,   266,  5061,   278]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,  257,  221,  ..., 1474, 2044,  300],
        [   0,  365, 2849,  ...,    9, 3365, 5027]], device='cuda:2')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  1106,   259,  ...,   271,   679,   382],
        [    0, 13245,  1503,  ...,    14,  5605,    12]], device='cuda:0')
rank 1 | epoch 0 | step 81 | batch 81



Running epoch 0, step 81, batch 81
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   287,  2199,  ...,   266,  1241,  3139],
        [    0,   677, 25912,  ...,  2337,   292,  4462]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 81, Loss: 1.1990737915039062
rank: 3, step 81, Loss: 1.213234543800354

rank: 2, step 81, Loss: 1.2127493619918823


rank: 0, step 81, Loss: 1.2244540452957153

rank 2 | epoch 0 | step 82 | batch 82
rank 3 | epoch 0 | step 82 | batch 82



Running epoch 0, step 82, batch 82

Running epoch 0, step 82, batch 82


rank 0 | epoch 0 | step 82 | batch 82
rank 1 | epoch 0 | step 82 | batch 82



Running epoch 0, step 82, batch 82


Running epoch 0, step 82, batch 82
Sampled inputs[:2]: tensor([[    0, 29258,   765,  ...,  4196,    19,    12],
        [    0,   894,   496,  ...,   266,   623,   587]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 48007,   417,  ...,   944,   278,  2903],
        [    0,   199, 14973,  ...,   638,  1119,  1329]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  368, 2035,  ...,  266, 1122,  587],
        [   0, 3019,  278,  ...,  365, 1770,   12]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   47,   12,  ..., 4367,  278,  471],
        [   0, 1099,  644,  ..., 5481,   14, 8782]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 82, Loss: 1.1952189207077026
rank: 2, step 82, Loss: 1.2007217407226562
rank: 0, step 82, Loss: 1.215041995048523


rank: 1, step 82, Loss: 1.2107874155044556


rank 2 | epoch 0 | step 83 | batch 83
rank 3 | epoch 0 | step 83 | batch 83



Running epoch 0, step 83, batch 83

Running epoch 0, step 83, batch 83


rank 0 | epoch 0 | step 83 | batch 83

rank 1 | epoch 0 | step 83 | batch 83Sampled inputs[:2]: tensor([[    0,  5024,  3846,  ...,  5880,  1377,    12],
        [    0,    12,   287,  ..., 12678,  2503,   401]], device='cuda:2')



Running epoch 0, step 83, batch 83Sampled inputs[:2]: tensor([[    0, 12440,   578,  ..., 25918,   287,   996],
        [    0,   271,   768,  ..., 15555,   278,   266]], device='cuda:3')


Running epoch 0, step 83, batch 83

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   266, 20604,  ...,   409, 13764,  6048],
        [    0, 29883,   680,  ...,  3363,  1049,   292]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,  3306,  4057,  ...,   287,   266,  1692],
        [    0,   278, 14971,  ...,  2341,   266,   717]], device='cuda:1')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 83, Loss: 1.1935803890228271
rank: 3, step 83, Loss: 1.1865259408950806
rank: 0, step 83, Loss: 1.2292084693908691
rank: 2, step 83, Loss: 1.2130695581436157




rank 3 | epoch 0 | step 84 | batch 84
rank 0 | epoch 0 | step 84 | batch 84

rank 2 | epoch 0 | step 84 | batch 84


Running epoch 0, step 84, batch 84


Running epoch 0, step 84, batch 84



Running epoch 0, step 84, batch 84
rank 1 | epoch 0 | step 84 | batch 84



Running epoch 0, step 84, batch 84
Sampled inputs[:2]: tensor([[    0,   298,   669,  ...,   287, 19731,    13],
        [    0, 12987,   609,  ...,   699,  9863,  3227]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,   13,  711,  ...,  591,  953,  352],
        [   0,  278, 6046,  ..., 1671,  199,  395]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,    13, 11273,  ...,   292,  1057,    14],
        [    0,   431, 19346,  ...,    14,  3237, 18548]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  894,   73,  ..., 2323,  909, 4103],
        [   0, 3951,   77,  ..., 7062,  278,  600]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 84, Loss: 1.2127420902252197
rank: 1, step 84, Loss: 1.2078008651733398
rank: 2, step 84, Loss: 1.192276120185852
rank: 0, step 84, Loss: 1.1985032558441162




rank 2 | epoch 0 | step 85 | batch 85
rank 3 | epoch 0 | step 85 | batch 85



Running epoch 0, step 85, batch 85

Running epoch 0, step 85, batch 85


rank 1 | epoch 0 | step 85 | batch 85


Running epoch 0, step 85, batch 85
Sampled inputs[:2]: tensor([[   0,   12,  401,  ...,  504,  565,  590],
        [   0,   73,   14,  ...,  650,   13, 3658]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 20202,   300,  ..., 15185,   287,  6573],
        [    0, 44175,   744,  ..., 16394, 26528,    12]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0, 24781,   287,  ...,   266,  3873,  1400],
        [    0,   508,   586,  ...,  6157,  3146,  7647]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 85 | batch 85


Running epoch 0, step 85, batch 85
Sampled inputs[:2]: tensor([[    0,    13, 26335,  ...,     5,  2570, 34403],
        [    0,   221,   467,  ..., 21991,   630,  3990]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 85, Loss: 1.2016212940216064
rank: 3, step 85, Loss: 1.2110494375228882
rank: 0, step 85, Loss: 1.232201337814331
rank: 2, step 85, Loss: 1.2237247228622437




rank 3 | epoch 0 | step 86 | batch 86
rank 2 | epoch 0 | step 86 | batch 86


rank 0 | epoch 0 | step 86 | batch 86

Running epoch 0, step 86, batch 86

Running epoch 0, step 86, batch 86



rank 1 | epoch 0 | step 86 | batch 86


Running epoch 0, step 86, batch 86


Running epoch 0, step 86, batch 86
Sampled inputs[:2]: tensor([[    0,   271, 16217,  ...,  6352,  4546,  2558],
        [    0,   380,  8157,  ...,   943,   352,  2278]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   346,   462,  ...,  2208,    12,  1901],
        [    0,   720,  1122,  ...,   656,   287, 14258]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  413,   29,  ...,  818,  278,  970],
        [   0,  287, 2997,  ...,  437,  266, 1040]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,  300, 5201,  ..., 1997, 7423,  417],
        [   0, 1217,    9,  ..., 1821,    5,  278]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 86, Loss: 1.2072832584381104
rank: 3, step 86, Loss: 1.1953060626983643
rank: 0, step 86, Loss: 1.2223910093307495
rank: 2, step 86, Loss: 1.2266143560409546




rank 0 | epoch 0 | step 87 | batch 87
rank 2 | epoch 0 | step 87 | batch 87
rank 3 | epoch 0 | step 87 | batch 87




Running epoch 0, step 87, batch 87

Running epoch 0, step 87, batch 87



Running epoch 0, step 87, batch 87
rank 1 | epoch 0 | step 87 | batch 87



Running epoch 0, step 87, batch 87
Sampled inputs[:2]: tensor([[   0, 1527,  292,  ..., 2122,  278, 1911],
        [   0, 3351,  352,  ...,   17,  287,  357]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 12449,    12,  ...,   292,  2178,   413],
        [    0,   328, 27958,  ...,   417,   199,  2038]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   401,  3704,  ...,    14,  1062,  1804],
        [    0,    13, 30044,  ...,   381, 22105,    11]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  6538,  1805,  ...,   298,   271,   721],
        [    0,   352,  2284,  ..., 43204,    12,   709]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 87, Loss: 1.2149341106414795
rank: 1, step 87, Loss: 1.2096550464630127
rank: 2, step 87, Loss: 1.1915825605392456
rank: 0, step 87, Loss: 1.2088477611541748



Graident accumulation at epoch 0, step 87, batch 87Graident accumulation at epoch 0, step 87, batch 87

Graident accumulation at epoch 0, step 87, batch 87
Graident accumulation at epoch 0, step 87, batch 87

rank 2 | epoch 0 | step 88 | batch 88
rank 3 | epoch 0 | step 88 | batch 88



Running epoch 0, step 88, batch 88

Running epoch 0, step 88, batch 88


rank 0 | epoch 0 | step 88 | batch 88

rank 1 | epoch 0 | step 88 | batch 88


Running epoch 0, step 88, batch 88


Running epoch 0, step 88, batch 88
Sampled inputs[:2]: tensor([[    0,   342,   408,  ...,  5162, 25842,  4855],
        [    0,  3398,  6361,  ..., 12942,   518,  4066]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 2319,   30,  ...,  508, 6703,   12],
        [   0,  273,  298,  ..., 7437, 2767,  518]], device='cuda:2')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   822,  5085,  ...,   293,  1608,   391],
        [    0,   259,  1513,  ...,   275, 19511,  2350]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  2485,    12,  ...,   293,   259, 14600],
        [    0,   287,  2026,  ..., 16374,   266,  2236]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 88, Loss: 1.2087403535842896
rank: 3, step 88, Loss: 1.2176252603530884
rank: 1, step 88, Loss: 1.2143622636795044
rank: 0, step 88, Loss: 1.20703125




rank 2 | epoch 0 | step 89 | batch 89
rank 3 | epoch 0 | step 89 | batch 89
rank 0 | epoch 0 | step 89 | batch 89



Running epoch 0, step 89, batch 89

Running epoch 0, step 89, batch 89




Running epoch 0, step 89, batch 89
rank 1 | epoch 0 | step 89 | batch 89


Running epoch 0, step 89, batch 89

Sampled inputs[:2]: tensor([[    0,  1265,   328,  ...,  2282, 35414,    13],
        [    0,  1682,   271,  ...,   300,   266, 10935]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  494,  221,  ...,  298, 1062, 4923],
        [   0, 3086,  504,  ...,   14,  759,  935]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   342,   266,  ...,  4998,  4756,  5139],
        [    0, 10565,  2677,  ...,   298,   292, 11188]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 2422,  300,  ...,  630,  729, 3400],
        [   0, 2380, 2667,  ...,   14,  381, 5621]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 89, Loss: 1.2084407806396484
rank: 3, step 89, Loss: 1.2089201211929321
rank: 2, step 89, Loss: 1.2080715894699097
rank: 0, step 89, Loss: 1.2200590372085571




rank 3 | epoch 0 | step 90 | batch 90
rank 2 | epoch 0 | step 90 | batch 90


rank 0 | epoch 0 | step 90 | batch 90

Running epoch 0, step 90, batch 90

Running epoch 0, step 90, batch 90



rank 1 | epoch 0 | step 90 | batch 90


Running epoch 0, step 90, batch 90

Running epoch 0, step 90, batch 90

Sampled inputs[:2]: tensor([[   0,   17,   12,  ...,   12,  461,  806],
        [   0, 4538,  271,  ..., 1603,  591,  688]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  2086, 10663,  ...,   271,   266,  6927],
        [    0,  1726,  3775,  ...,   300,   266,  1686]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   221,   527,  ...,   298,   335,   298],
        [    0,   278,   266,  ...,   352, 10572,   345]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    13, 15578,  ...,   221,   494,   221],
        [    0,  3532,   300,  ...,    12,   461,   806]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 90, Loss: 1.2225679159164429
rank: 1, step 90, Loss: 1.20698082447052
rank: 2, step 90, Loss: 1.2075227499008179
rank: 0, step 90, Loss: 1.1936538219451904




rank 3 | epoch 0 | step 91 | batch 91

rank 2 | epoch 0 | step 91 | batch 91


Running epoch 0, step 91, batch 91


Running epoch 0, step 91, batch 91

rank 0 | epoch 0 | step 91 | batch 91
rank 1 | epoch 0 | step 91 | batch 91



Running epoch 0, step 91, batch 91


Running epoch 0, step 91, batch 91
Sampled inputs[:2]: tensor([[    0,   271, 12472,  ...,   374,    29,    16],
        [    0,   607,   443,  ...,   259,  2646,  1597]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 16286,  5356,  ...,   590,  2161,     5],
        [    0,   767,  9289,  ...,   494,   287,  8957]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  638, 1862,  ...,   14, 7869,   14],
        [   0,  266,  452,  ..., 1725, 2200,  342]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   271, 16084,  ...,   688,  1122,    12],
        [    0,  3529,   271,  ...,  1553,   365,  2714]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 91, Loss: 1.2248923778533936
rank: 2, step 91, Loss: 1.2089581489562988
rank: 1, step 91, Loss: 1.2032452821731567
rank: 0, step 91, Loss: 1.2145335674285889




rank 0 | epoch 0 | step 92 | batch 92
rank 3 | epoch 0 | step 92 | batch 92



Running epoch 0, step 92, batch 92

rank 2 | epoch 0 | step 92 | batch 92


Running epoch 0, step 92, batch 92


Running epoch 0, step 92, batch 92

rank 1 | epoch 0 | step 92 | batch 92


Running epoch 0, step 92, batch 92
Sampled inputs[:2]: tensor([[    0, 19444,  6307,  ...,    13, 38005,  1447],
        [    0, 23749, 27341,  ..., 34110,   342,  9672]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  298,  369,  ..., 5936,  968,  259],
        [   0,  518, 9048,  ..., 1354,  352,  266]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0, 13964,    13,  ...,    14,   560,   199],
        [    0,   278,   795,  ...,  1774, 14474,   367]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,   221,   422,  ...,  2693,   733,   381],
        [    0, 44210,    89,  ...,    43,  1707,   266]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 92, Loss: 1.2169578075408936
rank: 1, step 92, Loss: 1.2072253227233887
rank: 2, step 92, Loss: 1.2041137218475342



rank: 0, step 92, Loss: 1.198766827583313

rank 2 | epoch 0 | step 93 | batch 93
rank 3 | epoch 0 | step 93 | batch 93


rank 0 | epoch 0 | step 93 | batch 93

Running epoch 0, step 93, batch 93

Running epoch 0, step 93, batch 93



rank 1 | epoch 0 | step 93 | batch 93

Running epoch 0, step 93, batch 93


Running epoch 0, step 93, batch 93

Sampled inputs[:2]: tensor([[   0, 6124, 1209,  ..., 1176, 3164,  271],
        [   0,   12, 4856,  ...,  342,  266, 1040]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   266, 10726,  ..., 13973, 22191, 15913],
        [    0,  1932,    15,  ...,   344,   984,   344]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    13,  1924,  ...,  2117,   300, 26473],
        [    0,   271, 21394,  ...,  1487,   287,   292]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  4890,  1528,  ...,   847,   328,  1703],
        [    0, 41921,  1955,  ...,    75,   221,   334]], device='cuda:0')



Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 93, Loss: 1.2050154209136963
rank: 3, step 93, Loss: 1.2169674634933472
rank: 2, step 93, Loss: 1.2015345096588135

rank: 0, step 93, Loss: 1.221701741218567



rank 3 | epoch 0 | step 94 | batch 94
rank 2 | epoch 0 | step 94 | batch 94



Running epoch 0, step 94, batch 94

Running epoch 0, step 94, batch 94


rank 1 | epoch 0 | step 94 | batch 94


Running epoch 0, step 94, batch 94

rank 0 | epoch 0 | step 94 | batch 94
Sampled inputs[:2]: tensor([[    0,  3543,   391,  ...,  3370,  2926,  8090],
        [    0,   380,  3584,  ..., 24402,  2057,     9]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 18981,    13,  ...,   365,  2714,   408],
        [    0,  4878,   607,  ...,    14, 17331,   287]], device='cuda:2')


Running epoch 0, step 94, batch 94

Sampled inputs[:2]: tensor([[    0,  1624,   391,  ...,   391, 36249,   259],
        [    0,   259,  2283,  ...,   462,   221,   474]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13,    19,  ..., 22111,  2489,    14],
        [    0,    55,  2258,  ..., 32764,    75,   338]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 94, Loss: 1.22374427318573
rank: 3, step 94, Loss: 1.2034183740615845
rank: 2, step 94, Loss: 1.224137544631958
rank: 0, step 94, Loss: 1.21312415599823




rank 3 | epoch 0 | step 95 | batch 95
rank 2 | epoch 0 | step 95 | batch 95



Running epoch 0, step 95, batch 95

Running epoch 0, step 95, batch 95


rank 1 | epoch 0 | step 95 | batch 95
rank 0 | epoch 0 | step 95 | batch 95


Running epoch 0, step 95, batch 95



Running epoch 0, step 95, batch 95
Sampled inputs[:2]: tensor([[    0,   292,    33,  ..., 32754,   300, 14476],
        [    0, 21891,     9,  ...,  5216,   717,   287]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  8450,   292,  ...,   352,   722, 37719],
        [    0,  3103,  2134,  ...,  6627,   275,  1911]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  1832,   292,  ...,  2176,  1345,    14],
        [    0, 23230,    12,  ...,  5092,   741,   266]], device='cuda:1')


Sampled inputs[:2]: tensor([[    0,  1034,  5599,  ...,   259,   586,  1403],
        [    0,  7314,    19,  ...,  8350,   365, 13801]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 95, Loss: 1.2109051942825317
rank: 1, step 95, Loss: 1.2065160274505615
rank: 2, step 95, Loss: 1.2245888710021973
rank: 0, step 95, Loss: 1.22315514087677



Graident accumulation at epoch 0, step 95, batch 95Graident accumulation at epoch 0, step 95, batch 95

Graident accumulation at epoch 0, step 95, batch 95
Graident accumulation at epoch 0, step 95, batch 95

rank 3 | epoch 0 | step 96 | batch 96

rank 2 | epoch 0 | step 96 | batch 96


Running epoch 0, step 96, batch 96


Running epoch 0, step 96, batch 96

rank 1 | epoch 0 | step 96 | batch 96


Running epoch 0, step 96, batch 96

rank 0 | epoch 0 | step 96 | batch 96Sampled inputs[:2]: tensor([[    0,  1075, 14981,  ...,   221,   380,  1075],
        [    0,  1254,  1773,  ..., 19459,  2447,  2613]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  298,  894,  ..., 7605, 3220,  259],
        [   0,   12,  287,  ...,  298, 9855,  278]], device='cuda:3')




Running epoch 0, step 96, batch 96Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   401,  3408,  ...,   287, 19892,   328],
        [    0,    12,   328,  ...,   908,  1086,    12]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   278,   266,  ..., 10639,   292,  4723],
        [    0,  3393,  3380,  ...,   292,  6502,   950]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 96, Loss: 1.1993941068649292
rank: 0, step 96, Loss: 1.1784539222717285
rank: 2, step 96, Loss: 1.2155466079711914


rank: 3, step 96, Loss: 1.2027665376663208


rank 2 | epoch 0 | step 97 | batch 97


Running epoch 0, step 97, batch 97

rank 0 | epoch 0 | step 97 | batch 97
rank 1 | epoch 0 | step 97 | batch 97


Running epoch 0, step 97, batch 97


rank 3 | epoch 0 | step 97 | batch 97


Running epoch 0, step 97, batch 97


Running epoch 0, step 97, batch 97
Sampled inputs[:2]: tensor([[   0, 1640, 1103,  ...,  685, 1478,   14],
        [   0, 6010,  829,  ...,  668, 1784,  587]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   471,    14,  ...,  1260,  2129,   367],
        [    0, 43587,  1390,  ...,    12,   768,  1952]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   515,   352,  ...,    40, 25575,   292],
        [    0,    22,  2577,  ...,  4970,     9,  3868]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  9577,  2789,  ...,  1042,  9086,   623],
        [    0, 42306,   278,  ...,  1110,  3427,  4224]], device='cuda:0')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 97, Loss: 1.2214046716690063
rank: 1, step 97, Loss: 1.1887714862823486
rank: 2, step 97, Loss: 1.1993523836135864
rank: 0, step 97, Loss: 1.2104783058166504




rank 2 | epoch 0 | step 98 | batch 98
rank 3 | epoch 0 | step 98 | batch 98



Running epoch 0, step 98, batch 98

Running epoch 0, step 98, batch 98


rank 1 | epoch 0 | step 98 | batch 98


Running epoch 0, step 98, batch 98
Sampled inputs[:2]: tensor([[    0,   685,   344,  ...,   680,   401,   616],
        [    0,   389, 18984,  ...,   287,   768,  1070]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1503, 1785,  ...,  221,  380, 1869],
        [   0,   12,  344,  ...,   14, 2295,  516]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    12,   287,  ...,    12,  5576,    12],
        [    0,   508, 12163,  ...,  4920,   344, 11003]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank 0 | epoch 0 | step 98 | batch 98
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 98, batch 98
Sampled inputs[:2]: tensor([[    0,   892,   271,  ...,   278,   266, 10237],
        [    0,    69,   462,  ...,   437,   266,   634]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 98, Loss: 1.2174376249313354
rank: 3, step 98, Loss: 1.2112118005752563
rank: 2, step 98, Loss: 1.1979190111160278
rank: 0, step 98, Loss: 1.1921991109848022




rank 2 | epoch 0 | step 99 | batch 99
rank 3 | epoch 0 | step 99 | batch 99
rank 0 | epoch 0 | step 99 | batch 99



Running epoch 0, step 99, batch 99

Running epoch 0, step 99, batch 99



rank 1 | epoch 0 | step 99 | batch 99


Running epoch 0, step 99, batch 99

Running epoch 0, step 99, batch 99

Sampled inputs[:2]: tensor([[   0,  591,  688,  ...,  271, 3390,   12],
        [   0, 1580,  271,  ...,  656,  943, 1883]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  5041,    14,  ...,  1027,  1722,  6554],
        [    0,  7294, 23782,  ...,   471, 11528,  3437]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1358,   367,  ...,  1758,  2921,    12],
        [    0,   259, 19567,  ...,   266,  3899,  2123]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,   271,  4787,  ...,   292,   494,   221],
        [    0,  4601,   328,  ..., 10258,  2282,    12]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 99, Loss: 1.2069308757781982
rank: 3, step 99, Loss: 1.2065831422805786
rank: 0, step 99, Loss: 1.189834713935852
rank: 2, step 99, Loss: 1.2047874927520752




rank 2 | epoch 0 | step 100 | batch 100


Running epoch 0, step 100, batch 100

rank 3 | epoch 0 | step 100 | batch 100


Running epoch 0, step 100, batch 100

rank 0 | epoch 0 | step 100 | batch 100
rank 1 | epoch 0 | step 100 | batch 100


Running epoch 0, step 100, batch 100



Running epoch 0, step 100, batch 100
Sampled inputs[:2]: tensor([[   0,   12, 4957,  ...,  944,  278,  609],
        [   0,  795, 1445,  ..., 6292,  287, 9782]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    14,  8047,  ...,  3813,     9,  8237],
        [    0,    13,  1529,  ..., 15682,  1355,   259]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   320,   472,  ...,  1345,    14,  1869],
        [    0,    14,    71,  ...,   278, 14258, 12440]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3806,    13,  ..., 11786,  2254,   221],
        [    0,   266,  4616,  ...,  1906,  7256,   287]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 100, Loss: 1.2198182344436646
rank: 2, step 100, Loss: 1.2101988792419434
rank: 0, step 100, Loss: 1.203028917312622


rank: 1, step 100, Loss: 1.211731195449829


rank 3 | epoch 0 | step 101 | batch 101
rank 2 | epoch 0 | step 101 | batch 101


rank 0 | epoch 0 | step 101 | batch 101

Running epoch 0, step 101, batch 101

Running epoch 0, step 101, batch 101




Running epoch 0, step 101, batch 101

rank 1 | epoch 0 | step 101 | batch 101


Running epoch 0, step 101, batch 101Sampled inputs[:2]: tensor([[    0,  7110,   437,  ...,   266,  6724,  2655],
        [    0,    12,   461,  ...,  2525,   278, 23762]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   408,  1782,  ...,   271,   729,  1692],
        [    0,   266,   858,  ..., 11265,   607,  7455]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,  578,  221,  ...,  287, 1254, 4318],
        [   0, 5340,  287,  ...,  912, 2837, 5340]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,    13, 20773,  ..., 22463,  2587,   292],
        [    0,    14,   560,  ...,    12,  8593,   266]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 101, Loss: 1.2047377824783325
rank: 1, step 101, Loss: 1.2000312805175781
rank: 2, step 101, Loss: 1.2192343473434448



rank: 0, step 101, Loss: 1.2204033136367798

rank 2 | epoch 0 | step 102 | batch 102
rank 3 | epoch 0 | step 102 | batch 102



Running epoch 0, step 102, batch 102

Running epoch 0, step 102, batch 102


rank 1 | epoch 0 | step 102 | batch 102


Running epoch 0, step 102, batch 102
Sampled inputs[:2]: tensor([[    0,   292, 17190,  ...,  3078,     9,   287],
        [    0,  2336,    26,  ...,  2564,   271,  1422]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 7849,  278,  ...,  346,  462,  221],
        [   0, 1471,  266,  ...,  525, 5202,  292]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 1644, 1742,  ...,  287, 1704, 2044],
        [   0,    9,  342,  ...,   12,  709,  857]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank 0 | epoch 0 | step 102 | batch 102
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 102, batch 102
Sampled inputs[:2]: tensor([[    0,   278, 39533,  ...,   277,  1395, 47607],
        [    0,  2467, 18011,  ...,  5913,  9281,    12]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 102, Loss: 1.2034070491790771
rank: 0, step 102, Loss: 1.205836534500122
rank: 1, step 102, Loss: 1.1932586431503296
rank: 2, step 102, Loss: 1.2015022039413452




rank 0 | epoch 0 | step 103 | batch 103
rank 2 | epoch 0 | step 103 | batch 103


rank 3 | epoch 0 | step 103 | batch 103


Running epoch 0, step 103, batch 103


Running epoch 0, step 103, batch 103


Running epoch 0, step 103, batch 103
rank 1 | epoch 0 | step 103 | batch 103



Running epoch 0, step 103, batch 103
Sampled inputs[:2]: tensor([[    0,   266,  1624,  ...,    14,    19,    14],
        [    0, 28559,  1357,  ...,  7720,  1398, 41925]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,     5,  4413,  ...,  9205, 16744,   775],
        [    0,   756,    12,  ..., 29374,    12,  2726]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  2416,   352,  ...,   278,  1036, 16832],
        [    0,   328,  1690,  ...,  2670,   287, 11287]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    17,  3737,  ...,   298,   396,   221],
        [    0,  6660, 13165,  ...,   380,   333,   199]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 103, Loss: 1.2156068086624146
rank: 1, step 103, Loss: 1.2050069570541382
rank: 2, step 103, Loss: 1.2000786066055298


Graident accumulation at epoch 0, step 103, batch 103Graident accumulation at epoch 0, step 103, batch 103


rank: 0, step 103, Loss: 1.2002419233322144
Graident accumulation at epoch 0, step 103, batch 103
Graident accumulation at epoch 0, step 103, batch 103

rank 2 | epoch 0 | step 104 | batch 104


Running epoch 0, step 104, batch 104

rank 3 | epoch 0 | step 104 | batch 104


Running epoch 0, step 104, batch 104

rank 1 | epoch 0 | step 104 | batch 104


Running epoch 0, step 104, batch 104

rank 0 | epoch 0 | step 104 | batch 104
Sampled inputs[:2]: tensor([[   0,  857,  344,  ..., 1529, 9106, 1447],
        [   0,  825, 3066,  ..., 1184,  266, 7964]], device='cuda:2')


Running epoch 0, step 104, batch 104Sampled inputs[:2]: tensor([[    0,    14,   759,  ..., 15790,   278,   706],
        [    0,   298, 11712,  ...,   221,   273,   298]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   300, 26138,  ...,  7856,    14, 17535],
        [    0,   221,   474,  ...,  6451,   292,    34]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0, 4073, 1548,  ...,  292,  221,  301],
        [   0,   11,  360,  ..., 4524, 1553,  401]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 104, Loss: 1.185789704322815
rank: 1, step 104, Loss: 1.2012155055999756
rank: 2, step 104, Loss: 1.1902985572814941

rank: 0, step 104, Loss: 1.2058757543563843



rank 2 | epoch 0 | step 105 | batch 105
rank 3 | epoch 0 | step 105 | batch 105



Running epoch 0, step 105, batch 105

Running epoch 0, step 105, batch 105


rank 0 | epoch 0 | step 105 | batch 105
rank 1 | epoch 0 | step 105 | batch 105


Running epoch 0, step 105, batch 105



Running epoch 0, step 105, batch 105
Sampled inputs[:2]: tensor([[   0, 2377,  271,  ...,  395,  394,   14],
        [   0,  328, 1410,  ..., 7344,   12, 5067]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   342,  8514,  ...,   266, 46850,  2545],
        [    0,   277,   279,  ...,    12,   287,   259]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   494,   298,  ...,   408, 32859, 14550],
        [    0,   199, 11296,  ...,   266, 10463,  8256]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,   17,  292,  ..., 8055,  365, 3125],
        [   0, 1253,  287,  ..., 2988,   14,  417]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 105, Loss: 1.209835410118103
rank: 2, step 105, Loss: 1.1870640516281128
rank: 3, step 105, Loss: 1.1903489828109741
rank: 1, step 105, Loss: 1.2141972780227661




rank 2 | epoch 0 | step 106 | batch 106
rank 3 | epoch 0 | step 106 | batch 106


rank 0 | epoch 0 | step 106 | batch 106

Running epoch 0, step 106, batch 106

Running epoch 0, step 106, batch 106



rank 1 | epoch 0 | step 106 | batch 106


Running epoch 0, step 106, batch 106

Running epoch 0, step 106, batch 106

Sampled inputs[:2]: tensor([[    0,  9423,   298,  ...,  5274, 37902,   271],
        [    0,   380, 26073,  ...,   709,   266,  2421]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 14161,  1241,  ..., 15255,   768,  4239],
        [    0,    14,  1147,  ...,    19,    14, 42301]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   669,    14,  ...,   596,   292,   494],
        [    0,   944,   278,  ..., 17330,  1683,   360]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    12,   401,  ...,  7665,  4101, 10193],
        [    0,   275,   467,  ...,   298,   365,  2714]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 106, Loss: 1.202536940574646
rank: 1, step 106, Loss: 1.2147963047027588
rank: 2, step 106, Loss: 1.2192059755325317
rank: 0, step 106, Loss: 1.1890900135040283




rank 2 | epoch 0 | step 107 | batch 107
rank 3 | epoch 0 | step 107 | batch 107



Running epoch 0, step 107, batch 107

Running epoch 0, step 107, batch 107


rank 1 | epoch 0 | step 107 | batch 107


Running epoch 0, step 107, batch 107

rank 0 | epoch 0 | step 107 | batch 107


Running epoch 0, step 107, batch 107Sampled inputs[:2]: tensor([[    0,    12,  1471,  ...,  1356,   600,    12],
        [    0,    13, 20793,  ...,    17,   287,  1356]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   12,  287,  ...,  266, 2105, 3925],
        [   0,  369,  726,  ...,  292,  221,  358]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,   12,  287,  ..., 4626,   27,  292],
        [   0,  344, 8133,  ...,  368, 1119, 5539]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  5301,   792,  ..., 27135, 34090,   292],
        [    0, 11030,    72,  ...,   259, 16979,  9415]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 107, Loss: 1.2075474262237549
rank: 1, step 107, Loss: 1.2018773555755615
rank: 2, step 107, Loss: 1.189797282218933
rank: 0, step 107, Loss: 1.2182714939117432




rank 2 | epoch 0 | step 108 | batch 108
rank 3 | epoch 0 | step 108 | batch 108



Running epoch 0, step 108, batch 108

Running epoch 0, step 108, batch 108


rank 0 | epoch 0 | step 108 | batch 108
rank 1 | epoch 0 | step 108 | batch 108



Running epoch 0, step 108, batch 108


Running epoch 0, step 108, batch 108
Sampled inputs[:2]: tensor([[    0, 10511,  3887,  ...,  3504,   298,   422],
        [    0,   767,  1615,  ...,  2952,  1760,     9]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 5281, 4452,  ...,   14, 3391,   12],
        [   0,  259, 2180,  ...,  638, 1615,  694]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,    14, 45192,  ..., 24171,   292,  3620],
        [    0,   381,  1795,  ...,    12,   344,   593]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   409,   699,  ...,    12,   546,   696],
        [    0,  1360,    14,  ..., 31575, 28569,   292]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 108, Loss: 1.204624891281128
rank: 1, step 108, Loss: 1.2087256908416748
rank: 2, step 108, Loss: 1.2024695873260498
rank: 0, step 108, Loss: 1.2136350870132446




rank 3 | epoch 0 | step 109 | batch 109
rank 2 | epoch 0 | step 109 | batch 109
rank 0 | epoch 0 | step 109 | batch 109



Running epoch 0, step 109, batch 109

Running epoch 0, step 109, batch 109



rank 1 | epoch 0 | step 109 | batch 109


Running epoch 0, step 109, batch 109

Running epoch 0, step 109, batch 109

Sampled inputs[:2]: tensor([[    0, 38136,    12,  ...,   367, 12851,  1040],
        [    0,   266,  2623,  ...,     5, 10781,   287]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,   12,  689,  ..., 1110, 1712, 2228],
        [   0,  221,  381,  ...,  360, 8978,   14]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   266,  2552,  ...,    13, 16179,   800],
        [    0,  6067,  1188,  ...,  5282,   756,   342]], device='cuda:1')Sampled inputs[:2]: tensor([[    0, 31318,    14,  ...,  1682,  1501,  1548],
        [    0,   446, 23105,  ..., 11867,   824,   368]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 109, Loss: 1.200186848640442
rank: 1, step 109, Loss: 1.2105650901794434
rank: 2, step 109, Loss: 1.203622817993164



rank: 0, step 109, Loss: 1.2127805948257446

rank 2 | epoch 0 | step 110 | batch 110

rank 3 | epoch 0 | step 110 | batch 110


Running epoch 0, step 110, batch 110


Running epoch 0, step 110, batch 110

rank 1 | epoch 0 | step 110 | batch 110


Running epoch 0, step 110, batch 110

rank 0 | epoch 0 | step 110 | batch 110


Running epoch 0, step 110, batch 110
Sampled inputs[:2]: tensor([[   0,   45,   17,  ...,  278, 4112,   14],
        [   0, 8822, 1486,  ...,   12,  287, 6903]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 25845,  4034,  ...,   474,   221,   474],
        [    0,   446, 21112,  ..., 22092,    22,    27]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  4889,  3593,  ..., 19787,   287, 22475],
        [    0,   266,  1890,  ...,   287, 38242,    13]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3544,   417,  ...,   380,   381,  3794],
        [    0,    15, 43895,  ...,   292,   380, 16795]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 110, Loss: 1.2120376825332642
rank: 3, step 110, Loss: 1.2214477062225342
rank: 2, step 110, Loss: 1.1912833452224731



rank: 0, step 110, Loss: 1.2118561267852783

rank 3 | epoch 0 | step 111 | batch 111
rank 2 | epoch 0 | step 111 | batch 111



Running epoch 0, step 111, batch 111

Running epoch 0, step 111, batch 111


rank 1 | epoch 0 | step 111 | batch 111


Running epoch 0, step 111, batch 111
Sampled inputs[:2]: tensor([[    0,  1371, 10516,  ...,  2456,    13,  6469],
        [    0,  1824,    13,  ...,   266,  5940,    19]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 20596,  2943,  ...,  5560,  2512,   266],
        [    0,  1236, 14637,  ...,  6601,  3058,    12]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   278,   266,  ...,   274, 30228,   287],
        [    0,  1911,   679,  ...,    19,  3737,   609]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 111 | batch 111


Running epoch 0, step 111, batch 111
Sampled inputs[:2]: tensor([[    0,  1806,   319,  ...,  3427,   278,   266],
        [    0, 10205,   342,  ...,  2523,  4729, 13753]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 111, Loss: 1.2112733125686646
rank: 1, step 111, Loss: 1.216761589050293
rank: 2, step 111, Loss: 1.2030361890792847
rank: 0, step 111, Loss: 1.2132751941680908



Graident accumulation at epoch 0, step 111, batch 111Graident accumulation at epoch 0, step 111, batch 111

Graident accumulation at epoch 0, step 111, batch 111
Graident accumulation at epoch 0, step 111, batch 111

rank 2 | epoch 0 | step 112 | batch 112

rank 3 | epoch 0 | step 112 | batch 112


Running epoch 0, step 112, batch 112


Running epoch 0, step 112, batch 112

rank 1 | epoch 0 | step 112 | batch 112

rank 0 | epoch 0 | step 112 | batch 112

Running epoch 0, step 112, batch 112



Running epoch 0, step 112, batch 112Sampled inputs[:2]: tensor([[    0,  1336,   287,  ..., 15920,    12,   287],
        [    0,  4175,   437,  ...,  1700,    14,   381]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,    13, 10036,  ...,   328,  2347, 12801],
        [    0,  1477,  5648,  ...,  4391,  1722,   369]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0, 11661,    12,  ...,  1707,   394,   264],
        [    0,  1086,    26,  ...,   298,   527,   298]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  221,  709,  ..., 3365, 3504,  278],
        [   0, 2366, 5036,  ..., 1477,  352,  631]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 112, Loss: 1.1864513158798218
rank: 3, step 112, Loss: 1.2087557315826416
rank: 0, step 112, Loss: 1.193963885307312
rank: 2, step 112, Loss: 1.2024641036987305




rank 2 | epoch 0 | step 113 | batch 113
rank 3 | epoch 0 | step 113 | batch 113


rank 0 | epoch 0 | step 113 | batch 113

Running epoch 0, step 113, batch 113

Running epoch 0, step 113, batch 113



rank 1 | epoch 0 | step 113 | batch 113


Running epoch 0, step 113, batch 113

Running epoch 0, step 113, batch 113

Sampled inputs[:2]: tensor([[    0, 40624,   266,  ..., 12236,   292,    41],
        [    0,   809,   367,  ...,   717,   287,  1548]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  292, 2860,  ...,  266, 7000, 7806],
        [   0,  266, 6071,  ..., 1061, 1107,  839]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  8158,  1416,  ...,   413,    29,   413],
        [    0,  5506,   696,  ...,   607, 11129,   276]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,   43,  527,  ..., 4309,   14, 8050],
        [   0, 1478,   14,  ...,  266, 9417, 9105]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 113, Loss: 1.2277804613113403
rank: 2, step 113, Loss: 1.1930688619613647
rank: 3, step 113, Loss: 1.1961896419525146
rank: 1, step 113, Loss: 1.2049344778060913




rank 2 | epoch 0 | step 114 | batch 114
rank 0 | epoch 0 | step 114 | batch 114

rank 3 | epoch 0 | step 114 | batch 114

Running epoch 0, step 114, batch 114




Running epoch 0, step 114, batch 114

rank 1 | epoch 0 | step 114 | batch 114

Running epoch 0, step 114, batch 114



Running epoch 0, step 114, batch 114
Sampled inputs[:2]: tensor([[   0,  494,  825,  ...,  897,  328,  275],
        [   0, 2992,  352,  ...,  259, 2063, 6088]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    21,    66,  ...,  1377,   278,  1634],
        [    0,  9342,   600,  ...,   199, 12095,   291]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  292,  474,  ..., 1085,  494, 2665],
        [   0,  638, 1276,  ..., 1589, 2432,  292]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 2228, 1416,  ..., 3766,  266, 1136],
        [   0,   12,  287,  ...,  381, 3513, 1501]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 114, Loss: 1.1875295639038086
rank: 3, step 114, Loss: 1.200484037399292
rank: 0, step 114, Loss: 1.2109977006912231

rank: 2, step 114, Loss: 1.2211543321609497



rank 0 | epoch 0 | step 115 | batch 115
rank 2 | epoch 0 | step 115 | batch 115
rank 3 | epoch 0 | step 115 | batch 115




Running epoch 0, step 115, batch 115

Running epoch 0, step 115, batch 115



Running epoch 0, step 115, batch 115
rank 1 | epoch 0 | step 115 | batch 115



Running epoch 0, step 115, batch 115
Sampled inputs[:2]: tensor([[    0,   792,    83,  ..., 29085, 15914,   365],
        [    0,    12, 12774,  ...,  1231,   278,   266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  3231,   271,  ...,  9279,  8231, 28871],
        [    0,   367,  1236,  ...,   344,   292,    20]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   266,  1790,  ...,   292,    78,   527],
        [    0,  1278,    69,  ...,    15,  7377, 20524]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   560,   199,  ...,   266,  1371,  4811],
        [    0,   287,   298,  ..., 14121,  3121,   409]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 115, Loss: 1.205904245376587
rank: 1, step 115, Loss: 1.2107040882110596
rank: 2, step 115, Loss: 1.2096903324127197
rank: 0, step 115, Loss: 1.2016067504882812




rank 3 | epoch 0 | step 116 | batch 116

rank 2 | epoch 0 | step 116 | batch 116


Running epoch 0, step 116, batch 116


Running epoch 0, step 116, batch 116

rank 1 | epoch 0 | step 116 | batch 116

rank 0 | epoch 0 | step 116 | batch 116

Running epoch 0, step 116, batch 116



Running epoch 0, step 116, batch 116
Sampled inputs[:2]: tensor([[   0, 2587,   27,  ...,  259, 2462, 1220],
        [   0, 5260,  365,  ..., 7242,  471,  391]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 17734,    12,  ...,   278,  2421,   940],
        [    0, 14026,  4137,  ..., 12292,  1553,   278]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   902, 11331,  ...,  1795,   365,   654],
        [    0,  3933,  6394,  ...,  1364,   950,   847]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1529,   354,  ...,   709,   271,   266],
        [    0,   594,    84,  ..., 24411, 14140, 12720]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 116, Loss: 1.2171518802642822
rank: 3, step 116, Loss: 1.2106081247329712
rank: 0, step 116, Loss: 1.1983966827392578
rank: 2, step 116, Loss: 1.192970633506775




rank 2 | epoch 0 | step 117 | batch 117
rank 3 | epoch 0 | step 117 | batch 117



Running epoch 0, step 117, batch 117

Running epoch 0, step 117, batch 117


rank 0 | epoch 0 | step 117 | batch 117
rank 1 | epoch 0 | step 117 | batch 117


Running epoch 0, step 117, batch 117



Running epoch 0, step 117, batch 117
Sampled inputs[:2]: tensor([[    0,   266,  6079,  ...,   437,   266, 44526],
        [    0,  2386,  4012,  ...,   300, 15480,  1036]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1128, 3231,  ..., 8375,  199, 2038],
        [   0,  300,  266,  ...,   13, 2920,  609]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0, 37312,    12,  ...,   278,   795, 40854],
        [    0, 24063,   717,  ...,  2228,  1416,     9]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0, 7018,   14,  ..., 8288,   12, 1250],
        [   0,  287,  259,  ..., 5041, 1826, 5041]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 117, Loss: 1.2156805992126465
rank: 1, step 117, Loss: 1.204928994178772
rank: 2, step 117, Loss: 1.1987321376800537
rank: 0, step 117, Loss: 1.1810249090194702




rank 2 | epoch 0 | step 118 | batch 118
rank 3 | epoch 0 | step 118 | batch 118



Running epoch 0, step 118, batch 118

Running epoch 0, step 118, batch 118


rank 1 | epoch 0 | step 118 | batch 118


Running epoch 0, step 118, batch 118

rank 0 | epoch 0 | step 118 | batch 118
Sampled inputs[:2]: tensor([[   0, 1737,  278,  ..., 2604,  367, 2002],
        [   0, 1732,  699,  ...,  417,  199, 1726]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  596,  292,  ...,   13, 6673,  298],
        [   0,   13, 1529,  ...,  943,  266, 9479]], device='cuda:3')


Running epoch 0, step 118, batch 118
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   292,   380,  ...,   287, 10086,   300],
        [    0,   266, 15258,  ...,  2366,   368,  3988]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3594,   950,  ...,  6517,   344, 15386],
        [    0,  2736,  2523,  ...,  4086,  4798,  7701]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 118, Loss: 1.2069802284240723
rank: 1, step 118, Loss: 1.199698805809021
rank: 2, step 118, Loss: 1.1975257396697998
rank: 0, step 118, Loss: 1.2274450063705444




rank 2 | epoch 0 | step 119 | batch 119
rank 3 | epoch 0 | step 119 | batch 119
rank 0 | epoch 0 | step 119 | batch 119



Running epoch 0, step 119, batch 119

Running epoch 0, step 119, batch 119




Running epoch 0, step 119, batch 119

rank 1 | epoch 0 | step 119 | batch 119


Running epoch 0, step 119, batch 119
Sampled inputs[:2]: tensor([[   0,   12,  287,  ...,  278, 4697,   14],
        [   0, 4672,  278,  ..., 7523, 2305,   13]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1250,  1797,  ...,   266,  1417,   367],
        [    0,   342,  3001,  ...,   369, 11195,   367]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   266,   283,  ...,   271, 48829,   580],
        [    0,   292,   474,  ...,   446, 14932,   365]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[    0,   546, 28676,  ...,   271,  1267,   328],
        [    0,   857,   352,  ...,  3608,   271,   995]], device='cuda:1')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 1, step 119, Loss: 1.2122715711593628
rank: 3, step 119, Loss: 1.1960718631744385
rank: 2, step 119, Loss: 1.2155661582946777
rank: 0, step 119, Loss: 1.2207509279251099



Graident accumulation at epoch 0, step 119, batch 119Graident accumulation at epoch 0, step 119, batch 119

Graident accumulation at epoch 0, step 119, batch 119
Graident accumulation at epoch 0, step 119, batch 119

rank 3 | epoch 0 | step 120 | batch 120
rank 2 | epoch 0 | step 120 | batch 120



Running epoch 0, step 120, batch 120

Running epoch 0, step 120, batch 120


rank 1 | epoch 0 | step 120 | batch 120


Running epoch 0, step 120, batch 120

rank 0 | epoch 0 | step 120 | batch 120Sampled inputs[:2]: tensor([[    0,   278,  1478,  ...,   266,  1607,  1220],
        [    0,    12,  6426,  ...,  2629, 13422,    12]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   300,   266,  ...,   266,   912, 11457],
        [    0,   360,   259,  ...,  5710,   278,  2433]], device='cuda:3')



Running epoch 0, step 120, batch 120Sampled inputs[:2]: tensor([[    0, 33119,   391,  ...,   292,  4462,  2721],
        [    0,  1875,  2117,  ...,  1422,  1059,   963]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  266, 3536,  ...,  266, 1883,  266],
        [   0,  271, 8278,  ...,  271, 8278, 3560]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 120, Loss: 1.2033493518829346
rank: 2, step 120, Loss: 1.1800044775009155
rank: 0, step 120, Loss: 1.2112934589385986
rank: 3, step 120, Loss: 1.2021687030792236




rank 0 | epoch 0 | step 121 | batch 121
rank 2 | epoch 0 | step 121 | batch 121
rank 3 | epoch 0 | step 121 | batch 121



Running epoch 0, step 121, batch 121

Running epoch 0, step 121, batch 121



rank 1 | epoch 0 | step 121 | batch 121

Running epoch 0, step 121, batch 121


Running epoch 0, step 121, batch 121

Sampled inputs[:2]: tensor([[    0, 11657,   367,  ..., 31468,    26,   266],
        [    0,   266,  1916,  ...,   292, 12946,     9]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  515,  352,  ..., 2326, 3595, 6887],
        [   0, 3767, 2337,  ...,  950,  847,  300]], device='cuda:3')

Sampled inputs[:2]: tensor([[  0,  12, 638,  ..., 380, 560, 199],
        [  0, 328, 266,  ..., 382,  17,  13]], device='cuda:0')Sampled inputs[:2]: tensor([[   0, 2013,   13,  ...,  271,  266,  908],
        [   0, 1774, 1781,  ..., 4685,  409, 4614]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 0, step 121, Loss: 1.2137869596481323
rank: 2, step 121, Loss: 1.1978358030319214
rank: 1, step 121, Loss: 1.20529305934906
rank: 3, step 121, Loss: 1.2164615392684937




rank 0 | epoch 0 | step 122 | batch 122
rank 3 | epoch 0 | step 122 | batch 122


rank 2 | epoch 0 | step 122 | batch 122


Running epoch 0, step 122, batch 122


Running epoch 0, step 122, batch 122


Running epoch 0, step 122, batch 122

rank 1 | epoch 0 | step 122 | batch 122


Running epoch 0, step 122, batch 122
Sampled inputs[:2]: tensor([[    0,    15,  4291,  ...,  1685,   278,  2101],
        [    0,  2715, 10929,  ...,  4978,   287,   266]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,  266, 6449,  ...,  474,  221,  474],
        [   0, 6518,  681,  ...,  401, 9748,  391]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  7219,   591,  ...,   278,   266,  5908],
        [    0, 10446,    14,  ...,   266,  1164,   287]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,    14, 49601,  ...,    12,   298,   374],
        [    0,  5862,    13,  ..., 12497,   287,  3570]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 1, step 122, Loss: 1.1917598247528076
rank: 3, step 122, Loss: 1.1951286792755127
rank: 0, step 122, Loss: 1.2086085081100464
rank: 2, step 122, Loss: 1.198042392730713




rank 2 | epoch 0 | step 123 | batch 123
rank 3 | epoch 0 | step 123 | batch 123



Running epoch 0, step 123, batch 123

Running epoch 0, step 123, batch 123


rank 1 | epoch 0 | step 123 | batch 123


Running epoch 0, step 123, batch 123

rank 0 | epoch 0 | step 123 | batch 123


Running epoch 0, step 123, batch 123
Sampled inputs[:2]: tensor([[   0,  413,   16,  ...,  680,  401, 1407],
        [   0,  292, 3030,  ..., 1231, 2156,  266]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  271, 8429,  ..., 9404,  963,  344],
        [   0,  790, 2816,  ...,   14, 1062,  668]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 1099, 2851,  ...,  518,  496,  287],
        [   0, 1085, 4878,  ...,  298,  894,  496]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  870,  278,  ...,  478,  401,  897],
        [   0,  278, 1620,  ...,  360, 1758,  278]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 123, Loss: 1.2114039659500122
rank: 1, step 123, Loss: 1.1924889087677002
rank: 2, step 123, Loss: 1.2040479183197021



rank: 0, step 123, Loss: 1.1874827146530151

rank 2 | epoch 0 | step 124 | batch 124

rank 0 | epoch 0 | step 124 | batch 124
rank 3 | epoch 0 | step 124 | batch 124

Running epoch 0, step 124, batch 124




Running epoch 0, step 124, batch 124

rank 1 | epoch 0 | step 124 | batch 124


Running epoch 0, step 124, batch 124

Running epoch 0, step 124, batch 124

Sampled inputs[:2]: tensor([[   0,  531, 9804,  ..., 1027,  360, 1576],
        [   0, 2973,   30,  ...,  408,  259, 1914]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1380,   342,  ...,  3904,   259,   624],
        [    0, 30229,    12,  ...,   518,   717,   271]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  516, 1424,  ..., 3473,  278, 2442],
        [   0, 1615,  287,  ...,  259,  623,   12]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  3115,  1640,  ...,   300,   266,  5453],
        [    0, 39200,  1828,  ...,   300,  3067,  4443]], device='cuda:0')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 124, Loss: 1.1940449476242065
rank: 0, step 124, Loss: 1.2104878425598145
rank: 3, step 124, Loss: 1.1959890127182007
rank: 2, step 124, Loss: 1.2085939645767212




rank 3 | epoch 0 | step 125 | batch 125
rank 2 | epoch 0 | step 125 | batch 125



Running epoch 0, step 125, batch 125

Running epoch 0, step 125, batch 125


rank 1 | epoch 0 | step 125 | batch 125

rank 0 | epoch 0 | step 125 | batch 125

Running epoch 0, step 125, batch 125



Running epoch 0, step 125, batch 125
Sampled inputs[:2]: tensor([[    0,  1040,   287,  ...,    14, 10209,    12],
        [    0, 25409,   287,  ...,  1005,   344,  3493]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 15912,    14,  ..., 25535,    18,  3947],
        [    0,   278,  3358,  ...,    12,   287,  9612]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0, 24414,  4865,  ...,  8720,   344,  1566],
        [    0,  2836,  3084,  ...,  3634,  6464,   271]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2700, 5221,  ...,  298,  259,  298],
        [   0,  266, 2511,  ..., 3220, 4164, 1173]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 125, Loss: 1.1909810304641724
rank: 2, step 125, Loss: 1.1975165605545044
rank: 1, step 125, Loss: 1.177045464515686
rank: 0, step 125, Loss: 1.1974058151245117




rank 3 | epoch 0 | step 126 | batch 126
rank 2 | epoch 0 | step 126 | batch 126

rank 0 | epoch 0 | step 126 | batch 126


Running epoch 0, step 126, batch 126


Running epoch 0, step 126, batch 126


rank 1 | epoch 0 | step 126 | batch 126


Running epoch 0, step 126, batch 126

Running epoch 0, step 126, batch 126

Sampled inputs[:2]: tensor([[    0,   328,  2097,  ...,   365,  1941,   607],
        [    0,  2823,   287,  ...,  3504,     9, 13910]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 48598,  3313,  ...,  3482,    12,  1099],
        [    0,   395,  4973,  ...,  5851,   409,  4370]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 3059, 2013,  ...,  278, 1997,   14],
        [   0, 8353, 1842,  ...,   38,  643,  472]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  380,  341,  ...,  955,  644,  271],
        [   0, 5221, 7166,  ..., 4309,  342,  996]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 126, Loss: 1.203302264213562
rank: 0, step 126, Loss: 1.2011256217956543
rank: 3, step 126, Loss: 1.2216488122940063
rank: 1, step 126, Loss: 1.19779372215271




rank 3 | epoch 0 | step 127 | batch 127
rank 2 | epoch 0 | step 127 | batch 127



Running epoch 0, step 127, batch 127

Running epoch 0, step 127, batch 127


rank 1 | epoch 0 | step 127 | batch 127


Running epoch 0, step 127, batch 127

rank 0 | epoch 0 | step 127 | batch 127
Sampled inputs[:2]: tensor([[    0,  4347,   638,  ...,  1345,   292, 15343],
        [    0,  7120,   344,  ...,  6273,    52, 22639]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  421, 6007,  ...,  408, 2105,  843],
        [   0, 1550, 2013,  ..., 9970,  638, 6482]], device='cuda:3')



Running epoch 0, step 127, batch 127
Sampled inputs[:2]: tensor([[    0,  1706,  8554,  ...,  9742,   221, 14082],
        [    0,  6976, 16084,  ...,    19,  9955,  3854]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   14, 2787,  ..., 9674, 2491,   12],
        [   0,   12,  221,  ...,  593,  360,  726]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 127, Loss: 1.185103416442871
rank: 1, step 127, Loss: 1.224883794784546
rank: 0, step 127, Loss: 1.185171127319336
rank: 2, step 127, Loss: 1.220238208770752



Graident accumulation at epoch 0, step 127, batch 127Graident accumulation at epoch 0, step 127, batch 127

Graident accumulation at epoch 0, step 127, batch 127
Graident accumulation at epoch 0, step 127, batch 127

rank 2 | epoch 0 | step 128 | batch 128
rank 3 | epoch 0 | step 128 | batch 128



Running epoch 0, step 128, batch 128

Running epoch 0, step 128, batch 128


rank 0 | epoch 0 | step 128 | batch 128
rank 1 | epoch 0 | step 128 | batch 128



Running epoch 0, step 128, batch 128


Running epoch 0, step 128, batch 128
Sampled inputs[:2]: tensor([[    0, 10766,  8311,  ...,   328,   957,  1231],
        [    0,   560,   199,  ...,   292, 12605,  2096]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    13, 32291,  ...,  3740,  3616,  1274],
        [    0, 47684,   292,  ...,   287, 49958, 22022]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  4672,   278,  ...,    13,   265, 49987],
        [    0,    17,    14,  ...,   650,  1711,   897]], device='cuda:1')


Sampled inputs[:2]: tensor([[    0,    14,  6707,  ..., 17771,   300,   259],
        [    0,   729,  3084,  ...,   381,  1445,   642]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 128, Loss: 1.2184442281723022
rank: 1, step 128, Loss: 1.216881513595581
rank: 2, step 128, Loss: 1.1934877634048462
rank: 3, step 128, Loss: 1.2040561437606812




rank 3 | epoch 0 | step 129 | batch 129
rank 2 | epoch 0 | step 129 | batch 129


rank 0 | epoch 0 | step 129 | batch 129

Running epoch 0, step 129, batch 129

Running epoch 0, step 129, batch 129


rank 1 | epoch 0 | step 129 | batch 129



Running epoch 0, step 129, batch 129


Running epoch 0, step 129, batch 129
Sampled inputs[:2]: tensor([[   0,   14,  747,  ..., 2039,  287, 8053],
        [   0, 2241, 8274,  ...,  908, 1811,  278]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 38717,  1679,  ...,   472,   346,   462],
        [    0,   281,   221,  ...,  2236, 15064,  1458]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,   14, 3080,  ...,  910,  266, 5275],
        [   0, 7333,  342,  ...,   13, 1818, 6183]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   266,  8802,  ...,  8401,     9,   287],
        [    0,   221,   380,  ..., 10022,    12,   461]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 129, Loss: 1.193249225616455
rank: 2, step 129, Loss: 1.2067689895629883
rank: 1, step 129, Loss: 1.181647777557373

rank: 0, step 129, Loss: 1.1958993673324585



rank 2 | epoch 0 | step 130 | batch 130

rank 3 | epoch 0 | step 130 | batch 130


Running epoch 0, step 130, batch 130


Running epoch 0, step 130, batch 130

rank 0 | epoch 0 | step 130 | batch 130

rank 1 | epoch 0 | step 130 | batch 130

Running epoch 0, step 130, batch 130


Running epoch 0, step 130, batch 130

Sampled inputs[:2]: tensor([[    0,  2577,   995,  ...,  6104,    14,  2032],
        [    0,  3561,   278,  ..., 37517,   278,  1090]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 9116,  278,  ..., 6997, 3244, 1192],
        [   0, 5775,   12,  ...,   12, 1034, 9257]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  2202,   292,  ...,  2431,  2267,  3423],
        [    0, 13509,   472,  ...,  1805,    13, 27816]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  3101,   275,  ...,  2345,   609,   287],
        [    0,  7952,   266,  ..., 10864, 24825,   927]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 130, Loss: 1.1878827810287476
rank: 1, step 130, Loss: 1.2133433818817139
rank: 0, step 130, Loss: 1.203956127166748
rank: 2, step 130, Loss: 1.1968497037887573




rank 2 | epoch 0 | step 131 | batch 131
rank 3 | epoch 0 | step 131 | batch 131


rank 0 | epoch 0 | step 131 | batch 131

Running epoch 0, step 131, batch 131

Running epoch 0, step 131, batch 131




Running epoch 0, step 131, batch 131
rank 1 | epoch 0 | step 131 | batch 131


Running epoch 0, step 131, batch 131

Sampled inputs[:2]: tensor([[    0,  1611,   266,  ...,   266,  2673,  6277],
        [    0,  1041,    14,  ...,   360,   266, 14966]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 2849, 1173,  ..., 1481,   12,  287],
        [   0,  278,  638,  ...,  278,  266, 9387]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,    12,  3570,  ...,   273,   298,   894],
        [    0,  1032,   287,  ...,   266, 33161,  4728]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   287,  4170,  ...,    27, 12612,    13],
        [    0, 45589,    13,  ...,    23,  6873,     9]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 131, Loss: 1.2143280506134033
rank: 3, step 131, Loss: 1.1837973594665527
rank: 0, step 131, Loss: 1.182761549949646
rank: 2, step 131, Loss: 1.2134827375411987




rank 2 | epoch 0 | step 132 | batch 132

rank 3 | epoch 0 | step 132 | batch 132


Running epoch 0, step 132, batch 132


Running epoch 0, step 132, batch 132

rank 1 | epoch 0 | step 132 | batch 132

rank 0 | epoch 0 | step 132 | batch 132

Running epoch 0, step 132, batch 132



Running epoch 0, step 132, batch 132
Sampled inputs[:2]: tensor([[    0,  1403,    12,  ...,  1062,  2283, 13614],
        [    0,  1197,   729,  ...,   674,   369,  8222]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  380,  560,  ...,  287, 6769,  806],
        [   0, 5522, 5662,  ...,  638, 1231, 1098]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  767, 1953,  ...,   14, 1364,   12],
        [   0,  446, 1115,  ..., 1869, 4971, 1954]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,    15,    19,  ...,    12,   287,  7897],
        [    0,  2919,  1482,  ...,   587, 20186,   275]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 132, Loss: 1.2053099870681763
rank: 2, step 132, Loss: 1.1990810632705688
rank: 3, step 132, Loss: 1.2048026323318481
rank: 1, step 132, Loss: 1.1957921981811523




rank 0 | epoch 0 | step 133 | batch 133
rank 2 | epoch 0 | step 133 | batch 133

rank 3 | epoch 0 | step 133 | batch 133


Running epoch 0, step 133, batch 133

Running epoch 0, step 133, batch 133




Running epoch 0, step 133, batch 133
rank 1 | epoch 0 | step 133 | batch 133



Running epoch 0, step 133, batch 133
Sampled inputs[:2]: tensor([[    0,  9041,  8375,  ...,   221,   474, 43112],
        [    0,   271,   266,  ...,  3795,   908,   587]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    12,  1808,  ...,   847,   300, 44349],
        [    0,   342,   266,  ...,    14,  1364, 19388]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   199,  2834,  ...,   287,  3121,   292],
        [    0,  1235,   368,  ..., 12152,  8498,   287]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  591,  953,  ..., 4118, 5750,  292],
        [   0, 5646,   12,  ..., 1952,  287, 3088]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 133, Loss: 1.208449363708496
rank: 1, step 133, Loss: 1.1958898305892944
rank: 0, step 133, Loss: 1.2216203212738037
rank: 2, step 133, Loss: 1.1838843822479248




rank 0 | epoch 0 | step 134 | batch 134
rank 3 | epoch 0 | step 134 | batch 134
rank 2 | epoch 0 | step 134 | batch 134



Running epoch 0, step 134, batch 134

Running epoch 0, step 134, batch 134



rank 1 | epoch 0 | step 134 | batch 134


Running epoch 0, step 134, batch 134

Running epoch 0, step 134, batch 134

Sampled inputs[:2]: tensor([[    0,   587,   300,  ...,  4325,   278, 12564],
        [    0,   259,   587,  ...,    14,    71,   462]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1144,  2680,  ...,   963,     9,  1184],
        [    0,   266,   923,  ...,    14,   298, 12230]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   14,  747,  ..., 8271,  365,  437],
        [   0,  271,  266,  ...,  365, 2463,  391]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,   13, 2497,  ...,  943,  259, 2646],
        [   0,   18,   14,  ...,  380,  981,   12]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 134, Loss: 1.2100342512130737
rank: 3, step 134, Loss: 1.1967040300369263
rank: 2, step 134, Loss: 1.1954079866409302



rank: 0, step 134, Loss: 1.2148630619049072

rank 2 | epoch 0 | step 135 | batch 135


Running epoch 0, step 135, batch 135

rank 3 | epoch 0 | step 135 | batch 135


Running epoch 0, step 135, batch 135

rank 1 | epoch 0 | step 135 | batch 135


Running epoch 0, step 135, batch 135

rank 0 | epoch 0 | step 135 | batch 135
Sampled inputs[:2]: tensor([[    0,   560,   199,  ...,  6408,   278,  1119],
        [    0,  9509, 21000,  ...,  1953,    14,   333]], device='cuda:2')


Running epoch 0, step 135, batch 135Sampled inputs[:2]: tensor([[    0,   342,  4014,  ...,   368,   408,  2105],
        [    0,  1253,  3197,  ...,   271,   266, 27896]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  328,  843,  ...,  298,  292,   37],
        [   0, 2165, 1323,  ...,  199,  677, 8376]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 23487,   273,  ...,   368,   259,   422],
        [    0,  5982,  9385,  ...,    26,   469,   446]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 135, Loss: 1.195352554321289
rank: 0, step 135, Loss: 1.2056154012680054
rank: 3, step 135, Loss: 1.199076533317566
rank: 2, step 135, Loss: 1.198778748512268



Graident accumulation at epoch 0, step 135, batch 135Graident accumulation at epoch 0, step 135, batch 135

Graident accumulation at epoch 0, step 135, batch 135
Graident accumulation at epoch 0, step 135, batch 135

rank 3 | epoch 0 | step 136 | batch 136
rank 2 | epoch 0 | step 136 | batch 136



Running epoch 0, step 136, batch 136

Running epoch 0, step 136, batch 136


rank 1 | epoch 0 | step 136 | batch 136


Running epoch 0, step 136, batch 136

rank 0 | epoch 0 | step 136 | batch 136
Sampled inputs[:2]: tensor([[    0,  7963,    17,  ...,    50,    13,    18],
        [    0,    13,  4467,  ...,  2390, 47857,   287]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  221,  334,  ...,  706, 2680,  365],
        [   0,   29,  413,  ..., 2001, 1027,  292]], device='cuda:3')



Running epoch 0, step 136, batch 136
Sampled inputs[:2]: tensor([[   0,  300, 5631,  ..., 2278, 2669, 3011],
        [   0,  475, 2985,  ...,  292, 5273,    9]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  266,  298,  ...,  654,  271, 4483],
        [   0, 1607,   12,  ...,  895, 1503,  369]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 136, Loss: 1.1680402755737305
rank: 2, step 136, Loss: 1.206430435180664
rank: 1, step 136, Loss: 1.2006001472473145
rank: 0, step 136, Loss: 1.1971638202667236




rank 2 | epoch 0 | step 137 | batch 137
rank 3 | epoch 0 | step 137 | batch 137



Running epoch 0, step 137, batch 137

Running epoch 0, step 137, batch 137


rank 1 | epoch 0 | step 137 | batch 137

rank 0 | epoch 0 | step 137 | batch 137

Running epoch 0, step 137, batch 137



Running epoch 0, step 137, batch 137
Sampled inputs[:2]: tensor([[    0,    19, 18798,  ...,    13, 17982,    20],
        [    0, 17561,    12,  ...,   741,   496,    14]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1713,  292,  ...,  596,  328, 1644],
        [   0,  360,  259,  ...,   14,  381, 1371]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  2346, 17886,  ...,   287,  6769,   806],
        [    0,   287,   266,  ...,   998,   342, 17709]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    18,    14,  ...,   446,   747,  1193],
        [    0,  4653, 21419,  ...,  7845,   300,   565]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 137, Loss: 1.2092320919036865
rank: 1, step 137, Loss: 1.2039767503738403
rank: 2, step 137, Loss: 1.1984413862228394

rank: 0, step 137, Loss: 1.1971811056137085



rank 2 | epoch 0 | step 138 | batch 138
rank 3 | epoch 0 | step 138 | batch 138



Running epoch 0, step 138, batch 138

Running epoch 0, step 138, batch 138


rank 0 | epoch 0 | step 138 | batch 138
rank 1 | epoch 0 | step 138 | batch 138


Running epoch 0, step 138, batch 138



Running epoch 0, step 138, batch 138
Sampled inputs[:2]: tensor([[    0, 16847,  2027,  ...,     5,  1460,   496],
        [    0,  2715,  1478,  ...,  1171,  4697, 41847]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  587,  292,  ...,   12,  287, 2261],
        [   0,  278,  266,  ...,   12,  850, 4952]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1336, 10446,  ...,   409,   275, 12528],
        [    0,  2652,   271,  ...,   634,  1921,   266]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   391,  4356,  ...,   287, 32873,  5362],
        [    0, 38460,     9,  ...,   829,   870,    12]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 138, Loss: 1.1618390083312988
rank: 1, step 138, Loss: 1.2006934881210327
rank: 2, step 138, Loss: 1.189385175704956
rank: 0, step 138, Loss: 1.20621919631958




rank 0 | epoch 0 | step 139 | batch 139
rank 2 | epoch 0 | step 139 | batch 139

rank 3 | epoch 0 | step 139 | batch 139


Running epoch 0, step 139, batch 139

Running epoch 0, step 139, batch 139



rank 1 | epoch 0 | step 139 | batch 139


Running epoch 0, step 139, batch 139

Running epoch 0, step 139, batch 139

Sampled inputs[:2]: tensor([[   0,  344, 8133,  ...,  278, 1603,  674],
        [   0,  879,   27,  ...,   13, 2764, 3860]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  2734,  2703,  ...,  7851,   280,  1713],
        [    0,     9, 25368,  ...,   271,   266,  1136]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0, 10676,   328,  ...,     9,   360,  2583],
        [    0,   266,  4411,  ...,   368,  6388,  3484]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,  767, 1811,  ..., 1441, 1428,  278],
        [   0,  741,  300,  ...,   83, 7111,  292]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 139, Loss: 1.1969051361083984
rank: 1, step 139, Loss: 1.1999889612197876
rank: 2, step 139, Loss: 1.1975252628326416
rank: 0, step 139, Loss: 1.1833105087280273




rank 2 | epoch 0 | step 140 | batch 140
rank 3 | epoch 0 | step 140 | batch 140



Running epoch 0, step 140, batch 140

Running epoch 0, step 140, batch 140


rank 1 | epoch 0 | step 140 | batch 140


Running epoch 0, step 140, batch 140

rank 0 | epoch 0 | step 140 | batch 140
Sampled inputs[:2]: tensor([[   0, 4834,  278,  ...,   13, 8382,  669],
        [   0,   17, 4110,  ...,  287, 7115,  367]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  1978, 20360,  ...,   898,   699, 10262],
        [    0,   368,   266,  ...,   591,   767,   824]], device='cuda:2')



Running epoch 0, step 140, batch 140
Sampled inputs[:2]: tensor([[    0,   199,  2834,  ...,  3988,  1049,   935],
        [    0, 13706,  1862,  ...,   275,  1036, 42948]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 9818,  347,  ...,  413, 7359,   15],
        [   0,  299,  292,  ...,  266, 2474,  360]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 140, Loss: 1.2018091678619385
rank: 2, step 140, Loss: 1.2027493715286255
rank: 1, step 140, Loss: 1.1935951709747314
rank: 0, step 140, Loss: 1.197756052017212




rank 0 | epoch 0 | step 141 | batch 141
rank 3 | epoch 0 | step 141 | batch 141
rank 2 | epoch 0 | step 141 | batch 141




Running epoch 0, step 141, batch 141

Running epoch 0, step 141, batch 141



Running epoch 0, step 141, batch 141
rank 1 | epoch 0 | step 141 | batch 141



Running epoch 0, step 141, batch 141
Sampled inputs[:2]: tensor([[    0,   494,   360,  ...,   391, 24104, 35211],
        [    0,    12,   630,  ...,  5049,    14,  2371]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   369,  4492,  ...,  9415,  4365,   352],
        [    0,    12,   696,  ..., 14275,  2661,  6129]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   360,  5323,  ..., 29974,    25,    27],
        [    0,   271,   266,  ...,  5933,    35,  5621]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,   12, 1250,  ...,  381, 1524, 2204],
        [   0, 2356,  292,  ...,   12,  287,  300]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 141, Loss: 1.2177127599716187
rank: 3, step 141, Loss: 1.1976548433303833
rank: 0, step 141, Loss: 1.196648359298706
rank: 2, step 141, Loss: 1.1910823583602905




rank 2 | epoch 0 | step 142 | batch 142
rank 3 | epoch 0 | step 142 | batch 142



Running epoch 0, step 142, batch 142

Running epoch 0, step 142, batch 142


rank 1 | epoch 0 | step 142 | batch 142

rank 0 | epoch 0 | step 142 | batch 142

Running epoch 0, step 142, batch 142



Running epoch 0, step 142, batch 142
Sampled inputs[:2]: tensor([[    0,   328,   471,  ..., 11137,   679,  6585],
        [    0,   475,   266,  ...,   843,   287,  1119]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   271,   957,  ...,  1597,  1276,   292],
        [    0,   607,  2697,  ...,   391, 14410, 14997]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,   12,  287,  ...,  696,  700,  328],
        [   0,  396,  298,  ...,   52, 5065,   13]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   733,   560,  ...,  1172, 22808,   271],
        [    0,   995,    13,  ...,  2192,  2534,   287]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 142, Loss: 1.2128605842590332
rank: 1, step 142, Loss: 1.1941072940826416
rank: 2, step 142, Loss: 1.2121385335922241
rank: 0, step 142, Loss: 1.2088135480880737




rank 2 | epoch 0 | step 143 | batch 143
rank 3 | epoch 0 | step 143 | batch 143



Running epoch 0, step 143, batch 143

Running epoch 0, step 143, batch 143


rank 0 | epoch 0 | step 143 | batch 143
rank 1 | epoch 0 | step 143 | batch 143



Running epoch 0, step 143, batch 143


Running epoch 0, step 143, batch 143
Sampled inputs[:2]: tensor([[    0,  3134,   278,  ...,  2462,   300, 11015],
        [    0,  1871,   518,  ...,   271,   259,  1110]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  2088,  1745,  ...,   293, 16489,    12],
        [    0,   285,   590,  ...,   199,   395,  3523]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   925,   271,  ...,   391,   721,  1576],
        [    0,   591, 18622,  ...,   955,  6118,  9191]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  4845,  1521,  ...,   963,   292,  6414],
        [    0,    13, 26011,  ...,   342,  3873,   720]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 143, Loss: 1.1954015493392944
rank: 1, step 143, Loss: 1.1918368339538574
rank: 2, step 143, Loss: 1.204222321510315
rank: 0, step 143, Loss: 1.1730748414993286



Graident accumulation at epoch 0, step 143, batch 143Graident accumulation at epoch 0, step 143, batch 143

Graident accumulation at epoch 0, step 143, batch 143
Graident accumulation at epoch 0, step 143, batch 143

rank 3 | epoch 0 | step 144 | batch 144
rank 2 | epoch 0 | step 144 | batch 144



Running epoch 0, step 144, batch 144

Running epoch 0, step 144, batch 144


rank 1 | epoch 0 | step 144 | batch 144


Running epoch 0, step 144, batch 144

rank 0 | epoch 0 | step 144 | batch 144Sampled inputs[:2]: tensor([[   0, 4014,   88,  ..., 1103,   14, 1771],
        [   0,  401, 3740,  ..., 5980,  271,  266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  6904,  6069,  ..., 17196,   471,   221],
        [    0,  1086,  5564,  ..., 29319, 32982,   344]], device='cuda:3')




Running epoch 0, step 144, batch 144Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[    0, 10206,   342,  ...,  1336,  5046,   360],
        [    0,    14,  3080,  ..., 14737,    13, 17982]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    12,   221,  ...,   292, 27729,  9837],
        [    0,   292, 44809,  ...,   642,   437,  9038]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 144, Loss: 1.1931086778640747
rank: 1, step 144, Loss: 1.2115665674209595
rank: 2, step 144, Loss: 1.1971276998519897
rank: 0, step 144, Loss: 1.2009680271148682




rank 2 | epoch 0 | step 145 | batch 145

rank 3 | epoch 0 | step 145 | batch 145


Running epoch 0, step 145, batch 145


Running epoch 0, step 145, batch 145

rank 1 | epoch 0 | step 145 | batch 145
rank 0 | epoch 0 | step 145 | batch 145


Running epoch 0, step 145, batch 145



Running epoch 0, step 145, batch 145
Sampled inputs[:2]: tensor([[    0,   266,  1144,  ..., 21458,    12, 15890],
        [    0,  1890,   278,  ...,  1400,   367,  1874]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1192, 11929,  ...,   266,  1551,  1860],
        [    0,    69, 27768,  ...,  1869,  1566,   367]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  2297,   287,  ..., 10826, 13886,   292],
        [    0,   292,    17,  ...,  5760,  1345,   578]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  275, 4452,  ...,   12, 3516, 5227],
        [   0,   13, 3105,  ...,  496,   14,  879]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 145, Loss: 1.187006950378418
rank: 3, step 145, Loss: 1.1799232959747314
rank: 2, step 145, Loss: 1.1910518407821655



rank: 0, step 145, Loss: 1.2004354000091553

rank 2 | epoch 0 | step 146 | batch 146


Running epoch 0, step 146, batch 146

rank 3 | epoch 0 | step 146 | batch 146


Running epoch 0, step 146, batch 146
rank 1 | epoch 0 | step 146 | batch 146



Running epoch 0, step 146, batch 146
Sampled inputs[:2]: tensor([[    0,   631,   516,  ..., 13374,   898,   266],
        [    0,  3703,   278,  ...,  9807,    14, 10365]], device='cuda:2')

rank 0 | epoch 0 | step 146 | batch 146Sampled inputs[:2]: tensor([[    0,   634,  1621,  ...,   688,   586,  8477],
        [    0,  2734,  2338,  ...,  3977,   970, 10537]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 20241,  1244,  ...,  6232,  1004,   300],
        [    0,  2914,   352,  ...,   897,   328,  1679]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 146, batch 146Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3377,   12,  ...,  333,  199,  769],
        [   0,  756,  401,  ..., 8385, 1004,  775]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 146, Loss: 1.2013942003250122
rank: 3, step 146, Loss: 1.214155912399292
rank: 0, step 146, Loss: 1.179168462753296
rank: 2, step 146, Loss: 1.2052420377731323




rank 2 | epoch 0 | step 147 | batch 147
rank 3 | epoch 0 | step 147 | batch 147


rank 0 | epoch 0 | step 147 | batch 147

Running epoch 0, step 147, batch 147

Running epoch 0, step 147, batch 147


rank 1 | epoch 0 | step 147 | batch 147



Running epoch 0, step 147, batch 147


Running epoch 0, step 147, batch 147
Sampled inputs[:2]: tensor([[    0, 22568,   287,  ...,    12,   471,    12],
        [    0,    61, 22315,  ..., 36901,    17,   360]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,   14,  759,  ..., 2540, 1323,   12],
        [   0, 1555,   12,  ...,  809,  287,  259]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  266, 1784,  ..., 1119, 1276,  292],
        [   0, 6411,  300,  ...,  287, 4152, 1952]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 1530,   17,  ...,  409, 1611,  895],
        [   0,  278,  266,  ...,   13, 2853,  445]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 147, Loss: 1.2019634246826172
rank: 1, step 147, Loss: 1.1886600255966187
rank: 2, step 147, Loss: 1.2018542289733887


rank: 0, step 147, Loss: 1.1990939378738403


rank 3 | epoch 0 | step 148 | batch 148
rank 2 | epoch 0 | step 148 | batch 148



Running epoch 0, step 148, batch 148

Running epoch 0, step 148, batch 148

rank 0 | epoch 0 | step 148 | batch 148

rank 1 | epoch 0 | step 148 | batch 148



Running epoch 0, step 148, batch 148


Running epoch 0, step 148, batch 148
Sampled inputs[:2]: tensor([[    0,   266, 12080,  ...,   674,   369, 10956],
        [    0,  1802,  4165,  ...,   298,   445,    28]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  6022,   644,  ..., 14834,  3554,   591],
        [    0, 21178,  1952,  ..., 14930,     9,   689]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   266,  1422,  ...,   446,  1992,   586],
        [    0,  1163,  5728,  ..., 24586,   756,    14]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3860,  694,  ..., 1027,  292,  221],
        [   0,  706, 1005,  ...,  278,  266, 5590]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 148, Loss: 1.2153596878051758
rank: 1, step 148, Loss: 1.1884894371032715
rank: 2, step 148, Loss: 1.1904418468475342

rank: 0, step 148, Loss: 1.199597716331482



rank 2 | epoch 0 | step 149 | batch 149
rank 3 | epoch 0 | step 149 | batch 149



Running epoch 0, step 149, batch 149

Running epoch 0, step 149, batch 149


rank 1 | epoch 0 | step 149 | batch 149


Running epoch 0, step 149, batch 149

rank 0 | epoch 0 | step 149 | batch 149


Running epoch 0, step 149, batch 149Sampled inputs[:2]: tensor([[   0, 1978,  352,  ..., 2276,   12,  221],
        [   0, 1276,  292,  ...,   83, 1837,   13]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    14, 38914,  ...,   266,  5690,   278],
        [    0,  5332,   391,  ...,   221,   334,  1530]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,   221,   451,  ...,   741, 25712,   950],
        [    0,    14,  1075,  ..., 22182,  5948,  8401]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    12,  5820,  ...,     5,  2122,   271],
        [    0, 17900,   554,  ...,   266,  7912,    26]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 149, Loss: 1.1926243305206299
rank: 1, step 149, Loss: 1.1854162216186523
rank: 2, step 149, Loss: 1.200270414352417
rank: 0, step 149, Loss: 1.191955804824829




rank 3 | epoch 0 | step 150 | batch 150
rank 2 | epoch 0 | step 150 | batch 150


rank 0 | epoch 0 | step 150 | batch 150

Running epoch 0, step 150, batch 150

Running epoch 0, step 150, batch 150



rank 1 | epoch 0 | step 150 | batch 150


Running epoch 0, step 150, batch 150

Running epoch 0, step 150, batch 150

Sampled inputs[:2]: tensor([[    0,   266,   554,  ..., 10679,  3790,   857],
        [    0,  2785,  1061,  ...,  1194,   692,  4339]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  3070,  9719,  ...,   600,  4207,  4293],
        [    0,  1197, 10640,  ...,  2405,   437,  5880]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  278,  490,  ...,  434,  472,  346],
        [   0,  221,  474,  ...,  266, 2025,  287]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   344,  2183,  ...,    14,   759,   596],
        [    0,   609,   271,  ...,  4684, 14107,   259]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 150, Loss: 1.1993539333343506
rank: 1, step 150, Loss: 1.204767107963562

rank: 2, step 150, Loss: 1.1946932077407837
rank: 0, step 150, Loss: 1.1934958696365356



rank 0 | epoch 0 | step 151 | batch 151
rank 3 | epoch 0 | step 151 | batch 151
rank 2 | epoch 0 | step 151 | batch 151



Running epoch 0, step 151, batch 151

Running epoch 0, step 151, batch 151




Running epoch 0, step 151, batch 151
rank 1 | epoch 0 | step 151 | batch 151


Running epoch 0, step 151, batch 151

Sampled inputs[:2]: tensor([[   0,   12,  271,  ...,   12,  298,  273],
        [   0,  278,  668,  ..., 2743,  638,  609]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 25009,   407,  ..., 13076,    13,  5226],
        [    0, 35449,   824,  ...,   278, 30449,  3659]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   278, 19142,  ...,   271,   266,   298],
        [    0,   654,   300,  ..., 21762,  3597, 11117]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 18971,   278,  ...,  1934,  1916,  2612],
        [    0,   266,   298,  ...,   266,   818,   278]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 151, Loss: 1.1789569854736328
rank: 0, step 151, Loss: 1.1978051662445068
rank: 1, step 151, Loss: 1.187392234802246
rank: 3, step 151, Loss: 1.1999313831329346



Graident accumulation at epoch 0, step 151, batch 151
Graident accumulation at epoch 0, step 151, batch 151
Graident accumulation at epoch 0, step 151, batch 151
Graident accumulation at epoch 0, step 151, batch 151

rank 2 | epoch 0 | step 152 | batch 152

rank 3 | epoch 0 | step 152 | batch 152


Running epoch 0, step 152, batch 152


Running epoch 0, step 152, batch 152

rank 1 | epoch 0 | step 152 | batch 152


Running epoch 0, step 152, batch 152

rank 0 | epoch 0 | step 152 | batch 152Sampled inputs[:2]: tensor([[    0, 16187,   565,  ...,   586,  3196,   271],
        [    0,  8588,  3937,  ...,   516,  1128,  2341]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  1049,   292,  ...,   221,   380,   341],
        [    0,   292, 23950,  ...,  9305,   287,  4401]], device='cuda:3')


Running epoch 0, step 152, batch 152Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    15, 14761,  ...,   278,  3218,   287],
        [    0, 13642, 14635,  ...,   367,  1040,  8580]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   25,    5,  ..., 3935,   14,   16],
        [   0, 7111,  409,  ..., 1908, 1260,  883]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 152, Loss: 1.1887660026550293
rank: 1, step 152, Loss: 1.1966811418533325
rank: 0, step 152, Loss: 1.2187256813049316
rank: 2, step 152, Loss: 1.184037446975708




rank 3 | epoch 0 | step 153 | batch 153
rank 0 | epoch 0 | step 153 | batch 153
rank 2 | epoch 0 | step 153 | batch 153



Running epoch 0, step 153, batch 153

Running epoch 0, step 153, batch 153



rank 1 | epoch 0 | step 153 | batch 153

Running epoch 0, step 153, batch 153


Running epoch 0, step 153, batch 153

Sampled inputs[:2]: tensor([[    0,  1481,   278,  ...,  3940,  4938,     5],
        [    0,   298, 21144,  ...,  7825, 19426,  3709]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   607, 11059,  ...,  2081,  1194,   278],
        [    0,   461,  4182,  ...,  7461,   292,  4895]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  9058,  5481,  ...,   508, 15074,   300],
        [    0,   266,  7407,  ...,   287,   365,  4371]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   607,   259,  ...,   271,   669,    12],
        [    0,   790, 43134,  ...,   446,   381,  1034]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 153, Loss: 1.199753999710083
rank: 1, step 153, Loss: 1.2177941799163818
rank: 2, step 153, Loss: 1.1939674615859985

rank: 0, step 153, Loss: 1.2026087045669556



rank 2 | epoch 0 | step 154 | batch 154
rank 3 | epoch 0 | step 154 | batch 154



Running epoch 0, step 154, batch 154

Running epoch 0, step 154, batch 154


rank 1 | epoch 0 | step 154 | batch 154


Running epoch 0, step 154, batch 154

rank 0 | epoch 0 | step 154 | batch 154


Running epoch 0, step 154, batch 154
Sampled inputs[:2]: tensor([[    0,   271,  4728,  ...,   344,   259,  1774],
        [    0, 14349,   278,  ...,   365,   847,   300]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1234,   278,  ...,  1237,  1008,   417],
        [    0,   409, 22809,  ...,   342,   720,    14]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   287,   516,  ...,  2386,  3492,  1663],
        [    0,   391,  1866,  ...,  3711, 21119, 29613]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   935, 28368,  ...,   342,   259,  4600],
        [    0,    12,   287,  ...,    15, 35654,     9]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 154, Loss: 1.206943392753601
rank: 2, step 154, Loss: 1.1746472120285034
rank: 1, step 154, Loss: 1.199622631072998
rank: 0, step 154, Loss: 1.189313292503357




rank 0 | epoch 0 | step 155 | batch 155
rank 3 | epoch 0 | step 155 | batch 155

rank 2 | epoch 0 | step 155 | batch 155


Running epoch 0, step 155, batch 155

Running epoch 0, step 155, batch 155




Running epoch 0, step 155, batch 155
rank 1 | epoch 0 | step 155 | batch 155



Running epoch 0, step 155, batch 155
Sampled inputs[:2]: tensor([[    0,  9430,   287,  ...,  1141,  2280,   408],
        [    0, 10288,   300,  ...,  5365,    12,  3539]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 4294,  278,  ...,   13, 2759, 5160],
        [   0, 3141,  311,  ...,  328, 7818,  408]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  328,  490,  ..., 6280, 4283, 4582],
        [   0, 3804,  300,  ..., 5062, 9848, 3515]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0, 1445, 3597,  ...,  281,   78,    9],
        [   0, 2615,   13,  ...,  940, 3661, 6837]], device='cuda:1')



Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 155, Loss: 1.2051409482955933
rank: 1, step 155, Loss: 1.1971412897109985
rank: 2, step 155, Loss: 1.1965725421905518
rank: 0, step 155, Loss: 1.1955015659332275




rank 2 | epoch 0 | step 156 | batch 156
rank 3 | epoch 0 | step 156 | batch 156


rank 0 | epoch 0 | step 156 | batch 156

Running epoch 0, step 156, batch 156

Running epoch 0, step 156, batch 156




Running epoch 0, step 156, batch 156
rank 1 | epoch 0 | step 156 | batch 156



Running epoch 0, step 156, batch 156
Sampled inputs[:2]: tensor([[    0,   396,   221,  ...,  1279,   720,   292],
        [    0,  6693,  1235,  ..., 10814,  1810,   367]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1594,  586,  ...,   13,  701,  308],
        [   0,  275, 1911,  ..., 1371, 5151, 2813]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   935,  2613,  ...,   623,  4289,  6803],
        [    0,   292,    48,  ...,   199, 19047,   292]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,   266,  1658,  ...,   278,  1083,  5993],
        [    0,  2906, 46441,  ..., 39156,   287, 11452]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 156, Loss: 1.1958396434783936
rank: 2, step 156, Loss: 1.1740355491638184
rank: 3, step 156, Loss: 1.1885302066802979



rank: 0, step 156, Loss: 1.1982334852218628

rank 2 | epoch 0 | step 157 | batch 157


Running epoch 0, step 157, batch 157

rank 3 | epoch 0 | step 157 | batch 157


Running epoch 0, step 157, batch 157

rank 0 | epoch 0 | step 157 | batch 157
rank 1 | epoch 0 | step 157 | batch 157



Running epoch 0, step 157, batch 157


Running epoch 0, step 157, batch 157
Sampled inputs[:2]: tensor([[   0, 4213, 1921,  ..., 1340, 1049,  292],
        [   0, 5353, 5234,  ..., 1458,   14, 7157]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 3408,  300,  ..., 3868,  300, 2932],
        [   0, 4882,   12,  ...,   12, 9575,  287]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3386, 43625,  ...,    19,  2125,   271],
        [    0,    15,  2537,  ...,    14,  3544,   417]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 31539,  1156,  ...,     9,   287, 26127],
        [    0,  3084,   278,  ..., 10981,  3589,    12]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 157, Loss: 1.2073898315429688
rank: 0, step 157, Loss: 1.193434476852417
rank: 3, step 157, Loss: 1.208746314048767
rank: 2, step 157, Loss: 1.2124801874160767




rank 0 | epoch 0 | step 158 | batch 158

rank 2 | epoch 0 | step 158 | batch 158

rank 3 | epoch 0 | step 158 | batch 158


Running epoch 0, step 158, batch 158

Running epoch 0, step 158, batch 158

Running epoch 0, step 158, batch 158



rank 1 | epoch 0 | step 158 | batch 158


Running epoch 0, step 158, batch 158
Sampled inputs[:2]: tensor([[    0,   298,   452,  ..., 41263,     9,   367],
        [    0,    80, 10802,  ...,   287, 28533, 25359]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    12, 20722,  ...,   266,  1916,  5341],
        [    0, 28590,    12,  ...,   342, 29639,  1693]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  199,  677,  ..., 2792,  271, 2386],
        [   0, 3605, 2572,  ...,  300,  259, 1513]], device='cuda:0')

Sampled inputs[:2]: tensor([[    0,  1552,   300,  ...,  1085,    12,   298],
        [    0,    71,    14,  ...,  1770,   391, 39516]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 158, Loss: 1.193052887916565
rank: 1, step 158, Loss: 1.1867046356201172
rank: 2, step 158, Loss: 1.2066353559494019
rank: 0, step 158, Loss: 1.1963589191436768




rank 0 | epoch 0 | step 159 | batch 159
rank 3 | epoch 0 | step 159 | batch 159
rank 2 | epoch 0 | step 159 | batch 159



Running epoch 0, step 159, batch 159

Running epoch 0, step 159, batch 159




Running epoch 0, step 159, batch 159
rank 1 | epoch 0 | step 159 | batch 159



Running epoch 0, step 159, batch 159
Sampled inputs[:2]: tensor([[    0, 21413,  1735,  ..., 10789, 12523,    12],
        [    0,  3119,   278,  ...,   352,   674,   369]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  287, 7763,  ...,  689, 2409,  699],
        [   0,  806, 1255,  ...,  474,  221,  380]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   445,     8,  ...,    13, 25386,    17],
        [    0,   768,  3227,  ...,  3487,    13, 31431]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   278, 10875,  ...,   445,   267,    14],
        [    0,    27,   417,  ...,    18,   365,   806]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 159, Loss: 1.1982008218765259
rank: 1, step 159, Loss: 1.2056355476379395
rank: 0, step 159, Loss: 1.1967875957489014
rank: 2, step 159, Loss: 1.2025178670883179



Graident accumulation at epoch 0, step 159, batch 159
Graident accumulation at epoch 0, step 159, batch 159
Graident accumulation at epoch 0, step 159, batch 159
Graident accumulation at epoch 0, step 159, batch 159
Saving checkpoint at epoch 0, step 159, batch 159
Saving checkpoint at epoch 0, step 159, batch 159
Saving checkpoint at epoch 0, step 159, batch 159
Epoch 0 | Batch 159/262 | Training PPL: 14390.172193350225 | time 17.58755588531494
Saving checkpoint at epoch 0, step 159, batch 159
Epoch 0 | Validation PPL: 14097.891916564537 | Learning rate: 6.950300711301095e-06

rank 3 | epoch 0 | step 160 | batch 160

rank 2 | epoch 0 | step 160 | batch 160

rank 1 | epoch 0 | step 160 | batch 160


Running epoch 0, step 160, batch 160


Running epoch 0, step 160, batch 160


Running epoch 0, step 160, batch 160
Sampled inputs[:2]: tensor([[   0, 1196, 2612,  ..., 2489,   14,  333],
        [   0, 4120,  278,  ...,  298,  273,  221]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  3169, 12186,  ...,   940,   271, 13929],
        [    0,  6909,   352,  ...,  1075,   706,  6909]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  1901, 11083,  ...,   360,  6055,  2374],
        [    0,  9582,  3645,  ...,  1027,    12,   461]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Checkpoint saved to exp/gpt2_scratch_neuro_tokenizer_bayes_fwd_mini/checkpoint.0_159, AFTER epoch 0, step 159

rank 0 | epoch 0 | step 160 | batch 160


Running epoch 0, step 160, batch 160
Sampled inputs[:2]: tensor([[    0,  1477,    12,  ..., 31038,   408,   298],
        [    0,    13,  2615,  ..., 31594, 15867,  3484]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 160, Loss: 1.1944329738616943
rank: 0, step 160, Loss: 1.2003235816955566
rank: 3, step 160, Loss: 1.2023861408233643
rank: 2, step 160, Loss: 1.2027863264083862




rank 3 | epoch 0 | step 161 | batch 161
rank 2 | epoch 0 | step 161 | batch 161



Running epoch 0, step 161, batch 161

Running epoch 0, step 161, batch 161


rank 0 | epoch 0 | step 161 | batch 161
rank 1 | epoch 0 | step 161 | batch 161


Running epoch 0, step 161, batch 161



Running epoch 0, step 161, batch 161
Sampled inputs[:2]: tensor([[    0,   266,  9823,  ...,    14,  1062,  7676],
        [    0,  3761,   527,  ..., 24518,   391,   638]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  7030,   631,  ..., 34748,    12,   298],
        [    0,   631,  4013,  ...,   368, 20301,   874]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   292, 49760,  ...,   275,  4474,    13],
        [    0,   593,   300,  ...,   278,  4694,    12]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   287, 16974,  ...,   300,  2283,  4013],
        [    0,  7117,   278,  ...,   287,   266,   944]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 161, Loss: 1.179782748222351
rank: 3, step 161, Loss: 1.1676009893417358
rank: 0, step 161, Loss: 1.1960747241973877
rank: 2, step 161, Loss: 1.2108443975448608




rank 2 | epoch 0 | step 162 | batch 162
rank 3 | epoch 0 | step 162 | batch 162



Running epoch 0, step 162, batch 162

Running epoch 0, step 162, batch 162


rank 1 | epoch 0 | step 162 | batch 162


Running epoch 0, step 162, batch 162

rank 0 | epoch 0 | step 162 | batch 162
Sampled inputs[:2]: tensor([[    0,   287,  6761,  ...,  1918, 33351,    12],
        [    0,  1712,    12,  ...,  1255,  1688,   266]], device='cuda:2')


Running epoch 0, step 162, batch 162Sampled inputs[:2]: tensor([[    0,    12,   344,  ...,   824,    12,   968],
        [    0, 10251,   278,  ...,   278,   319,    13]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 1145,   13,  ...,  721, 1119, 3495],
        [   0, 3352,  259,  ..., 3565,   12,  409]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  221,  380,  ..., 5543,  768, 6375],
        [   0, 1049,   12,  ...,  292, 3963,  755]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 162, Loss: 1.2023952007293701
rank: 1, step 162, Loss: 1.1896390914916992
rank: 2, step 162, Loss: 1.2002393007278442
rank: 0, step 162, Loss: 1.1937180757522583




rank 2 | epoch 0 | step 163 | batch 163
rank 0 | epoch 0 | step 163 | batch 163

rank 3 | epoch 0 | step 163 | batch 163


Running epoch 0, step 163, batch 163

Running epoch 0, step 163, batch 163



rank 1 | epoch 0 | step 163 | batch 163


Running epoch 0, step 163, batch 163

Running epoch 0, step 163, batch 163

Sampled inputs[:2]: tensor([[    0,   221,   474,  ...,  1871,   271,   259],
        [    0,     8,    19,  ..., 13359, 12377,   938]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    52, 26766,  ...,  4411,  4226,   278],
        [    0,  1145,    35,  ...,   300,  5192,   518]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 1119,  943,  ...,  759,  920, 8874],
        [   0, 5054, 3945,  ...,  272,  278,  516]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 1125,  278,  ..., 6447,  609,   14],
        [   0, 1101,  300,  ..., 6104,  367,  993]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 163, Loss: 1.18108332157135
rank: 3, step 163, Loss: 1.2152807712554932
rank: 0, step 163, Loss: 1.1886440515518188

rank: 2, step 163, Loss: 1.2041786909103394



rank 2 | epoch 0 | step 164 | batch 164

rank 3 | epoch 0 | step 164 | batch 164


Running epoch 0, step 164, batch 164


Running epoch 0, step 164, batch 164

rank 1 | epoch 0 | step 164 | batch 164


Running epoch 0, step 164, batch 164

rank 0 | epoch 0 | step 164 | batch 164
Sampled inputs[:2]: tensor([[    0, 15033,   278,  ...,   266,  2937,    14],
        [    0,    14,   357,  ...,    30,   287,   839]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1795,   650,  ...,   516,  2793,  1109],
        [    0,  2496, 10545,  ...,   287, 13978,   408]], device='cuda:3')



Running epoch 0, step 164, batch 164
Sampled inputs[:2]: tensor([[   0,  221,  380,  ...,  631, 2820,  344],
        [   0,  365, 1462,  ...,  518, 6104,  278]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2029,   13,  ...,   12, 4536,   12],
        [   0,   12,  266,  ...,  287, 2888, 4845]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 164, Loss: 1.2062931060791016
rank: 3, step 164, Loss: 1.1860377788543701
rank: 1, step 164, Loss: 1.1975626945495605



rank: 0, step 164, Loss: 1.193524718284607

rank 2 | epoch 0 | step 165 | batch 165

rank 3 | epoch 0 | step 165 | batch 165

Running epoch 0, step 165, batch 165



Running epoch 0, step 165, batch 165

rank 1 | epoch 0 | step 165 | batch 165


Running epoch 0, step 165, batch 165

rank 0 | epoch 0 | step 165 | batch 165
Sampled inputs[:2]: tensor([[    0,  5332,   266,  ...,   300,   259, 15369],
        [    0,   381, 13565,  ...,     9,   847,   300]], device='cuda:2')


Running epoch 0, step 165, batch 165Sampled inputs[:2]: tensor([[    0,  5885,   271,  ...,   278,  1049,    12],
        [    0, 39004,   266,  ...,   287, 21972,   278]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 17694,    12,  ..., 12452,   446,   475],
        [    0,  1967,  6851,  ...,  1151,   809,   360]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   767,  4478,  ...,   278,   266, 19201],
        [    0,   474,   706,  ...,    83, 38084,   475]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 165, Loss: 1.2006131410598755
rank: 1, step 165, Loss: 1.1924142837524414
rank: 2, step 165, Loss: 1.2035753726959229
rank: 0, step 165, Loss: 1.1745820045471191




rank 2 | epoch 0 | step 166 | batch 166

rank 3 | epoch 0 | step 166 | batch 166

rank 0 | epoch 0 | step 166 | batch 166

Running epoch 0, step 166, batch 166


Running epoch 0, step 166, batch 166



Running epoch 0, step 166, batch 166
rank 1 | epoch 0 | step 166 | batch 166



Running epoch 0, step 166, batch 166
Sampled inputs[:2]: tensor([[    0,  2670, 31283,  ...,    18,  9106,  1389],
        [    0,    12,   722,  ...,   674,   369,   897]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1690, 16858,  ...,   199,   395,  3902],
        [    0,    17,  3978,  ...,  3988,   598,    12]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  5379,  6922,  ...,  1115, 43884,  2843],
        [    0,  2296,   446,  ...,  2937,   287,  2795]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,    14, 38591,  ...,   955,   892,  1635],
        [    0,    12,   297,  ...,  2980,  1145, 17207]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 166, Loss: 1.2099683284759521
rank: 3, step 166, Loss: 1.2087974548339844
rank: 0, step 166, Loss: 1.2110785245895386
rank: 2, step 166, Loss: 1.2218083143234253




rank 2 | epoch 0 | step 167 | batch 167
rank 3 | epoch 0 | step 167 | batch 167



Running epoch 0, step 167, batch 167

Running epoch 0, step 167, batch 167


rank 1 | epoch 0 | step 167 | batch 167


Running epoch 0, step 167, batch 167

rank 0 | epoch 0 | step 167 | batch 167


Running epoch 0, step 167, batch 167Sampled inputs[:2]: tensor([[   0,  772,  699,  ..., 1849,  287, 7134],
        [   0, 1167,  278,  ...,  278, 1853, 1424]], device='cuda:2')
Sampled inputs[:2]: tensor([[  0, 346,  14,  ..., 381, 535, 505],
        [  0, 894,  16,  ..., 892, 300, 722]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    27,  5375,  ...,  5357, 14933, 10944],
        [    0,  6702, 18279,  ...,    14, 47571,    12]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 1561,   14,  ..., 4433,  352, 1561],
        [   0,  259, 1329,  ...,  266,  706, 1663]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 167, Loss: 1.1811388731002808
rank: 2, step 167, Loss: 1.2143516540527344
rank: 1, step 167, Loss: 1.1930276155471802


rank: 0, step 167, Loss: 1.2002081871032715

Graident accumulation at epoch 0, step 167, batch 167Graident accumulation at epoch 0, step 167, batch 167

Graident accumulation at epoch 0, step 167, batch 167
Graident accumulation at epoch 0, step 167, batch 167

rank 2 | epoch 0 | step 168 | batch 168
rank 3 | epoch 0 | step 168 | batch 168



Running epoch 0, step 168, batch 168

Running epoch 0, step 168, batch 168


rank 1 | epoch 0 | step 168 | batch 168


Running epoch 0, step 168, batch 168
Sampled inputs[:2]: tensor([[   0, 2544,  394,  ...,   14, 1062,  516],
        [   0,  897,  328,  ...,  908,  696,  688]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  287,  955,  ...,  462, 3363, 1340],
        [   0, 1270,  413,  ...,  413,  711,   14]], device='cuda:3')


rank 0 | epoch 0 | step 168 | batch 168Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   287, 49722,  ...,  7551,   278,  5711],
        [    0,  1624,  7437,  ...,    12, 16369,  5153]], device='cuda:1')



Running epoch 0, step 168, batch 168
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 17262,   342,  ...,   472,   346,   462],
        [    0,   271, 36770,  ...,   278,  1398,  4555]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 168, Loss: 1.2051417827606201
rank: 2, step 168, Loss: 1.2061513662338257
rank: 1, step 168, Loss: 1.2006373405456543
rank: 0, step 168, Loss: 1.2121168375015259




rank 3 | epoch 0 | step 169 | batch 169
rank 2 | epoch 0 | step 169 | batch 169



Running epoch 0, step 169, batch 169

Running epoch 0, step 169, batch 169


rank 0 | epoch 0 | step 169 | batch 169
rank 1 | epoch 0 | step 169 | batch 169



Running epoch 0, step 169, batch 169


Running epoch 0, step 169, batch 169
Sampled inputs[:2]: tensor([[    0,  1415,   300,  ...,  1497,  5715,  4555],
        [    0,    15,    83,  ...,  6030,    14, 14080]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  380,  333,  ...,  333,  199, 2038],
        [   0, 1086,   14,  ...,  963,  292,  221]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    13, 36961,  ...,  6671, 13711,  4568],
        [    0,  6491,  3667,  ...,  5042,    14,  2152]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[   0,  445,   18,  ..., 1478,  578,  494],
        [   0, 9466,   36,  ..., 1795,  437,  874]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 169, Loss: 1.1776039600372314
rank: 1, step 169, Loss: 1.210779070854187
rank: 2, step 169, Loss: 1.2096563577651978
rank: 0, step 169, Loss: 1.1908141374588013




rank 3 | epoch 0 | step 170 | batch 170
rank 0 | epoch 0 | step 170 | batch 170

rank 2 | epoch 0 | step 170 | batch 170

Running epoch 0, step 170, batch 170




Running epoch 0, step 170, batch 170

rank 1 | epoch 0 | step 170 | batch 170

Running epoch 0, step 170, batch 170


Running epoch 0, step 170, batch 170

Sampled inputs[:2]: tensor([[    0,    14,  6436,  ...,   271,  1211,  8917],
        [    0, 20291,  1990,  ...,   298,   732,   298]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  6532,  6984,  ...,   271,  8212, 14409],
        [    0,    12,  9328,  ...,    20,   408,   790]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  8878,  6716,  ...,  8878,   328, 31139],
        [    0, 38816,   292,  ...,   346,   462,   221]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   292, 29800,  ...,  4144,   278,  1243],
        [    0,   376,   283,  ..., 29188,   292,  7627]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 170, Loss: 1.2231239080429077
rank: 1, step 170, Loss: 1.1993000507354736

rank: 2, step 170, Loss: 1.2124457359313965

rank: 0, step 170, Loss: 1.214030385017395


rank 3 | epoch 0 | step 171 | batch 171
rank 2 | epoch 0 | step 171 | batch 171



Running epoch 0, step 171, batch 171

Running epoch 0, step 171, batch 171


rank 1 | epoch 0 | step 171 | batch 171


Running epoch 0, step 171, batch 171

rank 0 | epoch 0 | step 171 | batch 171
Sampled inputs[:2]: tensor([[    0,   382,    17,  ...,  8733,    13,  9306],
        [    0,  2261,     9,  ..., 15008,    14,   333]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  1188,   278,  ...,   271,  8368,   292],
        [    0,   688,  2353,  ..., 20538, 10393,    12]], device='cuda:2')


Running epoch 0, step 171, batch 171

Sampled inputs[:2]: tensor([[   0,  368,  729,  ...,  221,  380, 2830],
        [   0, 1883, 1090,  ...,  365, 1943,  298]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   749,     9,  ...,  2756,    14,  1062],
        [    0, 26700,  5475,  ...,  5707,    65,    13]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 171, Loss: 1.1856958866119385
rank: 3, step 171, Loss: 1.1756477355957031
rank: 0, step 171, Loss: 1.2020801305770874

rank: 2, step 171, Loss: 1.2007391452789307



rank 0 | epoch 0 | step 172 | batch 172

rank 2 | epoch 0 | step 172 | batch 172


Running epoch 0, step 172, batch 172

Running epoch 0, step 172, batch 172

rank 1 | epoch 0 | step 172 | batch 172



Running epoch 0, step 172, batch 172

rank 3 | epoch 0 | step 172 | batch 172


Running epoch 0, step 172, batch 172
Sampled inputs[:2]: tensor([[    0, 15402, 44149,  ...,   266,  1403,   271],
        [    0,  8023,  1309,  ...,  3370,   266, 14988]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  6481,   298,  ...,  6145, 16858,   824],
        [    0,  2344,   271,  ...,  5415,    14,  1075]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   335,   446,  ...,  5795,    12, 12433],
        [    0,  3908,  4274,  ...,   298,  7998, 11109]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   352,   357,  ...,   461,   654, 19725],
        [    0,  1176, 33084,  ...,   266,  2269,  1209]], device='cuda:3')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 172, Loss: 1.2022721767425537
rank: 1, step 172, Loss: 1.1850943565368652
rank: 2, step 172, Loss: 1.1957497596740723
rank: 0, step 172, Loss: 1.1997535228729248




rank 2 | epoch 0 | step 173 | batch 173

rank 3 | epoch 0 | step 173 | batch 173


Running epoch 0, step 173, batch 173


Running epoch 0, step 173, batch 173

rank 1 | epoch 0 | step 173 | batch 173


Running epoch 0, step 173, batch 173

rank 0 | epoch 0 | step 173 | batch 173
Sampled inputs[:2]: tensor([[    0,  4485,   741,  ...,   292,   221,   341],
        [    0,  7779,    12,  ...,  1380, 10199,  1086]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 28107,    14,  ...,   864,   298,   413],
        [    0,   266,  2374,  ...,  1551,   518,   638]], device='cuda:3')



Running epoch 0, step 173, batch 173
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   266,  3382,  ...,   759,   631,   369],
        [    0,  5129,  1245,  ...,   292, 24298,    13]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   259,  5918,  ...,   508,  3433,  1351],
        [    0,   957,  1357,  ..., 26179,   287,  6458]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 173, Loss: 1.207078218460083
rank: 3, step 173, Loss: 1.1802091598510742
rank: 0, step 173, Loss: 1.1869056224822998
rank: 2, step 173, Loss: 1.201529860496521




rank 2 | epoch 0 | step 174 | batch 174
rank 3 | epoch 0 | step 174 | batch 174



Running epoch 0, step 174, batch 174

Running epoch 0, step 174, batch 174


rank 1 | epoch 0 | step 174 | batch 174


Running epoch 0, step 174, batch 174

rank 0 | epoch 0 | step 174 | batch 174


Running epoch 0, step 174, batch 174Sampled inputs[:2]: tensor([[   0,   12,  328,  ...,  578,   19,   40],
        [   0, 1268,  278,  ...,  461,  925,  630]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   475,   668,  ..., 17680,   368,  1351],
        [    0,   360,   508,  ...,   259,   554,  1319]], device='cuda:3')


Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  2738,   278,  ...,   292,    35,  2147],
        [    0,   266, 12964,  ...,   300,  3979,  4706]], device='cuda:1')


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  292,   58,  ...,  319,  221, 1061],
        [   0, 5603, 6598,  ..., 1692, 1713,  365]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 174, Loss: 1.1943604946136475
rank: 3, step 174, Loss: 1.1927534341812134
rank: 2, step 174, Loss: 1.1923985481262207
rank: 0, step 174, Loss: 1.1881753206253052




rank 2 | epoch 0 | step 175 | batch 175


Running epoch 0, step 175, batch 175

rank 1 | epoch 0 | step 175 | batch 175

rank 3 | epoch 0 | step 175 | batch 175


Running epoch 0, step 175, batch 175


Running epoch 0, step 175, batch 175

rank 0 | epoch 0 | step 175 | batch 175
Sampled inputs[:2]: tensor([[    0, 49141,    14,  ...,   342,   259,  1943],
        [    0,   221,   259,  ...,   199, 13800,  9254]], device='cuda:2')


Running epoch 0, step 175, batch 175
Sampled inputs[:2]: tensor([[    0, 18787, 27117,  ...,   287, 16139,    13],
        [    0,   287,   266,  ...,   333,   199,  3217]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1086,   292,  ...,  1400,   367,  1874],
        [    0,  3611, 10765,  ...,   271,  4317,    13]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    12, 17906,  ...,  2086,   287,  4419],
        [    0,    21,   292,  ...,    13,  1861,  4254]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 175, Loss: 1.1878522634506226
rank: 1, step 175, Loss: 1.1840803623199463
rank: 2, step 175, Loss: 1.2100411653518677


Graident accumulation at epoch 0, step 175, batch 175
rank: 0, step 175, Loss: 1.177178978919983
Graident accumulation at epoch 0, step 175, batch 175

Graident accumulation at epoch 0, step 175, batch 175
Graident accumulation at epoch 0, step 175, batch 175

rank 2 | epoch 0 | step 176 | batch 176


Running epoch 0, step 176, batch 176

rank 3 | epoch 0 | step 176 | batch 176


Running epoch 0, step 176, batch 176

rank 1 | epoch 0 | step 176 | batch 176


Running epoch 0, step 176, batch 176

rank 0 | epoch 0 | step 176 | batch 176Sampled inputs[:2]: tensor([[    0,   396,  1821,  ...,  5984, 18362,   278],
        [    0,   271,   259,  ...,  1345,   352,   365]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  2280,   344,  ...,   287,   266,  3344],
        [    0, 18197,  1340,  ...,   360,   266,  1110]], device='cuda:3')


Running epoch 0, step 176, batch 176
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3406,  300,  ..., 1726, 3521, 4481],
        [   0, 1682,  271,  ...,  367, 3210,  271]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  461,  654,  ..., 4145, 7600, 4142],
        [   0,   14,  333,  ...,  328, 5453, 4713]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 176, Loss: 1.1808924674987793
rank: 0, step 176, Loss: 1.212327003479004
rank: 3, step 176, Loss: 1.2063179016113281
rank: 1, step 176, Loss: 1.1916894912719727




rank 3 | epoch 0 | step 177 | batch 177
rank 2 | epoch 0 | step 177 | batch 177
rank 0 | epoch 0 | step 177 | batch 177



Running epoch 0, step 177, batch 177

Running epoch 0, step 177, batch 177



rank 1 | epoch 0 | step 177 | batch 177


Running epoch 0, step 177, batch 177


Running epoch 0, step 177, batch 177
Sampled inputs[:2]: tensor([[    0,  7935,  6521,  ..., 41312,   365,   806],
        [    0,  1927,   863,  ...,  1163,    13,  1888]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  5116,  4330,  ...,   925,   699,  1351],
        [    0,  3047,  4878,  ...,   352, 10854, 34025]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  992,  409,  ..., 5843,  344,  259],
        [   0, 4359, 5768,  ..., 4402,  292,   69]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 2348,  565,  ...,   12,  709,  266],
        [   0,  377,  472,  ..., 9256, 3807, 5499]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 177, Loss: 1.1781326532363892
rank: 1, step 177, Loss: 1.1810414791107178
rank: 2, step 177, Loss: 1.1795732975006104
rank: 0, step 177, Loss: 1.198142170906067




rank 2 | epoch 0 | step 178 | batch 178
rank 3 | epoch 0 | step 178 | batch 178



Running epoch 0, step 178, batch 178

Running epoch 0, step 178, batch 178


rank 1 | epoch 0 | step 178 | batch 178


Running epoch 0, step 178, batch 178

rank 0 | epoch 0 | step 178 | batch 178


Running epoch 0, step 178, batch 178Sampled inputs[:2]: tensor([[   0,  437,  638,  ..., 4514,   14,  333],
        [   0,  300,  344,  ...,   14, 5077, 2715]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   12,  287,  ...,  658,  221,  474],
        [   0,  287,  552,  ..., 7407, 2401,  287]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1070, 17816,  ...,  5547,  9966,   518],
        [    0,  2440,  1458,  ...,  7650,   328,  2297]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   650,    14,  ...,  6330,   221,   494],
        [    0, 14296,   292,  ...,    18,   271, 16158]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 178, Loss: 1.18648099899292
rank: 1, step 178, Loss: 1.2063050270080566
rank: 0, step 178, Loss: 1.195026159286499
rank: 3, step 178, Loss: 1.200088381767273




rank 2 | epoch 0 | step 179 | batch 179
rank 3 | epoch 0 | step 179 | batch 179



Running epoch 0, step 179, batch 179

Running epoch 0, step 179, batch 179


rank 1 | epoch 0 | step 179 | batch 179


Running epoch 0, step 179, batch 179

rank 0 | epoch 0 | step 179 | batch 179


Running epoch 0, step 179, batch 179Sampled inputs[:2]: tensor([[    0,  6416,   367,  ...,   496,    14,    20],
        [    0,  4988, 36842,  ...,  7630, 18362,    13]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   824,   278,  ...,   266, 10997,   863],
        [    0,   741,   266,  ...,   271,  5166,   596]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1869,   596,  ..., 13055, 17051,   578],
        [    0, 12923,  2489,  ...,   474,  3301,    54]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13, 41550,  ...,    12,   546,  1996],
        [    0,   292, 16983,  ...,   221,   474,  4800]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 179, Loss: 1.1984577178955078
rank: 1, step 179, Loss: 1.1799581050872803
rank: 0, step 179, Loss: 1.1905090808868408
rank: 2, step 179, Loss: 1.231197714805603




rank 2 | epoch 0 | step 180 | batch 180
rank 3 | epoch 0 | step 180 | batch 180



Running epoch 0, step 180, batch 180

Running epoch 0, step 180, batch 180


rank 1 | epoch 0 | step 180 | batch 180


Running epoch 0, step 180, batch 180

rank 0 | epoch 0 | step 180 | batch 180
Sampled inputs[:2]: tensor([[   0,  278, 6318,  ...,  458,   17,    9],
        [   0,   12,  895,  ...,   13, 2900,   14]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1083,  287,  ...,   12,  287, 2098],
        [   0,   12, 1631,  ..., 1143,  271,  266]], device='cuda:3')


Running epoch 0, step 180, batch 180
Sampled inputs[:2]: tensor([[    0,  1236,  6446,  ...,   300,   706,  3698],
        [    0,  6192,   266,  ...,  3318,  9872, 10931]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   266,  1403,  ...,  5145,   266,  3470],
        [    0, 19350,   271,  ...,   445,  1841,   446]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 180, Loss: 1.2011816501617432
rank: 3, step 180, Loss: 1.1796232461929321
rank: 0, step 180, Loss: 1.191861867904663
rank: 2, step 180, Loss: 1.190456509590149




rank 3 | epoch 0 | step 181 | batch 181
rank 2 | epoch 0 | step 181 | batch 181



Running epoch 0, step 181, batch 181

Running epoch 0, step 181, batch 181


rank 1 | epoch 0 | step 181 | batch 181


Running epoch 0, step 181, batch 181

rank 0 | epoch 0 | step 181 | batch 181


Running epoch 0, step 181, batch 181Sampled inputs[:2]: tensor([[    0,   266,  6737,  ...,  2409,    12,   287],
        [    0,    14,   475,  ..., 44038,    12,   894]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 2314,  266,  ...,  342, 7299, 1099],
        [   0, 1927,  287,  ..., 1027,  271,  266]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,  2310,   292,  ...,   462,   508,   586],
        [    0, 16064, 10937,  ...,   346,   462,   221]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 32878,   593,  ...,   437,  1329,   644],
        [    0,   221,   334,  ...,  1698,    13, 24137]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 181, Loss: 1.1951124668121338
rank: 0, step 181, Loss: 1.1899845600128174
rank: 3, step 181, Loss: 1.1965630054473877

rank: 1, step 181, Loss: 1.1930476427078247



rank 2 | epoch 0 | step 182 | batch 182

rank 0 | epoch 0 | step 182 | batch 182
rank 3 | epoch 0 | step 182 | batch 182


Running epoch 0, step 182, batch 182


Running epoch 0, step 182, batch 182


rank 1 | epoch 0 | step 182 | batch 182

Running epoch 0, step 182, batch 182


Running epoch 0, step 182, batch 182

Sampled inputs[:2]: tensor([[   0,  298,  696,  ..., 3502,  287, 1047],
        [   0,  342,  721,  ..., 2429,   14,  475]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 21540,   527,  ...,   824,    14,   381],
        [    0,    12,   496,  ..., 11354,  4856,  1109]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0, 1458,  365,  ..., 5399, 1110,  870],
        [   0,  527, 2811,  ...,  287, 1288,  352]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   342,   266,  ...,   586,  1944,   271],
        [    0,  1234,   408,  ...,   292, 17323,   221]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 182, Loss: 1.171056866645813
rank: 3, step 182, Loss: 1.1988321542739868

rank: 2, step 182, Loss: 1.1805025339126587


rank: 0, step 182, Loss: 1.1980457305908203

rank 3 | epoch 0 | step 183 | batch 183


Running epoch 0, step 183, batch 183

rank 1 | epoch 0 | step 183 | batch 183


Running epoch 0, step 183, batch 183
Sampled inputs[:2]: tensor([[    0,  4304,  7406,  ...,   957,  7366,   328],
        [    0,   344,   259,  ..., 47553,   287, 28978]], device='cuda:3')
rank 0 | epoch 0 | step 183 | batch 183

Sampled inputs[:2]: tensor([[    0,  3036,   471,  ...,   287,  1906,    12],
        [    0,   850,    13,  ..., 11823,    13, 30706]], device='cuda:1')


Running epoch 0, step 183, batch 183Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 2 | epoch 0 | step 183 | batch 183


Running epoch 0, step 183, batch 183
Sampled inputs[:2]: tensor([[   0, 1690, 2558,  ..., 2025,   12,  266],
        [   0,  266, 1634,  ...,  310, 1372,  287]], device='cuda:0')
Sampled inputs[:2]: tensor([[   0,  380, 1075,  ...,  298,  365, 4920],
        [   0,   13, 1529,  ..., 8197, 2700, 9629]], device='cuda:2')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 183, Loss: 1.1918416023254395
rank: 2, step 183, Loss: 1.184457778930664
rank: 1, step 183, Loss: 1.1917576789855957
rank: 0, step 183, Loss: 1.2082939147949219



Graident accumulation at epoch 0, step 183, batch 183Graident accumulation at epoch 0, step 183, batch 183

Graident accumulation at epoch 0, step 183, batch 183
Graident accumulation at epoch 0, step 183, batch 183

rank 3 | epoch 0 | step 184 | batch 184


Running epoch 0, step 184, batch 184

rank 0 | epoch 0 | step 184 | batch 184
rank 1 | epoch 0 | step 184 | batch 184



Running epoch 0, step 184, batch 184
rank 2 | epoch 0 | step 184 | batch 184



Running epoch 0, step 184, batch 184

Running epoch 0, step 184, batch 184

Sampled inputs[:2]: tensor([[   0, 3388,  278,  ..., 7203,  271, 1746],
        [   0,  259, 3022,  ...,  437, 5100, 1782]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13,  1107,  ...,   287, 25185,    14],
        [    0,  1497, 16170,  ...,  1888,  2350,   578]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,   565,  5539,  ...,    12,   516, 14426],
        [    0,   278,  5210,  ...,  1968,  2002,   923]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 3058,  292,  ..., 1387, 1236,  369],
        [   0,  221,  474,  ...,  287,  271, 2540]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 184, Loss: 1.2019870281219482
rank: 1, step 184, Loss: 1.2016019821166992
rank: 2, step 184, Loss: 1.2002187967300415
rank: 0, step 184, Loss: 1.201773762702942




rank 0 | epoch 0 | step 185 | batch 185
rank 3 | epoch 0 | step 185 | batch 185
rank 2 | epoch 0 | step 185 | batch 185




Running epoch 0, step 185, batch 185

Running epoch 0, step 185, batch 185


rank 1 | epoch 0 | step 185 | batch 185

Running epoch 0, step 185, batch 185


Running epoch 0, step 185, batch 185

Sampled inputs[:2]: tensor([[   0,   14,   69,  ...,  287,  259, 5158],
        [   0,  768, 2351,  ..., 3768,  401, 2463]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1867,   300,  ...,   259,  3095,  1842],
        [    0,  1265,  1545,  ...,   292, 36667, 36197]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 1932,  278,  ...,  609,  271,  266],
        [   0, 4823,   12,  ..., 1756, 3406,  300]], device='cuda:0')Sampled inputs[:2]: tensor([[   0, 1042, 2548,  ...,  328,  259, 2771],
        [   0, 2302,  287,  ..., 1522, 1666,  300]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 185, Loss: 1.1945472955703735
rank: 3, step 185, Loss: 1.2121615409851074
rank: 0, step 185, Loss: 1.2051702737808228
rank: 2, step 185, Loss: 1.1876331567764282




rank 2 | epoch 0 | step 186 | batch 186

rank 3 | epoch 0 | step 186 | batch 186


Running epoch 0, step 186, batch 186


Running epoch 0, step 186, batch 186

rank 1 | epoch 0 | step 186 | batch 186


Running epoch 0, step 186, batch 186

rank 0 | epoch 0 | step 186 | batch 186
Sampled inputs[:2]: tensor([[    0, 13595,  3803,  ...,  1992,  4770,   818],
        [    0,    14,   747,  ...,   259,  6027,  1889]], device='cuda:2')


Running epoch 0, step 186, batch 186Sampled inputs[:2]: tensor([[    0,  9010,    17,  ...,  3813,  1147,   199],
        [    0,  1188,    12,  ...,   292, 23032,   689]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  756,  401,  ...,  271, 7272, 1663],
        [   0,  472,  346,  ...,  266,  720,  342]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1410,   271,  ...,   259, 27726,  9533],
        [    0,  2663,   328,  ...,   292,    86,    16]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 186, Loss: 1.2200603485107422
rank: 1, step 186, Loss: 1.1957616806030273
rank: 2, step 186, Loss: 1.1941808462142944



rank: 0, step 186, Loss: 1.1775885820388794

rank 2 | epoch 0 | step 187 | batch 187
rank 3 | epoch 0 | step 187 | batch 187



Running epoch 0, step 187, batch 187


Running epoch 0, step 187, batch 187

rank 1 | epoch 0 | step 187 | batch 187


Running epoch 0, step 187, batch 187

rank 0 | epoch 0 | step 187 | batch 187Sampled inputs[:2]: tensor([[   0, 3152, 1385,  ..., 1403,  518, 2088],
        [   0,  898, 1427,  ...,  508, 1860,  266]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  365, 5911,  ...,  925,  408,  266],
        [   0,  422,   14,  ...,  271, 1360,   12]], device='cuda:3')




Running epoch 0, step 187, batch 187Sampled inputs[:2]: tensor([[   0,  287, 6932,  ..., 1549, 1480,  518],
        [   0,  328, 6875,  ...,  369,  654,  300]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    33,    12,  ...,  1110,   467, 17467],
        [    0, 13751,    12,  ...,  1264,  5676,   367]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 187, Loss: 1.1912459135055542
rank: 1, step 187, Loss: 1.1921418905258179
rank: 0, step 187, Loss: 1.1842180490493774
rank: 2, step 187, Loss: 1.2059098482131958




rank 2 | epoch 0 | step 188 | batch 188
rank 3 | epoch 0 | step 188 | batch 188



Running epoch 0, step 188, batch 188

Running epoch 0, step 188, batch 188


rank 1 | epoch 0 | step 188 | batch 188


Running epoch 0, step 188, batch 188

rank 0 | epoch 0 | step 188 | batch 188


Running epoch 0, step 188, batch 188Sampled inputs[:2]: tensor([[   0,  298, 2587,  ...,  298,  894,  496],
        [   0,  221, 6872,  ...,  806,  518,  266]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 3484,  437,  ...,  298,  995, 4009],
        [   0, 7110,  278,  ...,   66,   13, 9070]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  199,  769,  ...,  685, 1423,   13],
        [   0,  287,  221,  ..., 1871, 1482,   12]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  6803,  6298,  ...,   490,  1781,    12],
        [    0,   474,   221,  ...,   287, 20640,   292]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 188, Loss: 1.1836518049240112
rank: 1, step 188, Loss: 1.1946176290512085
rank: 2, step 188, Loss: 1.1716156005859375
rank: 0, step 188, Loss: 1.1820969581604004




rank 2 | epoch 0 | step 189 | batch 189

rank 3 | epoch 0 | step 189 | batch 189


Running epoch 0, step 189, batch 189


Running epoch 0, step 189, batch 189

rank 1 | epoch 0 | step 189 | batch 189


Running epoch 0, step 189, batch 189

rank 0 | epoch 0 | step 189 | batch 189


Running epoch 0, step 189, batch 189Sampled inputs[:2]: tensor([[   0, 1742,   14,  ..., 1684,   13, 1107],
        [   0, 6203,  352,  ...,  266, 3437,  287]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  287,  298,  ...,   14, 1147,  199],
        [   0, 1486,  292,  ..., 7484,   15, 5357]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 18837,   394,  ...,   271,  1398,  1871],
        [    0,  1527, 21622,  ..., 14406,    13,  6182]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2388, 6604,  ..., 5005, 1196,  717],
        [   0,  361, 1224,  ..., 4401, 4261, 1663]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 189, Loss: 1.1640503406524658
rank: 1, step 189, Loss: 1.1811902523040771
rank: 2, step 189, Loss: 1.1873836517333984
rank: 0, step 189, Loss: 1.2026557922363281




rank 3 | epoch 0 | step 190 | batch 190

rank 2 | epoch 0 | step 190 | batch 190


Running epoch 0, step 190, batch 190


Running epoch 0, step 190, batch 190

rank 1 | epoch 0 | step 190 | batch 190


Running epoch 0, step 190, batch 190

rank 0 | epoch 0 | step 190 | batch 190
Sampled inputs[:2]: tensor([[    0,   367,  6267,  ...,     9,   287, 17056],
        [    0,  2159,   271,  ...,  1268,   344,   259]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1549,  824,  ..., 3609,  720,  417],
        [   0,   14,  298,  ...,  333,  199,  769]], device='cuda:3')


Running epoch 0, step 190, batch 190
Sampled inputs[:2]: tensor([[   0,   12,  287,  ..., 3359, 1751, 5048],
        [   0, 4441, 1821,  ...,  642, 2310,   14]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2440,  709,  ..., 4505, 1549, 4111],
        [   0, 2518,  437,  ...,   12, 1041,  283]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 190, Loss: 1.1785067319869995
rank: 1, step 190, Loss: 1.1685525178909302
rank: 2, step 190, Loss: 1.2025150060653687
rank: 0, step 190, Loss: 1.1852668523788452




rank 2 | epoch 0 | step 191 | batch 191

rank 3 | epoch 0 | step 191 | batch 191


Running epoch 0, step 191, batch 191


Running epoch 0, step 191, batch 191

rank 1 | epoch 0 | step 191 | batch 191


Running epoch 0, step 191, batch 191

rank 0 | epoch 0 | step 191 | batch 191
Sampled inputs[:2]: tensor([[   0, 2771,   13,  ..., 4169,  278,  266],
        [   0, 1529, 5227,  ..., 1480,  367,  925]], device='cuda:2')

Running epoch 0, step 191, batch 191
Sampled inputs[:2]: tensor([[    0, 21410, 13160,  ...,   292,    69,    14],
        [    0,  3984, 13077,  ...,   287,   650,   413]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 7094,  596,  ..., 4764, 9514,   14],
        [   0,   13, 1320,  ..., 8686, 6851,   13]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    12,   266,  ...,  5308,   266, 14679],
        [    0,   271,   266,  ..., 23648,   292, 21424]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 191, Loss: 1.207734227180481
rank: 2, step 191, Loss: 1.2091115713119507
rank: 1, step 191, Loss: 1.1900006532669067
rank: 0, step 191, Loss: 1.1932231187820435



Graident accumulation at epoch 0, step 191, batch 191Graident accumulation at epoch 0, step 191, batch 191

Graident accumulation at epoch 0, step 191, batch 191
Graident accumulation at epoch 0, step 191, batch 191

rank 2 | epoch 0 | step 192 | batch 192

rank 3 | epoch 0 | step 192 | batch 192


Running epoch 0, step 192, batch 192


Running epoch 0, step 192, batch 192

rank 1 | epoch 0 | step 192 | batch 192


Running epoch 0, step 192, batch 192

rank 0 | epoch 0 | step 192 | batch 192


Running epoch 0, step 192, batch 192
Sampled inputs[:2]: tensor([[    0,  2286,    29,  ...,   518,  1307, 16881],
        [    0,  9058,  4048,  ...,    14,   759,  1403]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  2027,   365,  ...,   368,  1782,   394],
        [    0,   298, 39056,  ...,   221,  1061,  2165]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   287,  4599,  ..., 11812,   266,  1036],
        [    0,   271,  3616,  ...,    12,  1348,  5037]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 25939, 47777,  ...,    13,  3483,   278],
        [    0,  1231,   352,  ...,  8524,    14,   381]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 192, Loss: 1.2056955099105835
rank: 3, step 192, Loss: 1.1796643733978271
rank: 0, step 192, Loss: 1.1788444519042969
rank: 2, step 192, Loss: 1.1918411254882812




rank 2 | epoch 0 | step 193 | batch 193
rank 3 | epoch 0 | step 193 | batch 193


rank 0 | epoch 0 | step 193 | batch 193

Running epoch 0, step 193, batch 193

Running epoch 0, step 193, batch 193


rank 1 | epoch 0 | step 193 | batch 193



Running epoch 0, step 193, batch 193


Running epoch 0, step 193, batch 193
Sampled inputs[:2]: tensor([[    0, 11752,   280,  ..., 14814,  1128,   360],
        [    0,   266,  3727,  ...,  1143,   271,  5213]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   266,  1234,  ...,   908,   328, 26300],
        [    0,   313,    66,  ...,   894,  2973, 25074]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0, 42329,   472,  ...,   292,    33,  3092],
        [    0,  3468,   278,  ...,  2442,   292,   380]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0, 2827, 5744,  ...,  365,  513,   13],
        [   0,  278, 4191,  ...,  381, 3020,  352]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 193, Loss: 1.2057331800460815
rank: 1, step 193, Loss: 1.2120145559310913
rank: 0, step 193, Loss: 1.2006878852844238
rank: 2, step 193, Loss: 1.1970603466033936




rank 2 | epoch 0 | step 194 | batch 194
rank 3 | epoch 0 | step 194 | batch 194


rank 1 | epoch 0 | step 194 | batch 194


Running epoch 0, step 194, batch 194

Running epoch 0, step 194, batch 194



Running epoch 0, step 194, batch 194

rank 0 | epoch 0 | step 194 | batch 194


Running epoch 0, step 194, batch 194
Sampled inputs[:2]: tensor([[    0,   278,  7914,  ...,  1194,   300,  4419],
        [    0,   292, 15156,  ...,    35,  3815,  1422]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   221, 18844,  ...,   199, 10174,   259],
        [    0,   685,  3482,  ..., 23113,    12,  6481]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  908,   14,  ...,   19,   27,  287],
        [   0, 5998,  591,  ..., 3126,   12,  358]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  320, 4886,  ...,   14,  333,  199],
        [   0,  694,  266,  ..., 3007,  300, 5726]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 194, Loss: 1.1957799196243286
rank: 1, step 194, Loss: 1.2006685733795166

rank: 0, step 194, Loss: 1.1941813230514526

rank: 2, step 194, Loss: 1.192169427871704


rank 3 | epoch 0 | step 195 | batch 195


Running epoch 0, step 195, batch 195

rank 1 | epoch 0 | step 195 | batch 195


Running epoch 0, step 195, batch 195

rank 2 | epoch 0 | step 195 | batch 195

rank 0 | epoch 0 | step 195 | batch 195

Running epoch 0, step 195, batch 195



Running epoch 0, step 195, batch 195Sampled inputs[:2]: tensor([[   0,  474,  221,  ..., 2945,    9,  287],
        [   0,  292,  263,  ...,  342, 4575,  271]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   221,   334,  ...,  1422, 30163,   578],
        [    0,   527,   496,  ...,    12,   795,  8296]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 7230,   13,  ..., 1400,  367, 1874],
        [   0,   14,  381,  ..., 7106,  287,  266]], device='cuda:2')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  1549,  7052,  ...,  2529,  3958,    37],
        [    0, 43071,   278,  ...,   266, 21576,  5936]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 195, Loss: 1.2070097923278809
rank: 2, step 195, Loss: 1.1935354471206665
rank: 1, step 195, Loss: 1.1979118585586548
rank: 0, step 195, Loss: 1.2111539840698242




rank 2 | epoch 0 | step 196 | batch 196
rank 0 | epoch 0 | step 196 | batch 196

rank 3 | epoch 0 | step 196 | batch 196


Running epoch 0, step 196, batch 196


Running epoch 0, step 196, batch 196


rank 1 | epoch 0 | step 196 | batch 196


Running epoch 0, step 196, batch 196

Running epoch 0, step 196, batch 196

Sampled inputs[:2]: tensor([[    0, 13555,    14,  ...,  1067,   271,   266],
        [    0,   287,  1477,  ...,   997,   292,  4471]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  342,  726,  ...,   12,  895,  367],
        [   0,  275, 1620,  ..., 3020,  278,  259]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   741,  4933,  ...,   932,   365,   838],
        [    0,   437, 38603,  ..., 37253, 10432,   278]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   546,   360,  ...,  9107,  2772,  4496],
        [    0,   824,   278,  ..., 10513,  6909,  4077]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 196, Loss: 1.2037274837493896
rank: 2, step 196, Loss: 1.1991617679595947
rank: 1, step 196, Loss: 1.2002983093261719
rank: 0, step 196, Loss: 1.2082233428955078




rank 0 | epoch 0 | step 197 | batch 197
rank 2 | epoch 0 | step 197 | batch 197

rank 3 | epoch 0 | step 197 | batch 197



Running epoch 0, step 197, batch 197


Running epoch 0, step 197, batch 197


Running epoch 0, step 197, batch 197
rank 1 | epoch 0 | step 197 | batch 197



Running epoch 0, step 197, batch 197
Sampled inputs[:2]: tensor([[   0, 3261, 1518,  ..., 5019,  287, 1906],
        [   0, 1912, 3461,  ...,  446, 9337, 1345]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,    12,  2735,  ...,    12,   344,  1496],
        [    0, 27754,  3807,  ...,  3370,  3809,   360]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   292, 15087,  ...,  2675,  1663,    12],
        [    0,   265,  1781,  ...,   334,   344,   984]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  7382,  2252,  ..., 26084,   266,  5047],
        [    0,    26,   874,  ...,    12, 21591,    12]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 197, Loss: 1.1986100673675537
rank: 1, step 197, Loss: 1.2033430337905884
rank: 2, step 197, Loss: 1.2031104564666748



rank: 0, step 197, Loss: 1.1971544027328491

rank 2 | epoch 0 | step 198 | batch 198

rank 3 | epoch 0 | step 198 | batch 198


Running epoch 0, step 198, batch 198

Running epoch 0, step 198, batch 198


rank 1 | epoch 0 | step 198 | batch 198


Running epoch 0, step 198, batch 198
Sampled inputs[:2]: tensor([[    0,    12,  1790,  ..., 11026,   292,  2116],
        [    0,   278,  1041,  ...,  2098,  1837,    12]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   221,   474,  ...,    14, 10961,    12],
        [    0,   271,   266,  ...,   984,    14,   759]], device='cuda:3')


rank 0 | epoch 0 | step 198 | batch 198Sampled inputs[:2]: tensor([[    0, 49831,    12,  ...,   912,   221,   609],
        [    0,   694,  2326,  ...,   278,  1781,  9660]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]




Running epoch 0, step 198, batch 198Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   301,   298,  ...,   806,   352, 22105],
        [    0,    12,   266,  ...,   278,   266, 10995]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 198, Loss: 1.2169711589813232
rank: 0, step 198, Loss: 1.1614781618118286
rank: 3, step 198, Loss: 1.186227798461914
rank: 2, step 198, Loss: 1.1905877590179443




rank 0 | epoch 0 | step 199 | batch 199
rank 2 | epoch 0 | step 199 | batch 199

rank 3 | epoch 0 | step 199 | batch 199


Running epoch 0, step 199, batch 199



Running epoch 0, step 199, batch 199


Running epoch 0, step 199, batch 199
rank 1 | epoch 0 | step 199 | batch 199



Running epoch 0, step 199, batch 199
Sampled inputs[:2]: tensor([[    0,   292,    65,  ...,    12,   857,   344],
        [    0, 22340,   574,  ...,   494,   221,   334]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 2958,  298,  ...,   12,  709,  616],
        [   0,  287, 5724,  ...,  298,  591, 2609]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   806,   352,  ...,  3493,   352, 49256],
        [    0,  1941,   437,  ..., 16539,  4129,  4156]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  221,  374,  ..., 2296,  365, 4579],
        [   0, 3164,   12,  ...,  984,  344, 3993]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 199, Loss: 1.1950151920318604
rank: 1, step 199, Loss: 1.1914523839950562
rank: 0, step 199, Loss: 1.203224778175354
rank: 2, step 199, Loss: 1.1948989629745483



Graident accumulation at epoch 0, step 199, batch 199
Graident accumulation at epoch 0, step 199, batch 199
Graident accumulation at epoch 0, step 199, batch 199
Graident accumulation at epoch 0, step 199, batch 199

rank 3 | epoch 0 | step 200 | batch 200
rank 2 | epoch 0 | step 200 | batch 200



Running epoch 0, step 200, batch 200

Running epoch 0, step 200, batch 200


rank 1 | epoch 0 | step 200 | batch 200

rank 0 | epoch 0 | step 200 | batch 200

Running epoch 0, step 200, batch 200



Running epoch 0, step 200, batch 200
Sampled inputs[:2]: tensor([[   0, 3037, 4511,  ..., 1711,   12, 2655],
        [   0,  508,  927,  ..., 1390,  674,  369]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,  689, 3953,  ...,  461,  943,  352],
        [   0, 1360,   14,  ...,  287, 2429, 2498]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0, 28926,   266,  ...,  1061,  2615,    13],
        [    0, 13081,   278,  ...,   368,   266,  1717]], device='cuda:1')


Sampled inputs[:2]: tensor([[    0, 12472,  1059,  ...,   642,   365,  6517],
        [    0,  9677,   609,  ...,   199,  1919,   298]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 200, Loss: 1.1984665393829346
rank: 1, step 200, Loss: 1.1954495906829834
rank: 2, step 200, Loss: 1.186874508857727
rank: 0, step 200, Loss: 1.1973413228988647




rank 2 | epoch 0 | step 201 | batch 201


Running epoch 0, step 201, batch 201

rank 3 | epoch 0 | step 201 | batch 201

rank 0 | epoch 0 | step 201 | batch 201

Running epoch 0, step 201, batch 201

rank 1 | epoch 0 | step 201 | batch 201



Running epoch 0, step 201, batch 201


Running epoch 0, step 201, batch 201
Sampled inputs[:2]: tensor([[    0,   298,   301,  ...,    13, 10308,  2129],
        [    0,   600,   287,  ...,  1933,   221,   494]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   89, 2023,  ..., 3230,  328,  790],
        [   0,   12,  266,  ..., 1125,  609,  292]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,    9,  287,  ...,  259, 8244, 1143],
        [   0, 4137,  300,  ..., 2579,  278,  266]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  5136,   446,  ...,  1173,   300,   266],
        [    0,    12, 17340,  ...,   408,  1550,  2415]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 201, Loss: 1.1870330572128296
rank: 3, step 201, Loss: 1.192180871963501
rank: 2, step 201, Loss: 1.1909898519515991
rank: 0, step 201, Loss: 1.1903139352798462




rank 2 | epoch 0 | step 202 | batch 202
rank 3 | epoch 0 | step 202 | batch 202
rank 0 | epoch 0 | step 202 | batch 202



Running epoch 0, step 202, batch 202

Running epoch 0, step 202, batch 202



rank 1 | epoch 0 | step 202 | batch 202


Running epoch 0, step 202, batch 202

Running epoch 0, step 202, batch 202

Sampled inputs[:2]: tensor([[   0, 1811,  278,  ...,  278,  259, 4617],
        [   0,  957,  680,  ..., 2573,  669,   12]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1428,   266,  ...,  3169,  3058,   278],
        [    0,  2834,   266,  ..., 39474,    12, 15441]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,     9,   300,  ...,  6838,   328, 18619],
        [    0,   266, 11692,  ...,   278, 14620, 12718]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  3445,   328,  ...,   278, 12323,   554],
        [    0,  1016,  1387,  ..., 12156, 14838,  3550]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 202, Loss: 1.2012876272201538
rank: 1, step 202, Loss: 1.186111569404602
rank: 2, step 202, Loss: 1.2014825344085693
rank: 0, step 202, Loss: 1.2093749046325684




rank 3 | epoch 0 | step 203 | batch 203
rank 0 | epoch 0 | step 203 | batch 203
rank 2 | epoch 0 | step 203 | batch 203



Running epoch 0, step 203, batch 203

Running epoch 0, step 203, batch 203



rank 1 | epoch 0 | step 203 | batch 203

Running epoch 0, step 203, batch 203


Running epoch 0, step 203, batch 203

Sampled inputs[:2]: tensor([[    0,   287, 30256,  ...,   287,  8137, 13021],
        [    0,   409,  4146,  ...,     9,   360,   259]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,    9,  287,  ...,  369, 2968, 8347],
        [   0, 7692,   12,  ...,  266, 2042,  278]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   300,  5864,  ...,    12,  3667,   796],
        [    0,  2973, 20362,  ...,   271, 43821, 11776]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   437,   266,  ...,   630,   586,   824],
        [    0, 21930,    12,  ...,  2849,   863,   578]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 203, Loss: 1.1867529153823853
rank: 1, step 203, Loss: 1.194594144821167
rank: 2, step 203, Loss: 1.1930545568466187

rank: 0, step 203, Loss: 1.2007476091384888



rank 3 | epoch 0 | step 204 | batch 204
rank 2 | epoch 0 | step 204 | batch 204



Running epoch 0, step 204, batch 204

Running epoch 0, step 204, batch 204


rank 1 | epoch 0 | step 204 | batch 204


Running epoch 0, step 204, batch 204

rank 0 | epoch 0 | step 204 | batch 204


Running epoch 0, step 204, batch 204
Sampled inputs[:2]: tensor([[    0,     9,  1471,  ...,   741,   266,  5821],
        [    0,   344, 10706,  ...,  1184,   578,   825]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   278,  1253,  ...,   266,  1274, 22300],
        [    0,   271,   266,  ...,    14,   333,   199]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1477,   591,  ...,  4111, 18012, 11991],
        [    0,   969,   258,  ...,   726,  5303,  6512]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   381, 19527,  ...,   271,   298,   292],
        [    0,  4995,   287,  ...,   300,  4531,  4729]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 204, Loss: 1.2164030075073242
rank: 0, step 204, Loss: 1.1901025772094727
rank: 3, step 204, Loss: 1.1830880641937256
rank: 2, step 204, Loss: 1.184041976928711




rank 0 | epoch 0 | step 205 | batch 205

rank 2 | epoch 0 | step 205 | batch 205
rank 3 | epoch 0 | step 205 | batch 205



Running epoch 0, step 205, batch 205

Running epoch 0, step 205, batch 205

Running epoch 0, step 205, batch 205



rank 1 | epoch 0 | step 205 | batch 205


Running epoch 0, step 205, batch 205
Sampled inputs[:2]: tensor([[    0,    12,   298,  ...,  5125,  6654,  4925],
        [    0,  1136,   944,  ...,   401, 13771,    12]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 3087,  401,  ..., 1875, 4122,  278],
        [   0, 1603,   12,  ...,   12,  756,  437]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 1862,   14,  ..., 2310, 2915, 4016],
        [   0, 1635,  266,  ...,  437, 3302,  287]], device='cuda:0')

Sampled inputs[:2]: tensor([[    0,  1487,  2511,  ..., 27735,   760,   266],
        [    0,   462,  9202,  ...,    15,  3256,   271]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 205, Loss: 1.2052323818206787
rank: 2, step 205, Loss: 1.185043454170227
rank: 1, step 205, Loss: 1.1878920793533325
rank: 0, step 205, Loss: 1.1935359239578247




rank 0 | epoch 0 | step 206 | batch 206
rank 3 | epoch 0 | step 206 | batch 206
rank 2 | epoch 0 | step 206 | batch 206




Running epoch 0, step 206, batch 206

Running epoch 0, step 206, batch 206



Running epoch 0, step 206, batch 206
rank 1 | epoch 0 | step 206 | batch 206



Running epoch 0, step 206, batch 206
Sampled inputs[:2]: tensor([[    0,  1067,   292,  ..., 10792, 11280,    14],
        [    0,   380,   759,  ...,  1420,  1804,   490]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,  328, 5180,  ...,  344, 2356,  409],
        [   0,  328,  266,  ...,   14, 3352,  266]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 5902,  518,  ..., 3126,   12,  497],
        [   0,  300, 1064,  ..., 6953,  944,  278]], device='cuda:0')Sampled inputs[:2]: tensor([[   0, 1042, 5738,  ...,   12,  287, 3643],
        [   0, 2192, 3182,  ..., 1445, 1531,  300]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 206, Loss: 1.1854156255722046
rank: 1, step 206, Loss: 1.1902161836624146
rank: 2, step 206, Loss: 1.2068771123886108
rank: 3, step 206, Loss: 1.1755396127700806




rank 0 | epoch 0 | step 207 | batch 207
rank 2 | epoch 0 | step 207 | batch 207

rank 3 | epoch 0 | step 207 | batch 207



Running epoch 0, step 207, batch 207


Running epoch 0, step 207, batch 207


Running epoch 0, step 207, batch 207
rank 1 | epoch 0 | step 207 | batch 207



Running epoch 0, step 207, batch 207
Sampled inputs[:2]: tensor([[    0,   680,   993,  ...,   699, 11426,    12],
        [    0,    21,    13,  ...,    14,   747,   806]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  7527,    15,  ...,  2677,   292, 30654],
        [    0,   531,    20,  ...,    12,  1644,   680]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   508, 22318,  ...,    13,  1107,  4093],
        [    0,  5055,   409,  ..., 32452, 24103,   472]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,  635,   13,  ...,   13, 4710, 1416],
        [   0, 3167,  300,  ..., 1109,  490, 1985]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 207, Loss: 1.188097596168518
rank: 0, step 207, Loss: 1.2000542879104614
rank: 2, step 207, Loss: 1.1880210638046265


Graident accumulation at epoch 0, step 207, batch 207Graident accumulation at epoch 0, step 207, batch 207

Graident accumulation at epoch 0, step 207, batch 207
rank: 1, step 207, Loss: 1.1936107873916626

Graident accumulation at epoch 0, step 207, batch 207

rank 2 | epoch 0 | step 208 | batch 208

rank 3 | epoch 0 | step 208 | batch 208


Running epoch 0, step 208, batch 208


Running epoch 0, step 208, batch 208

rank 0 | epoch 0 | step 208 | batch 208
Sampled inputs[:2]: tensor([[    0,   607, 27288,  ...,   445,  4712,   278],
        [    0,   590,    16,  ...,    13,    35,  1151]], device='cuda:2')

Running epoch 0, step 208, batch 208
Sampled inputs[:2]: tensor([[    0,  6584,   278,  ...,  1039,   965,  1410],
        [    0, 24086,   266,  ..., 18814,    19,   292]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  278,  266,  ...,  380, 4053,  352],
        [   0,  445,  749,  ...,  850, 1028,   13]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 1 | epoch 0 | step 208 | batch 208


Running epoch 0, step 208, batch 208
Sampled inputs[:2]: tensor([[   0,   14,  747,  ...,  367,  300,  369],
        [   0,  287, 6015,  ...,   14,  333,  199]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 208, Loss: 1.1889030933380127
rank: 2, step 208, Loss: 1.2095531225204468
rank: 1, step 208, Loss: 1.2035671472549438



rank: 0, step 208, Loss: 1.1779377460479736

rank 2 | epoch 0 | step 209 | batch 209
rank 0 | epoch 0 | step 209 | batch 209
rank 3 | epoch 0 | step 209 | batch 209



Running epoch 0, step 209, batch 209


Running epoch 0, step 209, batch 209



Running epoch 0, step 209, batch 209
rank 1 | epoch 0 | step 209 | batch 209



Running epoch 0, step 209, batch 209
Sampled inputs[:2]: tensor([[    0,  9792,  3239,  ...,   699,  3636,  1761],
        [    0, 26074,   486,  ...,  2314,   266,  1090]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 36122,  1085,  ...,  6231,     9,  7794],
        [    0,  1231,   278,  ...,    12,  2606,   266]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,  432,  984,  ...,  287,  496,   14],
        [   0, 6184, 1412,  ...,   12,  266,  944]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  1197, 12404,  ...,   287,   271,  4893],
        [    0,   925,   271,  ...,   631,  3370,   940]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 209, Loss: 1.1976312398910522
rank: 1, step 209, Loss: 1.1789195537567139
rank: 3, step 209, Loss: 1.2120697498321533
rank: 0, step 209, Loss: 1.2091306447982788




rank 2 | epoch 0 | step 210 | batch 210

rank 3 | epoch 0 | step 210 | batch 210


Running epoch 0, step 210, batch 210

Running epoch 0, step 210, batch 210


rank 1 | epoch 0 | step 210 | batch 210


Running epoch 0, step 210, batch 210

rank 0 | epoch 0 | step 210 | batch 210Sampled inputs[:2]: tensor([[   0,  266, 1211,  ..., 1336,  694,  516],
        [   0, 2555,  984,  ..., 5900, 1576,  271]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,   81, 1619,  ..., 2442,   13, 1581],
        [   0,  298,  894,  ...,  266, 2904, 1679]], device='cuda:3')




Running epoch 0, step 210, batch 210Sampled inputs[:2]: tensor([[    0, 11853,  1611,  ...,  4413,  4240,   278],
        [    0,     8,    39,  ...,  7406,    13, 10896]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3761,    12,  ...,    14,    22,   287],
        [    0,   369, 17432,  ...,   874,  2577,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 210, Loss: 1.1939221620559692
rank: 3, step 210, Loss: 1.1905864477157593
rank: 0, step 210, Loss: 1.1935689449310303
rank: 2, step 210, Loss: 1.1946676969528198




rank 2 | epoch 0 | step 211 | batch 211

rank 3 | epoch 0 | step 211 | batch 211

Running epoch 0, step 211, batch 211


rank 0 | epoch 0 | step 211 | batch 211

Running epoch 0, step 211, batch 211

rank 1 | epoch 0 | step 211 | batch 211



Running epoch 0, step 211, batch 211


Running epoch 0, step 211, batch 211
Sampled inputs[:2]: tensor([[    0,  5722, 20126,  ...,  1500,   696,   259],
        [    0, 11054,    12,  ...,   560,   199,   677]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 29368,    13,  ...,   376,    88,  3333],
        [    0,  3773, 23452,  ..., 14393,  1121,   304]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   380, 26765,  ...,     9,   367,  6930],
        [    0,  1064,  1042,  ...,    12,   259,  4754]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   759,  1184,  ...,   472,   346,    14],
        [    0,   677, 20206,  ...,   292,   334,  1550]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 211, Loss: 1.205649733543396
rank: 2, step 211, Loss: 1.1824307441711426
rank: 3, step 211, Loss: 1.226264476776123
rank: 0, step 211, Loss: 1.1906036138534546




rank 3 | epoch 0 | step 212 | batch 212
rank 0 | epoch 0 | step 212 | batch 212
rank 2 | epoch 0 | step 212 | batch 212



Running epoch 0, step 212, batch 212

Running epoch 0, step 212, batch 212



rank 1 | epoch 0 | step 212 | batch 212


Running epoch 0, step 212, batch 212

Running epoch 0, step 212, batch 212

Sampled inputs[:2]: tensor([[    0,   221,   825,  ...,   616,  3661,  8052],
        [    0,   413,    20,  ...,  2089,    12, 21064]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   287,  2503,  ...,   496,    14, 37791],
        [    0,   437, 11670,  ...,   381, 11996,    13]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 2790,  266,  ...,  401, 1496,   14],
        [   0,   13, 4363,  ...,  271, 2462,  709]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   443,    40,  ...,   346,   462,   221],
        [    0,   287, 11638,  ...,    17,   221,   733]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 212, Loss: 1.180752158164978
rank: 3, step 212, Loss: 1.1810277700424194
rank: 0, step 212, Loss: 1.205910563468933
rank: 2, step 212, Loss: 1.195593237876892




rank 0 | epoch 0 | step 213 | batch 213
rank 2 | epoch 0 | step 213 | batch 213
rank 3 | epoch 0 | step 213 | batch 213




Running epoch 0, step 213, batch 213

Running epoch 0, step 213, batch 213


rank 1 | epoch 0 | step 213 | batch 213


Running epoch 0, step 213, batch 213

Running epoch 0, step 213, batch 213

Sampled inputs[:2]: tensor([[    0,   984,    13,  ...,    13, 37385,   490],
        [    0, 40995,  5863,  ...,    13,  9819,   609]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   287,  1790,  ..., 11367,  9476,  2545],
        [    0,  1485,   271,  ...,  6359,  1799,  5442]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,    12,  1041,  ..., 22086,  3073,   554],
        [    0,   333,   199,  ...,   292,    48,  1792]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1477,  3205,  ...,  6441,  9363,   271],
        [    0,  7712, 31756,  ...,   895,   360,   630]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 213, Loss: 1.1995519399642944
rank: 3, step 213, Loss: 1.1894073486328125
rank: 0, step 213, Loss: 1.1887047290802002
rank: 2, step 213, Loss: 1.190022349357605




rank 2 | epoch 0 | step 214 | batch 214
rank 3 | epoch 0 | step 214 | batch 214


rank 0 | epoch 0 | step 214 | batch 214

Running epoch 0, step 214, batch 214

Running epoch 0, step 214, batch 214



rank 1 | epoch 0 | step 214 | batch 214


Running epoch 0, step 214, batch 214


Running epoch 0, step 214, batch 214
Sampled inputs[:2]: tensor([[   0,  278, 9939,  ..., 1238,   14,  445],
        [   0, 3380, 1197,  ...,  631,  369, 3123]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   471,    14,  ..., 27104,     9,   631],
        [    0,  1340,   800,  ...,   259, 13583,   422]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  298, 8761,  ...,  271,  266,  298],
        [   0, 1416,  367,  ...,  555,  764,  367]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,  341,  298,  ...,  298, 1304,  292],
        [   0,   40,  568,  ..., 3750,  300, 3421]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 214, Loss: 1.181524395942688
rank: 1, step 214, Loss: 1.1878892183303833
rank: 3, step 214, Loss: 1.1901426315307617
rank: 2, step 214, Loss: 1.1996877193450928




rank 0 | epoch 0 | step 215 | batch 215
rank 2 | epoch 0 | step 215 | batch 215

rank 3 | epoch 0 | step 215 | batch 215



Running epoch 0, step 215, batch 215


Running epoch 0, step 215, batch 215


Running epoch 0, step 215, batch 215
rank 1 | epoch 0 | step 215 | batch 215



Running epoch 0, step 215, batch 215
Sampled inputs[:2]: tensor([[    0,   259,  6887,  ...,  1400,   292,   474],
        [    0,    20,  2637,  ..., 14044,     9,   292]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  4154, 14296,  ...,   516,  1796, 18233],
        [    0,  8290,   391,  ...,   298,  1253,     7]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  2895,    26,  ..., 11645,  1535,  1558],
        [    0,  1795,   365,  ...,   266, 46932,   293]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,  266, 2967,  ...,  287, 4432,   13],
        [   0, 7926, 6750,  ...,  259, 1524, 6257]], device='cuda:0')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 215, Loss: 1.2091447114944458
rank: 3, step 215, Loss: 1.1951876878738403
rank: 0, step 215, Loss: 1.1744894981384277
rank: 2, step 215, Loss: 1.2027442455291748



Graident accumulation at epoch 0, step 215, batch 215
Graident accumulation at epoch 0, step 215, batch 215
Graident accumulation at epoch 0, step 215, batch 215Graident accumulation at epoch 0, step 215, batch 215


rank 2 | epoch 0 | step 216 | batch 216


Running epoch 0, step 216, batch 216

rank 3 | epoch 0 | step 216 | batch 216

rank 0 | epoch 0 | step 216 | batch 216

Running epoch 0, step 216, batch 216

rank 1 | epoch 0 | step 216 | batch 216



Running epoch 0, step 216, batch 216


Running epoch 0, step 216, batch 216
Sampled inputs[:2]: tensor([[   0,   12, 2418,  ...,  446,  381, 2204],
        [   0,  721, 1119,  ...,  600,  328, 3363]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    47,  1838,  ...,   792,    83, 42612],
        [    0,   344,  2574,  ...,  2558,  2663,   328]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 14979,   408,  ...,   369,  1716,    12],
        [    0, 23988, 26825,  ...,   373,   221,   334]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   292,   380,  ...,   527, 37357,    12],
        [    0,  5841,   328,  ...,  2051,   266,   756]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 216, Loss: 1.204606533050537
rank: 1, step 216, Loss: 1.2043663263320923
rank: 2, step 216, Loss: 1.1963493824005127

rank: 0, step 216, Loss: 1.1853229999542236



rank 0 | epoch 0 | step 217 | batch 217
rank 2 | epoch 0 | step 217 | batch 217

rank 3 | epoch 0 | step 217 | batch 217



Running epoch 0, step 217, batch 217

Running epoch 0, step 217, batch 217



Running epoch 0, step 217, batch 217
rank 1 | epoch 0 | step 217 | batch 217



Running epoch 0, step 217, batch 217
Sampled inputs[:2]: tensor([[    0, 14652,    12,  ..., 17330,   996,  3294],
        [    0,  5143,  3877,  ...,   292, 44003,    12]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  266, 2604,  ...,  278, 4035, 4165],
        [   0,  834,   89,  ..., 4030,   12, 6528]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  266,  996,  ...,  709,  616, 9378],
        [   0,  565, 1360,  ...,  278, 2722, 1683]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    14,   417,  ...,  8821,  6845,   278],
        [    0,   367,   925,  ..., 25491,   847,   328]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 217, Loss: 1.195491909980774
rank: 3, step 217, Loss: 1.19625723361969
rank: 0, step 217, Loss: 1.1919697523117065


rank: 2, step 217, Loss: 1.1932889223098755


rank 0 | epoch 0 | step 218 | batch 218

rank 2 | epoch 0 | step 218 | batch 218
rank 3 | epoch 0 | step 218 | batch 218



Running epoch 0, step 218, batch 218

Running epoch 0, step 218, batch 218

Running epoch 0, step 218, batch 218



rank 1 | epoch 0 | step 218 | batch 218


Running epoch 0, step 218, batch 218
Sampled inputs[:2]: tensor([[   0, 1070, 5746,  ...,  278,  689,   14],
        [   0,  706, 6989,  ..., 6914,   15, 2537]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  516,  689,  ...,  278,  516, 6137],
        [   0,    9,  870,  ..., 2671,  965, 3229]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   221,   380,  ...,   292,   334,   674],
        [    0,   266, 30368,  ...,   950,   266,  1868]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,  9419,   221,  ...,    15, 22168,     9],
        [    0,  1853,  3373,  ...,  3020,  6695,   300]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 218, Loss: 1.192935585975647
rank: 2, step 218, Loss: 1.1912741661071777
rank: 1, step 218, Loss: 1.2012251615524292
rank: 0, step 218, Loss: 1.1978713274002075




rank 0 | epoch 0 | step 219 | batch 219

rank 3 | epoch 0 | step 219 | batch 219
rank 2 | epoch 0 | step 219 | batch 219



Running epoch 0, step 219, batch 219

Running epoch 0, step 219, batch 219

Running epoch 0, step 219, batch 219



rank 1 | epoch 0 | step 219 | batch 219


Running epoch 0, step 219, batch 219
Sampled inputs[:2]: tensor([[    0,  1943,   300,  ..., 43803,   368,  2400],
        [    0,  1890,   278,  ...,   578,    72,   815]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   292,    33,  ...,   352,   266,  9129],
        [    0,   273,   298,  ..., 23554,    12,  1530]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  677, 6499,  ..., 2738,   12,  287],
        [   0,  957, 1231,  ...,  800,  342, 1398]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,   496,    14,  ...,   266,   596,    13],
        [    0,  2352,  4275,  ..., 10518,   342,   266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 1, step 219, Loss: 1.182227373123169
rank: 3, step 219, Loss: 1.1915005445480347
rank: 2, step 219, Loss: 1.1721265316009521



rank: 0, step 219, Loss: 1.1947473287582397

rank 0 | epoch 0 | step 220 | batch 220
rank 2 | epoch 0 | step 220 | batch 220



Running epoch 0, step 220, batch 220

rank 3 | epoch 0 | step 220 | batch 220


Running epoch 0, step 220, batch 220
rank 1 | epoch 0 | step 220 | batch 220


Running epoch 0, step 220, batch 220


Running epoch 0, step 220, batch 220

Sampled inputs[:2]: tensor([[   0,  616, 4935,  ...,   89, 4448,  271],
        [   0, 6673,  298,  ..., 4391,  292,  221]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  5319,    14,  ...,  2372,  2356,  4093],
        [    0,   609,    12,  ...,   409, 11041,   292]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 1304, 1040,  ...,  287, 1665,  741],
        [   0, 1716, 1773,  ..., 5014,   12,  847]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  472,  346,  ...,  298,  527,  496],
        [   0, 5625, 2558,  ...,  680,  292,  494]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 220, Loss: 1.1945912837982178
rank: 1, step 220, Loss: 1.1960482597351074
rank: 2, step 220, Loss: 1.1995521783828735
rank: 0, step 220, Loss: 1.1862000226974487




rank 0 | epoch 0 | step 221 | batch 221

rank 2 | epoch 0 | step 221 | batch 221

Running epoch 0, step 221, batch 221
rank 3 | epoch 0 | step 221 | batch 221



Running epoch 0, step 221, batch 221


Running epoch 0, step 221, batch 221


rank 1 | epoch 0 | step 221 | batch 221


Running epoch 0, step 221, batch 221
Sampled inputs[:2]: tensor([[   0,   28, 2973,  ..., 8762, 2134,   27],
        [   0, 6945, 2360,  ...,   30,  413,   16]], device='cuda:0')Sampled inputs[:2]: tensor([[    0, 24440,  1918,  ...,   769,  1254,   596],
        [    0,  1266,  2257,  ..., 27146,  1141,  1196]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 41010,  6737,  ...,   963,   409,   382],
        [    0,  2278,   292,  ..., 12060,  1319,   292]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    83,    12,  ...,  3781,   292, 27247],
        [    0,  7377, 30662,  ...,   287,   694, 13403]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 1, step 221, Loss: 1.1856637001037598
rank: 3, step 221, Loss: 1.1859853267669678
rank: 0, step 221, Loss: 1.1943683624267578

rank: 2, step 221, Loss: 1.1847189664840698



rank 0 | epoch 0 | step 222 | batch 222

rank 2 | epoch 0 | step 222 | batch 222

rank 3 | epoch 0 | step 222 | batch 222


Running epoch 0, step 222, batch 222

Running epoch 0, step 222, batch 222


Running epoch 0, step 222, batch 222


rank 1 | epoch 0 | step 222 | batch 222


Running epoch 0, step 222, batch 222
Sampled inputs[:2]: tensor([[    0,    14, 22157,  ...,  2341,   508, 22960],
        [    0,  1871,   401,  ...,    14,  4797,    12]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   927, 13407,  ...,   616,  3955,  2567],
        [    0, 22390,   292,  ...,  3552,   278,   317]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 1241, 2098,  ..., 1862,  631,  369],
        [   0, 1067,  271,  ...,  266,  940,  271]], device='cuda:0')

Sampled inputs[:2]: tensor([[   0,  472,  346,  ...,  394,  360, 5911],
        [   0, 1057,   14,  ...,   14, 4735,   13]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 222, Loss: 1.2017362117767334
rank: 1, step 222, Loss: 1.1934093236923218
rank: 2, step 222, Loss: 1.1924678087234497

rank: 0, step 222, Loss: 1.199118733406067



rank 3 | epoch 0 | step 223 | batch 223

rank 2 | epoch 0 | step 223 | batch 223


Running epoch 0, step 223, batch 223


Running epoch 0, step 223, batch 223

rank 0 | epoch 0 | step 223 | batch 223
rank 1 | epoch 0 | step 223 | batch 223


Running epoch 0, step 223, batch 223



Running epoch 0, step 223, batch 223
Sampled inputs[:2]: tensor([[    0,   278,  2354,  ...,  4974,  7757,   472],
        [    0,   452,    13,  ...,   358,    13, 12347]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 6294,  367,  ...,  496,   14,   18],
        [   0,  368,  275,  ..., 6389, 9102,   12]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    14,   381,  ...,   278,   269, 10376],
        [    0,  4323,  2377,  ...,  3878,  4044,    14]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   29,  413,  ..., 1527, 1503,  369],
        [   0, 6418,  446,  ...,  413,   29,  413]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 223, Loss: 1.1846717596054077
rank: 1, step 223, Loss: 1.1716890335083008
rank: 0, step 223, Loss: 1.183590292930603
rank: 2, step 223, Loss: 1.1966279745101929



Graident accumulation at epoch 0, step 223, batch 223Graident accumulation at epoch 0, step 223, batch 223

Graident accumulation at epoch 0, step 223, batch 223Graident accumulation at epoch 0, step 223, batch 223


rank 2 | epoch 0 | step 224 | batch 224
rank 0 | epoch 0 | step 224 | batch 224

rank 3 | epoch 0 | step 224 | batch 224

Running epoch 0, step 224, batch 224




Running epoch 0, step 224, batch 224


Running epoch 0, step 224, batch 224

rank 1 | epoch 0 | step 224 | batch 224


Running epoch 0, step 224, batch 224
Sampled inputs[:2]: tensor([[   0,  516,  596,  ..., 3109,  287,  394],
        [   0,  560,  199,  ...,   29,  445,   16]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   12, 5820,  ...,  221,  380,  560],
        [   0, 6275,   12,  ..., 2027, 2887,  287]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 2162,   73,  ...,  278,  266, 1059],
        [   0,  278, 4452,  ...,   14,   18, 3046]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   300, 12579,  ...,  1722,   369,  5049],
        [    0,  1596,  2700,  ...,   943,   266,  4086]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 2, step 224, Loss: 1.1927733421325684
rank: 0, step 224, Loss: 1.2052730321884155
rank: 3, step 224, Loss: 1.1965858936309814
rank: 1, step 224, Loss: 1.2138748168945312




rank 2 | epoch 0 | step 225 | batch 225

rank 3 | epoch 0 | step 225 | batch 225


Running epoch 0, step 225, batch 225


Running epoch 0, step 225, batch 225

rank 0 | epoch 0 | step 225 | batch 225
rank 1 | epoch 0 | step 225 | batch 225


Running epoch 0, step 225, batch 225



Running epoch 0, step 225, batch 225
Sampled inputs[:2]: tensor([[    0,   360,  2063,  ..., 49105,   221,  1868],
        [    0,   346,   462,  ...,   474, 38333,    87]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 48545,    26,  ...,  1471,   266,   319],
        [    0,   266,  7264,  ...,  3211,   328,   275]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 11822,    12,  ...,   554,  3845,   271],
        [    0,  7638,   720,  ...,  3059, 10777,   292]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   374,   298,  ..., 11183,    12,   654],
        [    0,   278, 38717,  ...,  9945,   367,  5430]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 225, Loss: 1.1747726202011108
rank: 1, step 225, Loss: 1.2007334232330322
rank: 2, step 225, Loss: 1.1807105541229248
rank: 0, step 225, Loss: 1.1914520263671875




rank 0 | epoch 0 | step 226 | batch 226

rank 2 | epoch 0 | step 226 | batch 226
rank 3 | epoch 0 | step 226 | batch 226



Running epoch 0, step 226, batch 226

Running epoch 0, step 226, batch 226

Running epoch 0, step 226, batch 226



rank 1 | epoch 0 | step 226 | batch 226


Running epoch 0, step 226, batch 226
Sampled inputs[:2]: tensor([[    0, 11694,   292,  ...,   328,  1654,   818],
        [    0,   413,    16,  ...,   493,  2104,    14]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   446, 28686,  ...,    35,  2706, 19712],
        [    0,   462,   221,  ...,   278, 48911,   292]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,  4371,  4806,  ...,   685,   461,   654],
        [    0,   792,    83,  ...,   957, 13285,   271]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  8538,    13,  ...,  3825, 33705,  2442],
        [    0,    14,   417,  ...,    43,   503,    67]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 0, step 226, Loss: 1.2091132402420044
rank: 1, step 226, Loss: 1.1901392936706543
rank: 3, step 226, Loss: 1.1934874057769775
rank: 2, step 226, Loss: 1.1993622779846191




rank 0 | epoch 0 | step 227 | batch 227


Running epoch 0, step 227, batch 227

rank 3 | epoch 0 | step 227 | batch 227

rank 2 | epoch 0 | step 227 | batch 227


Running epoch 0, step 227, batch 227


Running epoch 0, step 227, batch 227

rank 1 | epoch 0 | step 227 | batch 227


Running epoch 0, step 227, batch 227
Sampled inputs[:2]: tensor([[    0,   874,   445,  ...,    14, 16205,  8510],
        [    0,    13,  8982,  ...,   462,   221,   494]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,   365,  8790,  ...,  1172,  8806,   266],
        [    0,    14,  3948,  ...,   571, 10097,    12]], device='cuda:3')Sampled inputs[:2]: tensor([[   0,    9,  391,  ...,  300, 2646, 1717],
        [   0,   14, 3445,  ...,  298,  527, 2732]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   342, 22510,  ..., 49108,   278, 25904],
        [    0, 10386,  6404,  ...,   292,   325, 12071]], device='cuda:1')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 227, Loss: 1.192814826965332
rank: 3, step 227, Loss: 1.1882433891296387
rank: 1, step 227, Loss: 1.2024747133255005
rank: 0, step 227, Loss: 1.1895502805709839




rank 0 | epoch 0 | step 228 | batch 228

rank 2 | epoch 0 | step 228 | batch 228


Running epoch 0, step 228, batch 228
rank 3 | epoch 0 | step 228 | batch 228


Running epoch 0, step 228, batch 228



Running epoch 0, step 228, batch 228

rank 1 | epoch 0 | step 228 | batch 228


Running epoch 0, step 228, batch 228
Sampled inputs[:2]: tensor([[    0, 10084,    12,  ..., 24717,   365,  1616],
        [    0,    14,   381,  ...,  2195,   278,   266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   199,   769,  ..., 12038, 15317,   342],
        [    0, 10348,  2994,  ...,   266, 24089, 10607]], device='cuda:0')
Sampled inputs[:2]: tensor([[   0, 4868, 3106,  ..., 2637,  278,  521],
        [   0, 3441,  796,  ..., 7561, 1711,  857]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 2314,  516,  ..., 1871,   13, 1303],
        [   0,  741, 2985,  ...,  199,  769,  278]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 228, Loss: 1.2051924467086792
rank: 2, step 228, Loss: 1.1888943910598755
rank: 1, step 228, Loss: 1.1729590892791748
rank: 0, step 228, Loss: 1.201615810394287




rank 0 | epoch 0 | step 229 | batch 229
rank 2 | epoch 0 | step 229 | batch 229

rank 3 | epoch 0 | step 229 | batch 229


Running epoch 0, step 229, batch 229



Running epoch 0, step 229, batch 229

rank 1 | epoch 0 | step 229 | batch 229

Running epoch 0, step 229, batch 229


Running epoch 0, step 229, batch 229

Sampled inputs[:2]: tensor([[   0,  259, 6022,  ..., 1871, 1209, 1241],
        [   0, 6640,   13,  ...,  292,  221,  273]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    14,  5551,  ...,   668, 11988,  2538],
        [    0,   714,    14,  ...,  1501, 11397, 31940]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 2816,  292,  ..., 3662,  461, 2723],
        [   0,   12,  358,  ...,  352,  266,  319]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   409,   394,  ...,   475,  5458,   328],
        [    0, 10296,   809,  ..., 27683,    12,   287]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 229, Loss: 1.192596435546875
rank: 1, step 229, Loss: 1.2059046030044556
rank: 0, step 229, Loss: 1.2146981954574585
rank: 2, step 229, Loss: 1.1881847381591797




rank 0 | epoch 0 | step 230 | batch 230

rank 2 | epoch 0 | step 230 | batch 230
rank 3 | epoch 0 | step 230 | batch 230



Running epoch 0, step 230, batch 230

Running epoch 0, step 230, batch 230

Running epoch 0, step 230, batch 230



rank 1 | epoch 0 | step 230 | batch 230


Running epoch 0, step 230, batch 230
Sampled inputs[:2]: tensor([[   0,  586,  940,  ..., 1471, 2612,  591],
        [   0, 8416,  669,  ...,  298,  894,  496]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1016,  271,  ...,  461,  616,  993],
        [   0,   89, 6893,  ..., 5254,  278, 4531]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 47354,  5923,  ...,   266, 14679,  8137],
        [    0,  2663,   328,  ...,   266,  1040,  1679]], device='cuda:0')

Sampled inputs[:2]: tensor([[    0,   565,    27,  ...,    88,  4451,    14],
        [    0,   515,   352,  ..., 21190,  1871,   950]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 230, Loss: 1.2124115228652954
rank: 1, step 230, Loss: 1.1836813688278198
rank: 2, step 230, Loss: 1.1875665187835693



rank: 0, step 230, Loss: 1.1910537481307983

rank 0 | epoch 0 | step 231 | batch 231
rank 2 | epoch 0 | step 231 | batch 231


rank 3 | epoch 0 | step 231 | batch 231


Running epoch 0, step 231, batch 231


Running epoch 0, step 231, batch 231

Running epoch 0, step 231, batch 231


rank 1 | epoch 0 | step 231 | batch 231


Running epoch 0, step 231, batch 231
Sampled inputs[:2]: tensor([[    0, 13466,    14,  ..., 11227,  1966,  4039],
        [    0,  2085,    12,  ...,   496,    14,   747]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   19,   14,  ...,  278, 2588,  944],
        [   0, 2663,  328,  ...,  342,  266, 1163]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 1615,  292,  ..., 4824,  292, 9936],
        [   0, 1197, 3025,  ...,   14,  747, 3739]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,  795, 3185,  ...,   14, 1671,  199],
        [   0,  292,  960,  ...,  271, 1356,   14]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 231, Loss: 1.190557837486267
rank: 1, step 231, Loss: 1.176491618156433
rank: 0, step 231, Loss: 1.2203036546707153


rank: 2, step 231, Loss: 1.1877479553222656

Graident accumulation at epoch 0, step 231, batch 231
Graident accumulation at epoch 0, step 231, batch 231
Graident accumulation at epoch 0, step 231, batch 231Graident accumulation at epoch 0, step 231, batch 231


rank 0 | epoch 0 | step 232 | batch 232


Running epoch 0, step 232, batch 232

rank 3 | epoch 0 | step 232 | batch 232


Running epoch 0, step 232, batch 232

rank 1 | epoch 0 | step 232 | batch 232

rank 2 | epoch 0 | step 232 | batch 232


Running epoch 0, step 232, batch 232

Running epoch 0, step 232, batch 232

Sampled inputs[:2]: tensor([[    0,   275, 11628,  ...,   408,  1296,  3796],
        [    0,  4191,   368,  ...,   367,  4182,    14]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,  7070,    86,  ...,   298,  4930,   518],
        [    0,    12,   287,  ...,  2381, 12046,  2231]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   266,  4505,  ...,    12,   461,   806],
        [    0,   380,  2114,  ...,   456, 28979,   472]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  504,  546,  ...,  634,  328,  630],
        [   0, 2377,  360,  ...,  266, 4745,  963]], device='cuda:2')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 232, Loss: 1.1897478103637695
rank: 2, step 232, Loss: 1.2016308307647705
rank: 1, step 232, Loss: 1.192547082901001
rank: 0, step 232, Loss: 1.1819573640823364




rank 3 | epoch 0 | step 233 | batch 233
rank 2 | epoch 0 | step 233 | batch 233


rank 0 | epoch 0 | step 233 | batch 233

Running epoch 0, step 233, batch 233

Running epoch 0, step 233, batch 233



rank 1 | epoch 0 | step 233 | batch 233


Running epoch 0, step 233, batch 233

Running epoch 0, step 233, batch 233

Sampled inputs[:2]: tensor([[    0,   756,   943,  ...,  4016,    12,   627],
        [    0,     9,   287,  ..., 16261,   417,   199]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  8125,  5241,  ...,   328,  3227,   278],
        [    0,   417,   199,  ...,  9472, 15004,   511]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  1842,   360,  ..., 10251,    14,  1062],
        [    0,  1619,   938,  ...,   292, 10026, 14367]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 5583,  598,  ...,  199,  395, 6551],
        [   0, 1431,  221,  ...,  756,  409,  275]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 233, Loss: 1.1902514696121216
rank: 3, step 233, Loss: 1.199766993522644
rank: 0, step 233, Loss: 1.1878570318222046
rank: 2, step 233, Loss: 1.1892238855361938




rank 3 | epoch 0 | step 234 | batch 234
rank 2 | epoch 0 | step 234 | batch 234
rank 0 | epoch 0 | step 234 | batch 234



Running epoch 0, step 234, batch 234

Running epoch 0, step 234, batch 234



rank 1 | epoch 0 | step 234 | batch 234


Running epoch 0, step 234, batch 234

Running epoch 0, step 234, batch 234

Sampled inputs[:2]: tensor([[   0,   18,  998,  ..., 5322,  504,  287],
        [   0,  334,  287,  ..., 1348, 6139,  342]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  292,  380,  ..., 6156,  278,  266],
        [   0, 3978, 2697,  ...,  461, 5955, 3792]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  278, 1099,  ...,  496,   14,  879],
        [   0, 1167, 2667,  ..., 4769,   13, 5019]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  2923,   266,  ...,  7763,   360,  1255],
        [    0,  3211,   328,  ...,  2098,  1231, 35325]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 234, Loss: 1.213463306427002
rank: 1, step 234, Loss: 1.1913200616836548
rank: 2, step 234, Loss: 1.1971594095230103
rank: 0, step 234, Loss: 1.196489691734314




rank 3 | epoch 0 | step 235 | batch 235
rank 2 | epoch 0 | step 235 | batch 235



Running epoch 0, step 235, batch 235

Running epoch 0, step 235, batch 235


rank 0 | epoch 0 | step 235 | batch 235
rank 1 | epoch 0 | step 235 | batch 235


Running epoch 0, step 235, batch 235



Running epoch 0, step 235, batch 235
Sampled inputs[:2]: tensor([[    0,   508,  2322,  ...,   968,   266, 15123],
        [    0,    12,   287,  ...,  2336,   221,   334]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,  4298,  1231,   352],
        [    0,  1985,   278,  ...,   677, 12292, 17956]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  221,  334,  ...,  271,  266, 7246],
        [   0, 6978, 2285,  ..., 4477,  271,  221]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,   14,  469,  ...,  367, 2564,  368],
        [   0, 7428, 1566,  ...,  199, 1726, 5647]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 235, Loss: 1.2077558040618896
rank: 1, step 235, Loss: 1.2093333005905151
rank: 2, step 235, Loss: 1.1912777423858643
rank: 0, step 235, Loss: 1.1970089673995972




rank 0 | epoch 0 | step 236 | batch 236

rank 2 | epoch 0 | step 236 | batch 236
rank 3 | epoch 0 | step 236 | batch 236



Running epoch 0, step 236, batch 236

Running epoch 0, step 236, batch 236



Running epoch 0, step 236, batch 236

rank 1 | epoch 0 | step 236 | batch 236


Running epoch 0, step 236, batch 236
Sampled inputs[:2]: tensor([[   0, 5150, 1030,  ...,   14,  475, 1763],
        [   0, 2732,  413,  ...,  287,  266, 3668]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   259,  2416,  ..., 14474,    12,   259],
        [    0,   271,  5738,  ...,    12,    21,  9023]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    14,  4746,  ...,   266,  1119,  1705],
        [    0,  2851,  5442,  ..., 38820,    14,   417]], device='cuda:0')
Sampled inputs[:2]: tensor([[    0,   829,   874,  ...,   292,   380,   759],
        [    0,   269,    12,  ..., 45645,    14,   298]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 236, Loss: 1.1982827186584473
rank: 1, step 236, Loss: 1.1767499446868896
rank: 2, step 236, Loss: 1.1924211978912354
rank: 0, step 236, Loss: 1.211667537689209




rank 0 | epoch 0 | step 237 | batch 237

rank 3 | epoch 0 | step 237 | batch 237
rank 2 | epoch 0 | step 237 | batch 237



Running epoch 0, step 237, batch 237

Running epoch 0, step 237, batch 237



Running epoch 0, step 237, batch 237

rank 1 | epoch 0 | step 237 | batch 237


Running epoch 0, step 237, batch 237
Sampled inputs[:2]: tensor([[    0, 21448,   344,  ...,   365,  1501,   271],
        [    0, 12182,  6294,  ...,  1042,  1070,  2228]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1976, 1329,  ...,  278, 9469,  292],
        [   0,  266, 2653,  ...,   29,   16,   14]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 2728, 3139,  ..., 2254,  221,  380],
        [   0,  278,  266,  ...,  292,  474,  221]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   591, 36195,  ...,  3359,   717,    12],
        [    0,  1342,    14,  ...,  1236, 15667, 12931]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 237, Loss: 1.1724662780761719
rank: 2, step 237, Loss: 1.1890645027160645
rank: 1, step 237, Loss: 1.1911754608154297
rank: 3, step 237, Loss: 1.1837947368621826




rank 0 | epoch 0 | step 238 | batch 238
rank 3 | epoch 0 | step 238 | batch 238
rank 2 | epoch 0 | step 238 | batch 238


rank 1 | epoch 0 | step 238 | batch 238


Running epoch 0, step 238, batch 238

Running epoch 0, step 238, batch 238




Running epoch 0, step 238, batch 238


Running epoch 0, step 238, batch 238
Sampled inputs[:2]: tensor([[    0, 17301,   300,  ...,   278,   546,  1576],
        [    0,   417,   199,  ...,  2057,   342, 11927]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1760,     9,  ...,  5996,    71,    19],
        [    0,   221,  1771,  ..., 14547,  1705,  1003]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   266,  2109,  ...,  6730, 11558,   287],
        [    0,  1862,   674,  ...,   391,   266,  7688]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  726, 3979,  ...,   27, 2085,   12],
        [   0,  923,   13,  ...,  199,  677, 3826]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 238, Loss: 1.211464762687683
rank: 3, step 238, Loss: 1.1933797597885132
rank: 2, step 238, Loss: 1.208764672279358
rank: 0, step 238, Loss: 1.1867716312408447




rank 3 | epoch 0 | step 239 | batch 239
rank 0 | epoch 0 | step 239 | batch 239
rank 2 | epoch 0 | step 239 | batch 239



Running epoch 0, step 239, batch 239

Running epoch 0, step 239, batch 239



rank 1 | epoch 0 | step 239 | batch 239


Running epoch 0, step 239, batch 239

Running epoch 0, step 239, batch 239

Sampled inputs[:2]: tensor([[    0,  4014,    88,  ...,    14, 11961,    13],
        [    0,   365,  1110,  ...,  4130,   221,   199]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  3256,   221,  ..., 18116,   292, 47989],
        [    0,  7994,    12,  ..., 13800,   278,   795]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   380,  1075,  ..., 16948,   266,  1751],
        [    0,   266,   944,  ..., 14981,  1952,   271]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  471,   12,  ...,   13, 9909, 2673],
        [   0, 5440,   13,  ..., 1878,  342, 2060]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 109, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 239, Loss: 1.1841800212860107
rank: 0, step 239, Loss: 1.205726146697998
rank: 3, step 239, Loss: 1.2001034021377563
rank: 1, step 239, Loss: 1.1967271566390991



Graident accumulation at epoch 0, step 239, batch 239Graident accumulation at epoch 0, step 239, batch 239

Graident accumulation at epoch 0, step 239, batch 239Graident accumulation at epoch 0, step 239, batch 239

Saving checkpoint at epoch 0, step 239, batch 239Saving checkpoint at epoch 0, step 239, batch 239

Saving checkpoint at epoch 0, step 239, batch 239
Epoch 0 | Batch 239/262 | Training PPL: 15456.875099159894 | time 27.278499841690063
Saving checkpoint at epoch 0, step 239, batch 239
Epoch 0 | Validation PPL: 13627.407935529927 | Learning rate: 3.6752822198246384e-07

rank 2 | epoch 0 | step 240 | batch 240
rank 3 | epoch 0 | step 240 | batch 240
rank 1 | epoch 0 | step 240 | batch 240




Running epoch 0, step 240, batch 240

Running epoch 0, step 240, batch 240



Running epoch 0, step 240, batch 240
Sampled inputs[:2]: tensor([[   0, 6112,  278,  ..., 4092,  490, 2774],
        [   0,  257,   13,  ...,  328,  630, 1403]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 13312,  9048,  ..., 33470,  8672,  3524],
        [    0,    16,    14,  ...,   300,  9283,    14]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   19,   14,  ...,   13, 6673,  298],
        [   0, 5775,  292,  ..., 8671, 1339,  642]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Checkpoint saved to exp/gpt2_scratch_neuro_tokenizer_bayes_fwd_mini/checkpoint.0_239, AFTER epoch 0, step 239

rank 0 | epoch 0 | step 240 | batch 240


Running epoch 0, step 240, batch 240
Sampled inputs[:2]: tensor([[   0,   14,  560,  ..., 1248, 1398, 1268],
        [   0, 7432,  287,  ...,   12,  461, 2652]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 240, Loss: 1.1795388460159302
rank: 0, step 240, Loss: 1.1907330751419067
rank: 3, step 240, Loss: 1.2045254707336426
rank: 2, step 240, Loss: 1.1988203525543213




rank 0 | epoch 0 | step 241 | batch 241
rank 2 | epoch 0 | step 241 | batch 241

rank 3 | epoch 0 | step 241 | batch 241


Running epoch 0, step 241, batch 241



Running epoch 0, step 241, batch 241


Running epoch 0, step 241, batch 241
rank 1 | epoch 0 | step 241 | batch 241


Running epoch 0, step 241, batch 241

Sampled inputs[:2]: tensor([[    0,   221,   474,  ..., 10688,  7988, 25842],
        [    0, 14409, 45007,  ...,  1197,   266,   944]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 3615,   16,  ..., 2140, 1098,  352],
        [   0,  300, 4402,  ..., 2013,   13, 6825]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  1626,     5,  ..., 10536,  1763,   292],
        [    0,   271,   266,  ..., 46357, 11101, 10621]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[   0,   13,  786,  ...,  275, 2623,   13],
        [   0, 1590, 2140,  ...,  287, 5342, 1319]], device='cuda:0')



Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 241, Loss: 1.1793574094772339
rank: 3, step 241, Loss: 1.2034528255462646


rank: 2, step 241, Loss: 1.209808349609375
rank: 0, step 241, Loss: 1.206583023071289


rank 2 | epoch 0 | step 242 | batch 242

rank 3 | epoch 0 | step 242 | batch 242


Running epoch 0, step 242, batch 242

rank 0 | epoch 0 | step 242 | batch 242

Running epoch 0, step 242, batch 242

rank 1 | epoch 0 | step 242 | batch 242



Running epoch 0, step 242, batch 242


Running epoch 0, step 242, batch 242
Sampled inputs[:2]: tensor([[   0,  685, 2461,  ...,  287,  298, 7943],
        [   0,  546,  360,  ...,   12,  461, 8753]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    20,     9,  ...,    12,  2212, 24950],
        [    0,   677,  9606,  ...,  9468,  9268,   328]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,    14, 15670,  ...,  2027,   417,   199],
        [    0,   391,  1761,  ...,   346,    14,   292]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13, 37178,  ...,  1692,  3287, 10652],
        [    0,   287, 14752,  ...,   910, 26097,  1477]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 242, Loss: 1.1783949136734009
rank: 1, step 242, Loss: 1.1891660690307617
rank: 2, step 242, Loss: 1.1969835758209229
rank: 0, step 242, Loss: 1.2191948890686035




rank 0 | epoch 0 | step 243 | batch 243
rank 2 | epoch 0 | step 243 | batch 243

rank 3 | epoch 0 | step 243 | batch 243


Running epoch 0, step 243, batch 243



Running epoch 0, step 243, batch 243


Running epoch 0, step 243, batch 243
rank 1 | epoch 0 | step 243 | batch 243



Running epoch 0, step 243, batch 243
Sampled inputs[:2]: tensor([[    0,   898,   266,  ...,    12,  3222,  8095],
        [    0, 14700,   717,  ..., 10570,   292,   221]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   266,  1586,  ...,  1888,  2117,   328],
        [    0,   266,  2555,  ...,   587,    14, 14947]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   600,  9092,  ...,   554,  1485,   328],
        [    0, 14867,   278,  ...,   674,   369,  4127]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   266,  4287,  ...,   367,  4428,  2118],
        [    0,    13, 20054,  ...,    19,     9,   266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 243, Loss: 1.1751166582107544
rank: 1, step 243, Loss: 1.175208568572998
rank: 0, step 243, Loss: 1.1986058950424194
rank: 2, step 243, Loss: 1.1760903596878052




rank 2 | epoch 0 | step 244 | batch 244
rank 3 | epoch 0 | step 244 | batch 244


rank 0 | epoch 0 | step 244 | batch 244

Running epoch 0, step 244, batch 244

Running epoch 0, step 244, batch 244


rank 1 | epoch 0 | step 244 | batch 244



Running epoch 0, step 244, batch 244


Running epoch 0, step 244, batch 244
Sampled inputs[:2]: tensor([[   0, 2088, 5370,  ..., 1110, 3380,   12],
        [   0,  709,  630,  ..., 6263,  409,  508]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   292, 12522,  ...,   266,  1977,  8481],
        [    0, 21325, 16967,  ...,  5895,   344,   513]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   271, 10474,  ...,   298,  2286,    29],
        [    0,  1746,    14,  ...,  3134,  5968,     9]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0, 1760,  446,  ...,  329, 1405,  422],
        [   0,  266, 1553,  ..., 8954,   21,  409]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 244, Loss: 1.1893929243087769
rank: 1, step 244, Loss: 1.1952234506607056

rank: 2, step 244, Loss: 1.1866027116775513
rank: 0, step 244, Loss: 1.196407437324524



rank 2 | epoch 0 | step 245 | batch 245
rank 3 | epoch 0 | step 245 | batch 245


rank 0 | epoch 0 | step 245 | batch 245

Running epoch 0, step 245, batch 245

Running epoch 0, step 245, batch 245



rank 1 | epoch 0 | step 245 | batch 245


Running epoch 0, step 245, batch 245

Running epoch 0, step 245, batch 245

Sampled inputs[:2]: tensor([[   0,  342,  970,  ...,  401, 2907, 1657],
        [   0,  944,  278,  ..., 5755,  292,  221]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1064,  266,  ..., 2971,  292,  474],
        [   0,  275, 2351,  ...,   14, 4520,   12]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  3408,   300,  ...,    14,  5870,    12],
        [    0,  1196,  3570,  ...,   722, 15816,   287]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  352,  644,  ..., 2928,  590, 3040],
        [   0, 2645,   12,  ...,    5, 1239, 7200]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 245, Loss: 1.1906569004058838
rank: 1, step 245, Loss: 1.1842849254608154
rank: 2, step 245, Loss: 1.1949305534362793
rank: 0, step 245, Loss: 1.191429615020752




rank 3 | epoch 0 | step 246 | batch 246
rank 2 | epoch 0 | step 246 | batch 246



Running epoch 0, step 246, batch 246

Running epoch 0, step 246, batch 246


rank 0 | epoch 0 | step 246 | batch 246
rank 1 | epoch 0 | step 246 | batch 246


Running epoch 0, step 246, batch 246



Running epoch 0, step 246, batch 246
Sampled inputs[:2]: tensor([[    0,  3504,     9,  ...,  7166, 10945,  3119],
        [    0,   368,  2418,  ...,  3275,  1116,  5189]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    14,    28,  ..., 16032,   694,  1441],
        [    0,  2320,    63,  ...,   858,    13, 40170]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 11325,   278,  ...,   446,  1869,   642],
        [    0,   287,  9430,  ...,  3121,   352,   360]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  2018,  4798,  ...,   292,  1919,   221],
        [    0,   298, 49038,  ...,   288,  1690,  2736]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 246, Loss: 1.2075358629226685
rank: 2, step 246, Loss: 1.187117338180542
rank: 1, step 246, Loss: 1.2042992115020752
rank: 0, step 246, Loss: 1.192726969718933




rank 0 | epoch 0 | step 247 | batch 247
rank 3 | epoch 0 | step 247 | batch 247
rank 2 | epoch 0 | step 247 | batch 247




Running epoch 0, step 247, batch 247

Running epoch 0, step 247, batch 247



Running epoch 0, step 247, batch 247
rank 1 | epoch 0 | step 247 | batch 247



Running epoch 0, step 247, batch 247
Sampled inputs[:2]: tensor([[    0,  2911,   287,  ...,  2178, 22788,  8645],
        [    0,   578, 26976,  ...,  1389,    14,  1742]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  7264, 14450,  ...,   367,   654,   300],
        [    0, 21748,   792,  ...,   408,   266, 31879]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  292, 1820,  ...,  591, 6619, 1607],
        [   0,   18,   66,  ...,   65,   17,  287]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   280,  5656,  ...,  7369,  2276,    12],
        [    0,  7240,   365,  ...,   630,   491, 10524]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank: 3, step 247, Loss: 1.2097753286361694
rank: 1, step 247, Loss: 1.2028610706329346
rank: 2, step 247, Loss: 1.1858642101287842
rank: 0, step 247, Loss: 1.2083615064620972



Graident accumulation at epoch 0, step 247, batch 247Graident accumulation at epoch 0, step 247, batch 247

Graident accumulation at epoch 0, step 247, batch 247
Graident accumulation at epoch 0, step 247, batch 247

rank 2 | epoch 0 | step 248 | batch 248

rank 3 | epoch 0 | step 248 | batch 248


Running epoch 0, step 248, batch 248


Running epoch 0, step 248, batch 248

rank 1 | epoch 0 | step 248 | batch 248


Running epoch 0, step 248, batch 248

rank 0 | epoch 0 | step 248 | batch 248Sampled inputs[:2]: tensor([[    0,   271,  8130,  ...,   609, 28676,   965],
        [    0,  2793,   271,  ...,   374,   298,   527]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  287, 2421,  ..., 6612,  352,  344],
        [   0, 1921,  843,  ..., 9420,  352,  266]], device='cuda:3')


Running epoch 0, step 248, batch 248
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    19,     9,  ...,  4971,   367,  1675],
        [    0,   367,  2870,  ...,  1456, 17304,   292]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   747,  7890,  ...,   706,  8667,   271],
        [    0, 13649,  7841,  ...,   287,  4713,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 248, Loss: 1.1824584007263184
rank: 1, step 248, Loss: 1.2010339498519897
rank: 2, step 248, Loss: 1.1886330842971802
rank: 0, step 248, Loss: 1.1818839311599731




rank 2 | epoch 0 | step 249 | batch 249
rank 3 | epoch 0 | step 249 | batch 249



Running epoch 0, step 249, batch 249

Running epoch 0, step 249, batch 249


rank 1 | epoch 0 | step 249 | batch 249

rank 0 | epoch 0 | step 249 | batch 249

Running epoch 0, step 249, batch 249



Running epoch 0, step 249, batch 249
Sampled inputs[:2]: tensor([[    0,  4599,  9005,  ...,   809,    13,  1875],
        [    0,   775,   721,  ...,  5650,   518, 11548]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 38495, 36253,  ..., 11006,  5699,    19],
        [    0,   259,  5112,  ...,  3520,   278,   298]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,    73,    30,  ...,  4112,    12,  9416],
        [    0, 15003, 19278,  ...,   287,   847,   328]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Sampled inputs[:2]: tensor([[    0,   259,  2122,  ...,   554,   392, 10814],
        [    0,  1062,   648,  ...,   266,  4939,   278]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 249, Loss: 1.1965606212615967
rank: 1, step 249, Loss: 1.1911685466766357
rank: 2, step 249, Loss: 1.1890244483947754
rank: 0, step 249, Loss: 1.1828826665878296




rank 0 | epoch 0 | step 250 | batch 250
rank 2 | epoch 0 | step 250 | batch 250
rank 3 | epoch 0 | step 250 | batch 250




Running epoch 0, step 250, batch 250

Running epoch 0, step 250, batch 250



Running epoch 0, step 250, batch 250
rank 1 | epoch 0 | step 250 | batch 250



Running epoch 0, step 250, batch 250
Sampled inputs[:2]: tensor([[    0, 15666,   609,  ...,   527,  4486,     9],
        [    0,   292,    46,  ...,  1217,    17,   292]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   365,  2714,  ...,   298,   273,   298],
        [    0, 28684,   472,  ...,   317,     9,  1926]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   555,   764,  ...,   932,   709, 18731],
        [    0,  1760,     9,  ...,   278,  6607,    13]], device='cuda:0')Sampled inputs[:2]: tensor([[   0,  221,  380,  ..., 1590,  997, 2239],
        [   0,   13, 4596,  ...,  408,  689,  298]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 250, Loss: 1.1904981136322021
rank: 1, step 250, Loss: 1.1940290927886963
rank: 2, step 250, Loss: 1.1938011646270752
rank: 0, step 250, Loss: 1.176608681678772




rank 2 | epoch 0 | step 251 | batch 251
rank 3 | epoch 0 | step 251 | batch 251



Running epoch 0, step 251, batch 251

Running epoch 0, step 251, batch 251


rank 0 | epoch 0 | step 251 | batch 251
rank 1 | epoch 0 | step 251 | batch 251


Running epoch 0, step 251, batch 251



Running epoch 0, step 251, batch 251
Sampled inputs[:2]: tensor([[   0,  266,  997,  ..., 2670,    5,  278],
        [   0, 1238,   14,  ...,  368,  940,  437]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   266,  1194,  ...,  2267,    15,  1224],
        [    0, 18717,  2837,  ...,    48,    18,   292]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  2270,   278,  ..., 36325,  5892,  3558],
        [    0,    34,  3881,  ...,  1027,   271,   266]], device='cuda:1')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   266, 11080,  ...,   413,  7308,   413],
        [    0,  2834, 25800,  ...,    12,   367,  2870]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 251, Loss: 1.1906912326812744
rank: 3, step 251, Loss: 1.2165279388427734
rank: 0, step 251, Loss: 1.2044050693511963
rank: 2, step 251, Loss: 1.1950575113296509




rank 0 | epoch 0 | step 252 | batch 252

rank 2 | epoch 0 | step 252 | batch 252
rank 3 | epoch 0 | step 252 | batch 252



Running epoch 0, step 252, batch 252

Running epoch 0, step 252, batch 252

Running epoch 0, step 252, batch 252
rank 1 | epoch 0 | step 252 | batch 252





Running epoch 0, step 252, batch 252
Sampled inputs[:2]: tensor([[    0,    14,  3228,  ..., 13747,   287, 20295],
        [    0,  4868,  1027,  ...,   409,  3047,  2953]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  437,  266,  ..., 5512,  822,   89],
        [   0, 1412,   35,  ..., 6077,  298, 1826]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1894,   317,  ...,  9920,    13, 19888],
        [    0,   287, 21212,  ...,  3123,   944,   278]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,    14,  3741,  ...,   278, 12472, 10257],
        [    0,    12,   638,  ...,   374,   221,   527]], device='cuda:0')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 252, Loss: 1.1800168752670288
rank: 1, step 252, Loss: 1.1990469694137573
rank: 2, step 252, Loss: 1.1949716806411743
rank: 0, step 252, Loss: 1.184518814086914




rank 0 | epoch 0 | step 253 | batch 253
rank 3 | epoch 0 | step 253 | batch 253

rank 2 | epoch 0 | step 253 | batch 253


Running epoch 0, step 253, batch 253



Running epoch 0, step 253, batch 253


Running epoch 0, step 253, batch 253
rank 1 | epoch 0 | step 253 | batch 253



Running epoch 0, step 253, batch 253
Sampled inputs[:2]: tensor([[    0,    14, 21687,  ...,   943,  2153,  4089],
        [    0,   677,  8708,  ..., 19891,   267,   287]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   397,  1267,  ...,  1276,   292,   221],
        [    0,     9,   287,  ..., 14761,  9700,   298]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  1934,  2413,  ..., 19697,    13, 16325],
        [    0, 15931,    14,  ...,  2645,   699,   266]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  7011,   650,  ..., 28839, 11610,  3222],
        [    0,   759,  1128,  ...,   221,   474,   221]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 253, Loss: 1.183408260345459
rank: 3, step 253, Loss: 1.2031538486480713
rank: 1, step 253, Loss: 1.188665509223938
rank: 0, step 253, Loss: 1.1912647485733032




rank 2 | epoch 0 | step 254 | batch 254
rank 3 | epoch 0 | step 254 | batch 254



Running epoch 0, step 254, batch 254

Running epoch 0, step 254, batch 254


rank 0 | epoch 0 | step 254 | batch 254
rank 1 | epoch 0 | step 254 | batch 254


Running epoch 0, step 254, batch 254



Running epoch 0, step 254, batch 254
Sampled inputs[:2]: tensor([[    0,   491, 10524,  ...,  2218,  5627,  4199],
        [    0,   843, 17111,  ...,    12,   461,  6176]], device='cuda:2')Sampled inputs[:2]: tensor([[   0,  437, 1916,  ...,   13, 1303, 2708],
        [   0,  642,  271,  ..., 5430, 2314, 6431]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  266, 2086,  ..., 4283,  720,   14],
        [   0, 4209,  278,  ...,  287, 9971,  717]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,  1456, 32380,  ...,    12,  1172, 12557],
        [    0,  4263,  4865,  ...,  1878,   278,  4450]], device='cuda:0')

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 254, Loss: 1.184714674949646
rank: 1, step 254, Loss: 1.1861141920089722
rank: 2, step 254, Loss: 1.2006566524505615
rank: 0, step 254, Loss: 1.1899242401123047




rank 3 | epoch 0 | step 255 | batch 255
rank 2 | epoch 0 | step 255 | batch 255


rank 0 | epoch 0 | step 255 | batch 255

Running epoch 0, step 255, batch 255

Running epoch 0, step 255, batch 255



rank 1 | epoch 0 | step 255 | batch 255


Running epoch 0, step 255, batch 255


Running epoch 0, step 255, batch 255
Sampled inputs[:2]: tensor([[    0,  1340,  1049,  ...,  1441,  1211,  4165],
        [    0, 13576,   431,  ...,    14,   475,   298]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  4092,  3517,  ..., 23070,    14,   475],
        [    0,  2286,  1085,  ...,  1387,  1184,  1802]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   278,   264,  ..., 21836,   344,   259],
        [    0,   352,   927,  ...,  1521,  3513,   292]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  8920, 24095,  ...,   278,  2025,   437],
        [    0,   341,  2802,  ...,  1798,    12,   266]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 255, Loss: 1.1810475587844849
rank: 2, step 255, Loss: 1.197568655014038
rank: 1, step 255, Loss: 1.1872223615646362
rank: 0, step 255, Loss: 1.180721402168274



Graident accumulation at epoch 0, step 255, batch 255Graident accumulation at epoch 0, step 255, batch 255

Graident accumulation at epoch 0, step 255, batch 255Graident accumulation at epoch 0, step 255, batch 255


rank 0 | epoch 0 | step 256 | batch 256

rank 2 | epoch 0 | step 256 | batch 256

rank 3 | epoch 0 | step 256 | batch 256

Running epoch 0, step 256, batch 256

Running epoch 0, step 256, batch 256



Running epoch 0, step 256, batch 256


rank 1 | epoch 0 | step 256 | batch 256


Running epoch 0, step 256, batch 256
Sampled inputs[:2]: tensor([[    0, 26138,    17,  ...,   401,  1867,  4977],
        [    0, 49570,   644,  ...,   461,   800,   266]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,   14,   23,  ...,  278,  266, 1462],
        [   0, 1304,  292,  ..., 2101,  292,  474]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,   968,   266,  ...,   287,  2143, 15228],
        [    0, 10893, 10997,  ...,   367,   616,  7903]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3665,  1419,  ...,   600,   847,   328],
        [    0,  1855,    14,  ...,    12,   287, 16479]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 256, Loss: 1.1799201965332031
rank: 2, step 256, Loss: 1.1986440420150757
rank: 3, step 256, Loss: 1.1796839237213135
rank: 0, step 256, Loss: 1.2011064291000366




rank 0 | epoch 0 | step 257 | batch 257

rank 2 | epoch 0 | step 257 | batch 257

rank 3 | epoch 0 | step 257 | batch 257


Running epoch 0, step 257, batch 257

Running epoch 0, step 257, batch 257


Running epoch 0, step 257, batch 257


rank 1 | epoch 0 | step 257 | batch 257


Running epoch 0, step 257, batch 257
Sampled inputs[:2]: tensor([[    0, 11348,   292,  ...,  3904,  1110,  8079],
        [    0,  2771,    13,  ...,  1412,    35,    15]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   593,  1387,  ...,   508,  8222,  1415],
        [    0,  2629, 13422,  ...,  1042,  5301,    12]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   12,  287,  ...,   17,  271,  266],
        [   0, 8754,   14,  ..., 6125,  394,  927]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    15,    72,  ...,   380, 22463,  2587],
        [    0,  2588, 25531,  ...,  1977,   300,   259]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 257, Loss: 1.1848053932189941
rank: 1, step 257, Loss: 1.1932119131088257
rank: 2, step 257, Loss: 1.1943976879119873
rank: 0, step 257, Loss: 1.187542200088501




rank 0 | epoch 0 | step 258 | batch 258

rank 2 | epoch 0 | step 258 | batch 258
rank 3 | epoch 0 | step 258 | batch 258



Running epoch 0, step 258, batch 258

Running epoch 0, step 258, batch 258

Running epoch 0, step 258, batch 258



rank 1 | epoch 0 | step 258 | batch 258


Running epoch 0, step 258, batch 258
Sampled inputs[:2]: tensor([[    0,  9017,   600,  ...,  6133,  1098,   352],
        [    0,  8405,  4142,  ..., 18796,     9,   699]], device='cuda:2')Sampled inputs[:2]: tensor([[    0, 12919,   292,  ...,   221,   273,   298],
        [    0,  2950,    13,  ..., 16513,   300,  2205]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  3502,   527,  ..., 21301, 22248,  1773],
        [    0,   346,   462,  ..., 35247,  2547,   278]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,  1451, 14349,  ...,   741,  2945,  7257],
        [    0,   292, 21050,  ...,  4142, 23314,  1027]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 258, Loss: 1.192260503768921
rank: 1, step 258, Loss: 1.176507830619812
rank: 2, step 258, Loss: 1.1933438777923584



rank: 0, step 258, Loss: 1.187360167503357

rank 0 | epoch 0 | step 259 | batch 259

rank 2 | epoch 0 | step 259 | batch 259
rank 3 | epoch 0 | step 259 | batch 259



Running epoch 0, step 259, batch 259

Running epoch 0, step 259, batch 259



Running epoch 0, step 259, batch 259
rank 1 | epoch 0 | step 259 | batch 259



Running epoch 0, step 259, batch 259
Sampled inputs[:2]: tensor([[    0,  2099,  1718,  ..., 11271,   287,   300],
        [    0,   287,  2926,  ...,   266, 40854,   287]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  3889,  4039,  ...,   616, 22910,   259],
        [    0,   365,  5392,  ...,    14,   333,   199]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  4100,    12,  ...,    13,  4710,  1558],
        [    0,   437,  1119,  ..., 32831,    83,   623]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,    13,  2549,  ...,   221,   382,   298],
        [    0,   870,   278,  ...,  1274, 10112,  3269]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 259, Loss: 1.1889235973358154
rank: 1, step 259, Loss: 1.1976652145385742
rank: 0, step 259, Loss: 1.19907808303833
rank: 2, step 259, Loss: 1.190116286277771




rank 2 | epoch 0 | step 260 | batch 260

rank 3 | epoch 0 | step 260 | batch 260


Running epoch 0, step 260, batch 260

Running epoch 0, step 260, batch 260


rank 0 | epoch 0 | step 260 | batch 260
rank 1 | epoch 0 | step 260 | batch 260



Running epoch 0, step 260, batch 260


Running epoch 0, step 260, batch 260
Sampled inputs[:2]: tensor([[   0,  965,  300,  ...,  546,  857, 4350],
        [   0,  472,  346,  ..., 9161,  300, 4460]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   328,  6379,  ...,   287,  1342,     9],
        [    0,    14,   747,  ..., 12545,    12, 15209]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  607,  259,  ...,  995,   13, 6507],
        [   0, 4852,  266,  ..., 2523, 2080, 2632]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0, 18905,  2311,  ..., 10213,   908,   694],
        [    0,   328,  9424,  ...,    13, 24635,   368]], device='cuda:0')Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 260, Loss: 1.1833887100219727
rank: 1, step 260, Loss: 1.1768766641616821
rank: 0, step 260, Loss: 1.20032799243927
rank: 2, step 260, Loss: 1.1871626377105713




rank 3 | epoch 0 | step 261 | batch 261
rank 2 | epoch 0 | step 261 | batch 261



Running epoch 0, step 261, batch 261

Running epoch 0, step 261, batch 261


rank 0 | epoch 0 | step 261 | batch 261
rank 1 | epoch 0 | step 261 | batch 261



Running epoch 0, step 261, batch 261


Running epoch 0, step 261, batch 261
Sampled inputs[:2]: tensor([[    0, 31309,    83,  ...,  2923,   391,   266],
        [    0,   278,  5492,  ...,   328,   995,    13]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1005,   292,  ...,   266, 19171,  2474],
        [    0,  7303,    12,  ...,  1085,   413,   711]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   352,   266,  ...,   490, 10112,  3804],
        [    0,  3261,  5866,  ...,   593,   360,  2502]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   14, 8383,  ...,  266, 1717,   13],
        [   0,   13, 1311,  ...,  271,  795,  957]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 107, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 261, Loss: 1.1831493377685547
rank: 1, step 261, Loss: 1.1942404508590698
rank: 2, step 261, Loss: 1.1992928981781006
rank: 0, step 261, Loss: 1.1878949403762817



End of epoch 0 | Validation PPL: 13620.15803592643 | Learning rate: 2.7493314223681067e-08
[2025-03-28 14:21:20,303] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
End of epoch checkpoint saved to exp/gpt2_scratch_neuro_tokenizer_bayes_fwd_mini/end_of_epoch_checkpoint.0, AFTER epoch 0
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.012 MB of 0.012 MB uploaded (0.000 MB deduped)wandb: \ 0.012 MB of 0.191 MB uploaded (0.000 MB deduped)wandb: | 0.012 MB of 0.191 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:          Batch ‚ñÅ‚ñÅ‚ñÖ‚ñÖ‚ñà‚ñà
wandb:   End of epoch ‚ñÅ
wandb:          Epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:  Learning Rate ‚ñà‚ñà‚ñÑ‚ñÑ‚ñÅ‚ñÅ‚ñÅ
wandb:   Training PPL ‚ñà‚ñÅ‚ñÑ
wandb: Validation PPL ‚ñà‚ñÉ‚ñÅ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          Batch 239
wandb:   End of epoch 0
wandb:          Epoch 0
wandb:  Learning Rate 0.0
wandb:   Training PPL 15456.8751
wandb: Validation PPL 13620.15804
wandb: 
wandb: üöÄ View run soft-valley-339 at: https://wandb.ai/kenotron/brainlessgpt/runs/cj2japi4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250328_142040-cj2japi4/logs
