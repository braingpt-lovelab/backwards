nohup: ignoring input
4
4
4
4
Starting fresh run with new ID: p9p7llg2 (ignoring existing wandb_run_id.txt)

rank: 2
Load custom tokenizer from cache/gpt2_neuro_tokenizer

rank: 3

rank: 1
Load custom tokenizer from cache/gpt2_neuro_tokenizer
Load custom tokenizer from cache/gpt2_neuro_tokenizer
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
wandb: Currently logged in as: kenotron. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.19.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.2
wandb: Run data is saved locally in /datadrive1/ken/projects/backwards/model_training/wandb/run-20250326_150128-p9p7llg2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-sound-328
wandb: ‚≠êÔ∏è View project at https://wandb.ai/kenotron/brainlessgpt
wandb: üöÄ View run at https://wandb.ai/kenotron/brainlessgpt/runs/p9p7llg2

rank: 0
Load custom tokenizer from cache/gpt2_neuro_tokenizer
{'train': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 2095
}), 'validation': Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 476
})}
Loading 2095 samples for training
Loading 476 samples for validation
Train from scratch
Start training
Start training
Start training
Start training

rank 0 | epoch 0 | step 0 | batch 0

rank 1 | epoch 0 | step 0 | batch 0

rank 2 | epoch 0 | step 0 | batch 0


Running epoch 0, step 0, batch 0

Running epoch 0, step 0, batch 0


Running epoch 0, step 0, batch 0


rank 3 | epoch 0 | step 0 | batch 0


Running epoch 0, step 0, batch 0
Sampled inputs[:2]: tensor([[   0, 7555, 3908,  ...,  259, 8477,  278],
        [   0,  623,   12,  ..., 4792, 6572,  300]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  825, 1243,  ...,   15,   22,   42],
        [   0,  669,  292,  ..., 4032,  271, 4442]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  7303,    12,  ...,  1085,   413,   711],
        [    0, 27342,    17,  ...,  5125,  3244,   287]], device='cuda:0')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,    30,  1869,  ...,  4998, 44266,    12],
        [    0,   669,  1528,  ..., 21826,   259,  5024]], device='cuda:3')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 0, Loss: 1.3736037015914917
rank: 3, step 0, Loss: 1.374083161354065
rank: 2, step 0, Loss: 1.3782353401184082
rank: 0, step 0, Loss: 1.3781282901763916




rank 3 | epoch 0 | step 1 | batch 1


Running epoch 0, step 1, batch 1

rank 2 | epoch 0 | step 1 | batch 1


Running epoch 0, step 1, batch 1

rank 1 | epoch 0 | step 1 | batch 1


Running epoch 0, step 1, batch 1

rank 0 | epoch 0 | step 1 | batch 1
Sampled inputs[:2]: tensor([[    0,  2270,  3279,  ...,   380,   475,   768],
        [    0,   344,  8260,  ..., 16020, 18216, 11348]], device='cuda:3')


Running epoch 0, step 1, batch 1
Sampled inputs[:2]: tensor([[    0,    14,  7870,  ...,   284,   830,   292],
        [    0,  4356, 12286,  ...,  3352,   275,  2879]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   301,   298,  ..., 10030,   300,  3780],
        [    0, 29073,   916,  ...,    12,   287,   850]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,  3235,   471,  ...,  1967,  4273,  2738],
        [    0,  2165,  9311,  ..., 10570,   437,   266]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 1, Loss: 1.3752291202545166
rank: 2, step 1, Loss: 1.376225233078003
rank: 3, step 1, Loss: 1.3743900060653687


rank: 1, step 1, Loss: 1.3754276037216187


rank 2 | epoch 0 | step 2 | batch 2

rank 3 | epoch 0 | step 2 | batch 2

Running epoch 0, step 2, batch 2



Running epoch 0, step 2, batch 2

rank 0 | epoch 0 | step 2 | batch 2
rank 1 | epoch 0 | step 2 | batch 2


Running epoch 0, step 2, batch 2



Running epoch 0, step 2, batch 2
Sampled inputs[:2]: tensor([[   0,  259, 1143,  ...,  593,  360,  278],
        [   0,  300, 7239,  ..., 2283, 4890,   14]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   266,  5528,  ...,   685,   266,  1231],
        [    0,  2561,  4994,  ..., 10407,   287,  1339]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   374,  5195,  ...,   266,  5555,    14],
        [    0,   344,   259,  ...,  6787, 10045,  9799]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,  2372,  1319,  ...,  1253,   292, 34166],
        [    0,   437,   266,  ...,   266, 16084,  1781]], device='cuda:0')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 2, Loss: 1.3781237602233887
rank: 2, step 2, Loss: 1.3756003379821777
rank: 1, step 2, Loss: 1.3806228637695312

rank: 3, step 2, Loss: 1.3780685663223267



rank 2 | epoch 0 | step 3 | batch 3


Running epoch 0, step 3, batch 3

rank 3 | epoch 0 | step 3 | batch 3

rank 1 | epoch 0 | step 3 | batch 3


Running epoch 0, step 3, batch 3


Running epoch 0, step 3, batch 3

rank 0 | epoch 0 | step 3 | batch 3
Sampled inputs[:2]: tensor([[    0,  4667,   446,  ...,  1868, 16028,   669],
        [    0,  1943,  1837,  ...,   870,   287,   266]], device='cuda:2')


Running epoch 0, step 3, batch 3
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,   275,  2576,  3588],
        [    0,   221,   474,  ..., 19245,   565,    14]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  298,  374,  ...,  298,  413,   28],
        [   0,  266, 3634,  ...,  694,  266, 1784]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3658,  271,  ...,  278,  970,   12],
        [   0,    5, 7523,  ...,  199, 8871,  266]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 3, Loss: 1.3748332262039185
rank: 1, step 3, Loss: 1.3761365413665771
rank: 2, step 3, Loss: 1.3751813173294067
rank: 0, step 3, Loss: 1.3746083974838257




rank 2 | epoch 0 | step 4 | batch 4

rank 3 | epoch 0 | step 4 | batch 4


Running epoch 0, step 4, batch 4
rank 0 | epoch 0 | step 4 | batch 4


Running epoch 0, step 4, batch 4


rank 1 | epoch 0 | step 4 | batch 4


Running epoch 0, step 4, batch 4


Running epoch 0, step 4, batch 4
Sampled inputs[:2]: tensor([[   0, 3125,  271,  ..., 1041, 1032,   15],
        [   0,  995,   13,  ..., 3494,  367, 6768]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   76,   15,  ...,   14,  333,  199],
        [   0,  367, 3704,  ..., 1746,   14,  759]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   380,   981,  ...,   567,  5407,   472],
        [    0,  6143,   642,  ...,   199, 14300,    41]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    27,  3961,  ...,   462,   221,   474],
        [    0,  1526,   422,  ..., 22454,   409, 31482]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 4, Loss: 1.3764057159423828
rank: 1, step 4, Loss: 1.3808878660202026
rank: 0, step 4, Loss: 1.3779361248016357
rank: 2, step 4, Loss: 1.3760123252868652




rank 3 | epoch 0 | step 5 | batch 5
rank 2 | epoch 0 | step 5 | batch 5



Running epoch 0, step 5, batch 5

Running epoch 0, step 5, batch 5


rank 1 | epoch 0 | step 5 | batch 5

rank 0 | epoch 0 | step 5 | batch 5

Running epoch 0, step 5, batch 5



Running epoch 0, step 5, batch 5
Sampled inputs[:2]: tensor([[   0, 4665,  909,  ..., 3607,  259, 1108],
        [   0, 4385,  342,  ..., 3644,  775,  874]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   843,    14,  ...,   659,   271, 10511],
        [    0,    13, 38195,  ...,   950,   298,   257]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,   89, 2023,  ...,  271,   13,  704],
        [   0,  493,  221,  ...,  259,  726, 2786]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 6328,   12,  ...,  417,  199, 1726],
        [   0,   19,  669,  ...,   14, 4053,  352]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 5, Loss: 1.3793458938598633
rank: 1, step 5, Loss: 1.3767560720443726
rank: 2, step 5, Loss: 1.3729788064956665
rank: 0, step 5, Loss: 1.374396562576294




rank 2 | epoch 0 | step 6 | batch 6
rank 3 | epoch 0 | step 6 | batch 6



Running epoch 0, step 6, batch 6

Running epoch 0, step 6, batch 6


rank 1 | epoch 0 | step 6 | batch 6


Running epoch 0, step 6, batch 6

rank 0 | epoch 0 | step 6 | batch 6


Running epoch 0, step 6, batch 6Sampled inputs[:2]: tensor([[    0,  5489,    80,  ...,   221,   380,   333],
        [    0,  5750,   642,  ...,   221, 15441,   644]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,    9,  292,  ...,  944,  278, 1758],
        [   0,  287,  358,  ...,  328, 1704, 3227]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0,   25,   26,  ...,    9,  287,  298],
        [   0,  278,  634,  ...,  598, 1722,  591]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   328,   957,  ...,   298,   275,  8570],
        [    0,   300, 11040,  ...,   266,  1736,  3487]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 6, Loss: 1.376885175704956
rank: 3, step 6, Loss: 1.3761378526687622
rank: 2, step 6, Loss: 1.3779277801513672
rank: 0, step 6, Loss: 1.376728892326355




rank 2 | epoch 0 | step 7 | batch 7

rank 3 | epoch 0 | step 7 | batch 7


Running epoch 0, step 7, batch 7


Running epoch 0, step 7, batch 7

rank 1 | epoch 0 | step 7 | batch 7


Running epoch 0, step 7, batch 7

rank 0 | epoch 0 | step 7 | batch 7


Running epoch 0, step 7, batch 7
Sampled inputs[:2]: tensor([[    0,   792,    83,  ...,   300,   768,   932],
        [    0,  3412,  1707,  ..., 11114,    15,  1821]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  7036,   278,  ...,   221,   290,   446],
        [    0,   400, 27972,  ..., 22726,  1871,    14]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   970,    13,  ..., 13798,    14,  1841],
        [    0, 41855,     9,  ..., 33073,   401,  4528]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   287,  2269,  ..., 22413,   391,   266],
        [    0,   600,    14,  ...,   221,  8187,  1802]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 7, Loss: 1.3772367238998413
rank: 2, step 7, Loss: 1.3749045133590698
rank: 1, step 7, Loss: 1.3760758638381958
rank: 3, step 7, Loss: 1.3751144409179688



Graident accumulation at epoch 0, step 7, batch 7
Graident accumulation at epoch 0, step 7, batch 7Graident accumulation at epoch 0, step 7, batch 7

Graident accumulation at epoch 0, step 7, batch 7

rank 2 | epoch 0 | step 8 | batch 8


Running epoch 0, step 8, batch 8

rank 3 | epoch 0 | step 8 | batch 8


Running epoch 0, step 8, batch 8

rank 1 | epoch 0 | step 8 | batch 8


Running epoch 0, step 8, batch 8

rank 0 | epoch 0 | step 8 | batch 8


Running epoch 0, step 8, batch 8Sampled inputs[:2]: tensor([[    0,  1615,   328,  ...,   266,  3133,   963],
        [    0,    67,   695,  ...,   437,   266, 44563]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   944,   278,  ...,  2374,   699,  8867],
        [    0, 39224,    34,  ...,   401,  1716,   271]], device='cuda:3')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1412, 11275,  ...,   668, 14849,   367],
        [    0,   257,   298,  ...,  3768,   271,   266]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    12, 32425,  ...,   389,   221,   494],
        [    0, 25938,   359,  ...,    36, 15859,   504]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 8, Loss: 1.3793302774429321
rank: 2, step 8, Loss: 1.3786263465881348
rank: 3, step 8, Loss: 1.387484073638916
rank: 1, step 8, Loss: 1.38116455078125




rank 2 | epoch 0 | step 9 | batch 9


Running epoch 0, step 9, batch 9

rank 1 | epoch 0 | step 9 | batch 9


Running epoch 0, step 9, batch 9

rank 3 | epoch 0 | step 9 | batch 9


Running epoch 0, step 9, batch 9

rank 0 | epoch 0 | step 9 | batch 9


Running epoch 0, step 9, batch 9Sampled inputs[:2]: tensor([[    0,    14,  1032,  ...,   292,   494,  2065],
        [    0,   266, 10262,  ...,   271,  3437,  4392]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,   26, 4044,  ..., 9531,  365,  993],
        [   0, 3968,  446,  ...,   22,  722,  342]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   266,  4908,  ...,  1209,   328,  1603],
        [    0, 10334,    17,  ...,   391,  1566, 24837]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   461,  1169,  ..., 14135,  2771,    13],
        [    0,  2258, 10315,  ...,  4185,  9433,   221]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 9, Loss: 1.379740834236145
rank: 1, step 9, Loss: 1.3736279010772705
rank: 2, step 9, Loss: 1.3813679218292236
rank: 3, step 9, Loss: 1.3747303485870361




rank 2 | epoch 0 | step 10 | batch 10


Running epoch 0, step 10, batch 10

rank 1 | epoch 0 | step 10 | batch 10

rank 3 | epoch 0 | step 10 | batch 10


Running epoch 0, step 10, batch 10


Running epoch 0, step 10, batch 10

rank 0 | epoch 0 | step 10 | batch 10


Running epoch 0, step 10, batch 10Sampled inputs[:2]: tensor([[    0,   278, 30377,  ...,    13,    83,  2908],
        [    0,   367,  3399,  ..., 13481,   408,  6944]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,   12,  342,  ..., 3458,  271,  266],
        [   0,  843, 3365,  ..., 1136, 1615,  292]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0,  278, 7524,  ..., 1288,  669,  352],
        [   0,   12,  298,  ...,  292,   36,    9]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   367,  3675,  ...,    22,  3180,    14],
        [    0, 12686, 18519,  ...,   328,   912,  3978]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 10, Loss: 1.380441427230835
rank: 2, step 10, Loss: 1.3769632577896118
rank: 3, step 10, Loss: 1.3795760869979858
rank: 1, step 10, Loss: 1.3783795833587646




rank 2 | epoch 0 | step 11 | batch 11


Running epoch 0, step 11, batch 11

rank 1 | epoch 0 | step 11 | batch 11


Running epoch 0, step 11, batch 11

rank 3 | epoch 0 | step 11 | batch 11


Running epoch 0, step 11, batch 11

rank 0 | epoch 0 | step 11 | batch 11
Sampled inputs[:2]: tensor([[    0, 14949,    12,  ...,   669, 10168,  7166],
        [    0,  4448,    12,  ...,  3183,   328,  9559]], device='cuda:2')


Running epoch 0, step 11, batch 11
Sampled inputs[:2]: tensor([[    0,   292,    40,  ..., 26995,   278,   717],
        [    0,   271,  3403,  ...,  6168,   300,  2257]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,  417,  199,  ..., 8762, 4204,  391],
        [   0, 3308,  259,  ...,   14, 6349, 1389]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  275, 2101,  ..., 1145,  590, 1619],
        [   0,   13, 4831,  ...,  333,  199, 2038]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 11, Loss: 1.3766958713531494
rank: 0, step 11, Loss: 1.3838766813278198
rank: 3, step 11, Loss: 1.3772679567337036
rank: 1, step 11, Loss: 1.3763172626495361




rank 2 | epoch 0 | step 12 | batch 12


Running epoch 0, step 12, batch 12

rank 3 | epoch 0 | step 12 | batch 12


Running epoch 0, step 12, batch 12

rank 1 | epoch 0 | step 12 | batch 12


Running epoch 0, step 12, batch 12

rank 0 | epoch 0 | step 12 | batch 12
Sampled inputs[:2]: tensor([[   0,  271, 4219,  ...,  644,   14, 3607],
        [   0,  668, 2474,  ...,  668, 4599,  360]], device='cuda:2')


Running epoch 0, step 12, batch 12
Sampled inputs[:2]: tensor([[    0,  1581, 11884,  ...,  7031,   689,   527],
        [    0,    12,  1197,  ...,   352,  2513,   266]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 43788,    12,  ...,    12,  6288,   391],
        [    0,   401,  9370,  ...,     9,   287,   518]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  278, 8608,  ...,  293, 1608,  391],
        [   0, 4154,   12,  ...,   14,  560,  199]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 12, Loss: 1.3787339925765991
rank: 1, step 12, Loss: 1.3772884607315063
rank: 0, step 12, Loss: 1.3775012493133545
rank: 2, step 12, Loss: 1.3769426345825195




rank 2 | epoch 0 | step 13 | batch 13

rank 3 | epoch 0 | step 13 | batch 13


Running epoch 0, step 13, batch 13


Running epoch 0, step 13, batch 13

rank 0 | epoch 0 | step 13 | batch 13
rank 1 | epoch 0 | step 13 | batch 13


Running epoch 0, step 13, batch 13



Running epoch 0, step 13, batch 13
Sampled inputs[:2]: tensor([[   0,  874,  590,  ...,  300,  867,  638],
        [   0,  726, 8241,  ...,  266, 5994,    9]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 31571,    13,  ...,   367,  2177,   271],
        [    0, 21801, 13084,  ...,  1738,  2946,    12]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3448,  278,  ...,  380,  333,  199],
        [   0,  271,  266,  ..., 8122, 1387,  616]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1575,  4384,  ...,   328,   722,  6124],
        [    0, 16028,   669,  ...,   292,  6502,  7050]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 13, Loss: 1.3760402202606201
rank: 3, step 13, Loss: 1.3754429817199707
rank: 0, step 13, Loss: 1.3835172653198242
rank: 2, step 13, Loss: 1.3737101554870605




rank 2 | epoch 0 | step 14 | batch 14

rank 3 | epoch 0 | step 14 | batch 14


Running epoch 0, step 14, batch 14


Running epoch 0, step 14, batch 14

rank 1 | epoch 0 | step 14 | batch 14


Running epoch 0, step 14, batch 14

rank 0 | epoch 0 | step 14 | batch 14
Sampled inputs[:2]: tensor([[    0,    12,   266,  ...,    13,   635,    13],
        [    0,   369, 19287,  ..., 12502,  6626,   292]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 1142,   87,  ..., 2273,  287,  829],
        [   0,  591, 2036,  ...,  266, 1027,  278]], device='cuda:2')



Running epoch 0, step 14, batch 14
Sampled inputs[:2]: tensor([[    0, 20080, 11069,  ...,   300,  5768,   271],
        [    0,  7066,  2737,  ...,  2269,   271,   927]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  445,   16,  ..., 7747, 5308, 6216],
        [   0,   12, 9248,  ..., 2673, 4239,  292]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 14, Loss: 1.3783541917800903
rank: 1, step 14, Loss: 1.3773425817489624
rank: 2, step 14, Loss: 1.3832534551620483
rank: 0, step 14, Loss: 1.3729172945022583




rank 3 | epoch 0 | step 15 | batch 15

rank 2 | epoch 0 | step 15 | batch 15


Running epoch 0, step 15, batch 15


Running epoch 0, step 15, batch 15

rank 1 | epoch 0 | step 15 | batch 15


Running epoch 0, step 15, batch 15

rank 0 | epoch 0 | step 15 | batch 15


Running epoch 0, step 15, batch 15Sampled inputs[:2]: tensor([[    0,  5635,   328,  ...,   287, 27260,   271],
        [    0,   471,   590,  ...,  5007,    13,  2920]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   266, 28695,  ...,   278,   266,  6087],
        [    0,   949, 11135,  ...,   278,   772,    13]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   266, 15794,  ...,  3128,  6479,  2626],
        [    0,   287,   768,  ...,   221,   474,   221]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 4350,   14,  ...,  266, 9479,  944],
        [   0,  360, 2374,  ...,  221,  474,  357]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 15, Loss: 1.3769571781158447
rank: 1, step 15, Loss: 1.3786120414733887
rank: 2, step 15, Loss: 1.3763337135314941

rank: 3, step 15, Loss: 1.3766865730285645


Graident accumulation at epoch 0, step 15, batch 15Graident accumulation at epoch 0, step 15, batch 15

Graident accumulation at epoch 0, step 15, batch 15
Graident accumulation at epoch 0, step 15, batch 15

rank 2 | epoch 0 | step 16 | batch 16


Running epoch 0, step 16, batch 16

rank 3 | epoch 0 | step 16 | batch 16


Running epoch 0, step 16, batch 16

rank 1 | epoch 0 | step 16 | batch 16


Running epoch 0, step 16, batch 16
Sampled inputs[:2]: tensor([[    0,   300,  3808,  ...,   496,    14,  1364],
        [    0,  1420,  2337,  ...,   722, 28860,   287]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    12,   616,  ...,   278,   266,  2907],
        [    0, 22599,  1336,  ...,   729,   923,    13]], device='cuda:3')

rank 0 | epoch 0 | step 16 | batch 16Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   292,  2908,  ..., 16658,  7440,   271],
        [    0,  2426,   699,  ...,   221,  1551,   720]], device='cuda:1')


Running epoch 0, step 16, batch 16
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  4855, 15679,  ...,   278,   266,  1912],
        [    0,   271,   266,  ...,    70,    27,  5311]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 16, Loss: 1.294252634048462
rank: 1, step 16, Loss: 1.2953059673309326

rank: 0, step 16, Loss: 1.3014439344406128
rank: 2, step 16, Loss: 1.3010252714157104



rank 3 | epoch 0 | step 17 | batch 17


Running epoch 0, step 17, batch 17

rank 0 | epoch 0 | step 17 | batch 17
rank 2 | epoch 0 | step 17 | batch 17


rank 1 | epoch 0 | step 17 | batch 17


Running epoch 0, step 17, batch 17


Running epoch 0, step 17, batch 17


Running epoch 0, step 17, batch 17
Sampled inputs[:2]: tensor([[    0,   600,   518,  ...,  3134,   278, 37342],
        [    0,    13,    41,  ...,     5,   271,  2936]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 14165,    14,  ..., 34395, 31103,  6905],
        [    0,   806,   300,  ...,   360,  4918,  1106]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,   401,  1576,   271],
        [    0, 17508,    65,  ...,  8848, 13900,   796]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 2939,   14,  ..., 1702, 1481,  278],
        [   0,  281,   82,  ..., 2485,  417,  199]], device='cuda:0')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 17, Loss: 1.3063682317733765
rank: 3, step 17, Loss: 1.303137183189392
rank: 0, step 17, Loss: 1.2936699390411377

rank: 2, step 17, Loss: 1.3048628568649292



rank 2 | epoch 0 | step 18 | batch 18
rank 3 | epoch 0 | step 18 | batch 18



Running epoch 0, step 18, batch 18

Running epoch 0, step 18, batch 18


rank 1 | epoch 0 | step 18 | batch 18


Running epoch 0, step 18, batch 18

rank 0 | epoch 0 | step 18 | batch 18Sampled inputs[:2]: tensor([[    0,  5685,   565,  ..., 23968,    14,   381],
        [    0,   278,  6653,  ...,  7524,   271, 28279]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 4902,  518,  ..., 5493, 3227,  278],
        [   0, 1850,  311,  ..., 3655, 3133, 9000]], device='cuda:3')


Running epoch 0, step 18, batch 18Sampled inputs[:2]: tensor([[    0,   508,  1548,  ...,   494, 10792,     9],
        [    0,    41,     7,  ...,   496,    14,  4075]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   271, 28279,  ...,   367,   806,   271],
        [    0,   287, 39084,  ...,   266,  1817,  1589]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 18, Loss: 1.299250841140747

rank: 3, step 18, Loss: 1.303252100944519

rank: 1, step 18, Loss: 1.2994877099990845

rank: 0, step 18, Loss: 1.299486517906189

rank 2 | epoch 0 | step 19 | batch 19

rank 3 | epoch 0 | step 19 | batch 19


Running epoch 0, step 19, batch 19


Running epoch 0, step 19, batch 19

rank 1 | epoch 0 | step 19 | batch 19


Running epoch 0, step 19, batch 19
Sampled inputs[:2]: tensor([[    0,    18,    14,  ...,   300,   275,  1184],
        [    0,  2255, 21868,  ...,   591,  5902,   259]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  2706,   292,  ...,    13,  8954,    13],
        [    0,   668,  1837,  ...,  4381,    14, 11451]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   199,   769,  ...,   380,   560,   199],
        [    0,   380,  6119,  ..., 11823,   287,  6797]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 19 | batch 19Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



Running epoch 0, step 19, batch 19
Sampled inputs[:2]: tensor([[   0, 3634, 3444,  ...,  642, 2156,  266],
        [   0,   13, 5005,  ...,  654,  344,  259]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 19, Loss: 1.297405481338501
rank: 1, step 19, Loss: 1.3100793361663818
rank: 0, step 19, Loss: 1.2961900234222412
rank: 2, step 19, Loss: 1.298571228981018




rank 2 | epoch 0 | step 20 | batch 20
rank 3 | epoch 0 | step 20 | batch 20



Running epoch 0, step 20, batch 20

Running epoch 0, step 20, batch 20


rank 1 | epoch 0 | step 20 | batch 20


Running epoch 0, step 20, batch 20

rank 0 | epoch 0 | step 20 | batch 20
Sampled inputs[:2]: tensor([[    0,  3398,   271,  ...,    13,  1581, 13600],
        [    0,    12,  3367,  ..., 16917, 12221, 12138]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    14,    22,  ...,  1319,   271,   266],
        [    0, 26473,  2117,  ...,    13,  3292,   950]], device='cuda:3')


Running epoch 0, step 20, batch 20
Sampled inputs[:2]: tensor([[    0,  1552,   271,  ...,    13,   287,   995],
        [    0,   365,   984,  ..., 18562,  4237, 31813]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  824,   14,  ...,  278, 9328, 1049],
        [   0, 2220, 1110,  ...,  382,   18,   13]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 20, Loss: 1.2980389595031738
rank: 1, step 20, Loss: 1.2979135513305664
rank: 0, step 20, Loss: 1.2953718900680542
rank: 2, step 20, Loss: 1.2957450151443481




rank 2 | epoch 0 | step 21 | batch 21


Running epoch 0, step 21, batch 21

rank 3 | epoch 0 | step 21 | batch 21


Running epoch 0, step 21, batch 21

rank 1 | epoch 0 | step 21 | batch 21


Running epoch 0, step 21, batch 21

rank 0 | epoch 0 | step 21 | batch 21
Sampled inputs[:2]: tensor([[    0,    20, 13016,  ...,    14,  2743,   516],
        [    0,  2771,  2070,  ...,   221,   396,   298]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   935,   508,  ...,   287, 41582,    12],
        [    0,   642,   287,  ...,   800,    12,  3338]], device='cuda:3')


Running epoch 0, step 21, batch 21
Sampled inputs[:2]: tensor([[   0, 1176,   13,  ..., 1919,  221,  380],
        [   0, 2579,  278,  ...,   56,    9,  271]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   298,   894,  ...,   396,   298,   527],
        [    0,   298, 22296,  ...,   287,  6494,   644]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 21, Loss: 1.3016892671585083
rank: 1, step 21, Loss: 1.2824900150299072
rank: 0, step 21, Loss: 1.2924764156341553
rank: 2, step 21, Loss: 1.2992446422576904




rank 2 | epoch 0 | step 22 | batch 22


Running epoch 0, step 22, batch 22

rank 3 | epoch 0 | step 22 | batch 22


Running epoch 0, step 22, batch 22

rank 1 | epoch 0 | step 22 | batch 22


Running epoch 0, step 22, batch 22

rank 0 | epoch 0 | step 22 | batch 22Sampled inputs[:2]: tensor([[   0, 3353,   17,  ...,  596,   12,  461],
        [   0, 1823,   12,  ..., 1874,  271,  266]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 3087,  342,  ...,   14,  381, 1416],
        [   0,   45, 6556,  ..., 1477,  352, 1611]], device='cuda:3')


Running epoch 0, step 22, batch 22
Sampled inputs[:2]: tensor([[   0,  496,   14,  ..., 1034, 4679,  278],
        [   0,  401,  266,  ...,  266, 2236, 1458]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   259,  1380,  ...,   287, 10221,   280],
        [    0,   278,  1295,  ...,  4337,   271,  1268]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 22, Loss: 1.300816297531128
rank: 0, step 22, Loss: 1.2960176467895508
rank: 3, step 22, Loss: 1.3008161783218384
rank: 1, step 22, Loss: 1.2977919578552246




rank 3 | epoch 0 | step 23 | batch 23

rank 2 | epoch 0 | step 23 | batch 23


Running epoch 0, step 23, batch 23


Running epoch 0, step 23, batch 23

rank 1 | epoch 0 | step 23 | batch 23


Running epoch 0, step 23, batch 23

rank 0 | epoch 0 | step 23 | batch 23


Running epoch 0, step 23, batch 23Sampled inputs[:2]: tensor([[    0,  1526,  3502,  ..., 11727,  3736,  1661],
        [    0,   515,   266,  ...,    18,  3770,  1345]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 12305,  1179,  ...,  6321,   600,   271],
        [    0,   292, 21215,  ...,   266,   818,  1527]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   609,   271,  ...,   287, 15506, 14476],
        [    0,  1356,   634,  ...,  6604,   634,    14]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1920,   19,  ..., 5232,  796, 1303],
        [   0, 1500,  367,  ...,  344, 4250,  287]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 23, Loss: 1.2861326932907104
rank: 3, step 23, Loss: 1.2980128526687622
rank: 0, step 23, Loss: 1.2988290786743164

rank: 2, step 23, Loss: 1.2996304035186768


Graident accumulation at epoch 0, step 23, batch 23
Graident accumulation at epoch 0, step 23, batch 23
Graident accumulation at epoch 0, step 23, batch 23
Graident accumulation at epoch 0, step 23, batch 23

rank 3 | epoch 0 | step 24 | batch 24


Running epoch 0, step 24, batch 24

rank 2 | epoch 0 | step 24 | batch 24


Running epoch 0, step 24, batch 24
Sampled inputs[:2]: tensor([[   0, 4215, 1478,  ...,  644,  409, 3803],
        [   0,   12, 3067,  ..., 1381,  278, 5011]], device='cuda:3')

rank 1 | epoch 0 | step 24 | batch 24

rank 0 | epoch 0 | step 24 | batch 24

Running epoch 0, step 24, batch 24

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 24, batch 24
Sampled inputs[:2]: tensor([[    0,  1295,   898,  ...,   298, 38754,    66],
        [    0, 49018,   292,  ...,  8774,   642,   365]], device='cuda:2')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   437,  1690,  ...,  1274, 10695, 10762],
        [    0,   365,  1410,  ...,    12,  1478, 16062]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   560, 23501,  ...,   292,   494,   221],
        [    0,  1034,   287,  ...,  9677,    13,  6687]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 24, Loss: 1.2845443487167358
rank: 3, step 24, Loss: 1.2636897563934326
rank: 0, step 24, Loss: 1.2573046684265137


rank: 2, step 24, Loss: 1.2664967775344849


rank 3 | epoch 0 | step 25 | batch 25


Running epoch 0, step 25, batch 25

rank 2 | epoch 0 | step 25 | batch 25


Running epoch 0, step 25, batch 25

rank 1 | epoch 0 | step 25 | batch 25

rank 0 | epoch 0 | step 25 | batch 25

Running epoch 0, step 25, batch 25



Running epoch 0, step 25, batch 25Sampled inputs[:2]: tensor([[    0,  5105,   271,  ...,   308,  3056,  3640],
        [    0,    14,  1062,  ..., 10417,    13, 30579]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 1688,  790,  ...,  546,  696,   12],
        [   0, 2229,  352,  ..., 4988,   33,   13]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  266, 1034,  ..., 6153,  263,  472],
        [   0,   14, 4494,  ..., 4830,  368,  266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  360,  259,  ...,   12,  358,   19],
        [   0, 2025,  287,  ...,  381, 1487, 3506]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 25, Loss: 1.2668770551681519
rank: 3, step 25, Loss: 1.261874794960022
rank: 0, step 25, Loss: 1.275321125984192
rank: 2, step 25, Loss: 1.2713781595230103




rank 3 | epoch 0 | step 26 | batch 26


Running epoch 0, step 26, batch 26

rank 2 | epoch 0 | step 26 | batch 26

rank 0 | epoch 0 | step 26 | batch 26

Running epoch 0, step 26, batch 26


rank 1 | epoch 0 | step 26 | batch 26


Running epoch 0, step 26, batch 26

Running epoch 0, step 26, batch 26
Sampled inputs[:2]: tensor([[    0,   895,  4110,  ...,  1578,  1245,    13],
        [    0,  4566,   300,  ...,   271,  1644, 16473]], device='cuda:3')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   616,  2002,  ..., 19763,   642,   342],
        [    0,   278,  4575,  ...,  1220,   278,  4575]], device='cuda:2')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   287,   266,  ..., 10238,    12, 39004],
        [    0,  1110, 26330,  ...,  1558,   674,  2351]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 2341, 7956,  ..., 2355,  413,   72],
        [   0, 2680,  271,  ..., 4971,  278,  266]], device='cuda:0')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 26, Loss: 1.2660187482833862
rank: 2, step 26, Loss: 1.2716389894485474
rank: 1, step 26, Loss: 1.2611383199691772
rank: 3, step 26, Loss: 1.2757920026779175




rank 3 | epoch 0 | step 27 | batch 27

rank 2 | epoch 0 | step 27 | batch 27


Running epoch 0, step 27, batch 27


Running epoch 0, step 27, batch 27

rank 1 | epoch 0 | step 27 | batch 27


Running epoch 0, step 27, batch 27

rank 0 | epoch 0 | step 27 | batch 27
Sampled inputs[:2]: tensor([[    0,  1597,   278,  ...,    20,    38,   446],
        [    0,    14,   475,  ...,  2117,  2792, 12848]], device='cuda:2')


Running epoch 0, step 27, batch 27Sampled inputs[:2]: tensor([[   0, 1550,  685,  ...,  943, 1239,  996],
        [   0,  996, 2226,  ..., 5322,  287,  452]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0, 19191,   266,  ...,   287,   843,  1528],
        [    0,   446,  1845,  ...,   422,   221,   474]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   21, 1304,  ..., 3577,   13, 2497],
        [   0,  271, 2862,  ...,  287, 5699,   18]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 27, Loss: 1.2665448188781738
rank: 1, step 27, Loss: 1.259333610534668
rank: 2, step 27, Loss: 1.2591980695724487
rank: 0, step 27, Loss: 1.2745040655136108




rank 3 | epoch 0 | step 28 | batch 28
rank 2 | epoch 0 | step 28 | batch 28



Running epoch 0, step 28, batch 28

rank 1 | epoch 0 | step 28 | batch 28

Running epoch 0, step 28, batch 28



Running epoch 0, step 28, batch 28

rank 0 | epoch 0 | step 28 | batch 28


Running epoch 0, step 28, batch 28Sampled inputs[:2]: tensor([[    0,    12,  3454,  ...,   717,  1765, 14906],
        [    0,    12,   287,  ...,   365,  1943,   259]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 10064,   768,  ...,   266,  2816,   278],
        [    0,  4710,    12,  ...,  3969,     9, 11692]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1171,  2926,  ...,   259,  4288,   654],
        [    0,   352,   721,  ...,   634, 17642,   278]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   409,   729,  ...,   391,   266,   996],
        [    0,    14,  2729,  ...,   266,  1659, 14362]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 28, Loss: 1.2720977067947388
rank: 0, step 28, Loss: 1.2636749744415283
rank: 1, step 28, Loss: 1.2681742906570435
rank: 2, step 28, Loss: 1.264828085899353




rank 3 | epoch 0 | step 29 | batch 29
rank 2 | epoch 0 | step 29 | batch 29



Running epoch 0, step 29, batch 29

Running epoch 0, step 29, batch 29


rank 1 | epoch 0 | step 29 | batch 29


Running epoch 0, step 29, batch 29

rank 0 | epoch 0 | step 29 | batch 29
Sampled inputs[:2]: tensor([[    0,  1387,   369,  ..., 15722,    14,  8157],
        [    0,   369,   726,  ...,    83,   409,   729]], device='cuda:3')

Running epoch 0, step 29, batch 29
Sampled inputs[:2]: tensor([[    0,   680,   401,  ...,  2872,   292, 23535],
        [    0, 11435,  1226,  ...,    13,  1875,  6394]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  6541,   287,  ...,  1061,  4786,   292],
        [    0, 23070,   367,  ...,   287,   790,  3252]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 33315,   266,  ...,    12,  1126,    14],
        [    0,  7180,   266,  ...,  1805,    12,   221]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 29, Loss: 1.2675632238388062

rank: 3, step 29, Loss: 1.2745074033737183
rank: 1, step 29, Loss: 1.2614259719848633


rank: 0, step 29, Loss: 1.269906997680664

rank 2 | epoch 0 | step 30 | batch 30


Running epoch 0, step 30, batch 30

rank 3 | epoch 0 | step 30 | batch 30


Running epoch 0, step 30, batch 30

rank 1 | epoch 0 | step 30 | batch 30


Running epoch 0, step 30, batch 30

rank 0 | epoch 0 | step 30 | batch 30Sampled inputs[:2]: tensor([[    0,   266, 15324,  ...,   943,  1613,  7178],
        [    0,   879,    27,  ...,  3958,  2875,    14]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   334,   344,  ...,   266,  4141,   287],
        [    0,   221,   264,  ...,  3613,  3222, 14000]], device='cuda:3')


Running epoch 0, step 30, batch 30Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   953,   328,  ...,  2245,    12,  1253],
        [    0,   634,   631,  ...,  3431,   287, 27947]], device='cuda:1')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  380,  333,  ..., 8127,  504,  679],
        [   0, 4337, 2057,  ..., 3020, 1722,  369]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 30, Loss: 1.262256383895874
rank: 3, step 30, Loss: 1.2693835496902466

rank: 2, step 30, Loss: 1.2656605243682861


rank: 0, step 30, Loss: 1.2653615474700928

rank 2 | epoch 0 | step 31 | batch 31
rank 3 | epoch 0 | step 31 | batch 31



Running epoch 0, step 31, batch 31

Running epoch 0, step 31, batch 31

rank 1 | epoch 0 | step 31 | batch 31



Running epoch 0, step 31, batch 31
Sampled inputs[:2]: tensor([[    0,  9088,  7217,  ...,   199, 17822,   278],
        [    0,    15,    19,  ...,   266,  6391,  1777]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   266,  3574,  ...,  7052,  3829,   292],
        [    0,   474,   221,  ..., 32291,   360,  2458]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  2663,    12,  ..., 24113,   497,    14],
        [    0,   199,  3289,  ...,  2269,  6476,   271]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 31 | batch 31


Running epoch 0, step 31, batch 31
Sampled inputs[:2]: tensor([[    0, 14094,    83,  ...,  1431,   221,   287],
        [    0, 18322,   287,  ...,   953,   271,   221]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 31, Loss: 1.2662392854690552
rank: 0, step 31, Loss: 1.2528482675552368
rank: 3, step 31, Loss: 1.2533159255981445
rank: 2, step 31, Loss: 1.269331693649292



Graident accumulation at epoch 0, step 31, batch 31
Graident accumulation at epoch 0, step 31, batch 31
Graident accumulation at epoch 0, step 31, batch 31
Graident accumulation at epoch 0, step 31, batch 31

rank 3 | epoch 0 | step 32 | batch 32


Running epoch 0, step 32, batch 32

rank 2 | epoch 0 | step 32 | batch 32


Running epoch 0, step 32, batch 32

rank 1 | epoch 0 | step 32 | batch 32


Running epoch 0, step 32, batch 32
Sampled inputs[:2]: tensor([[    0,     7, 22455,  ...,    14,   747,  1501],
        [    0, 34525,  2008,  ...,  1194,   300, 11120]], device='cuda:3')

rank 0 | epoch 0 | step 32 | batch 32Sampled inputs[:2]: tensor([[    0,  9829,   292,  ...,  2928,  1029,   271],
        [    0,   275,  1184,  ...,   328, 46278,  2117]], device='cuda:2')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]




Running epoch 0, step 32, batch 32
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   300,   266,  ...,   271,  4111,  1188],
        [    0, 50208,   292,  ...,   408,   266,  3775]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3253, 1573,  ...,  298,  358,   14],
        [   0,   17, 2736,  ...,  352,  422,   13]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 32, Loss: 1.24819815158844
rank: 2, step 32, Loss: 1.2493232488632202
rank: 3, step 32, Loss: 1.250368356704712
rank: 1, step 32, Loss: 1.2462090253829956




rank 3 | epoch 0 | step 33 | batch 33


Running epoch 0, step 33, batch 33

rank 1 | epoch 0 | step 33 | batch 33


Running epoch 0, step 33, batch 33

rank 2 | epoch 0 | step 33 | batch 33


Running epoch 0, step 33, batch 33

rank 0 | epoch 0 | step 33 | batch 33


Running epoch 0, step 33, batch 33Sampled inputs[:2]: tensor([[    0, 28011,    12,  ...,   346,   462,   221],
        [    0,   638,  2708,  ..., 28492,  1814,    12]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   300,  6263,  ..., 18488,  1665,  1640],
        [    0,   413,    28,  ...,   328, 37605,  6499]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 6574, 1707,  ...,   14, 5077,   12],
        [   0,  417,  199,  ...,   13,   20, 6248]], device='cuda:2')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1480,   518,  ...,   445,    28,   445],
        [    0,    12,   287,  ...,   199,   769, 18432]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 33, Loss: 1.2627747058868408
rank: 2, step 33, Loss: 1.2504874467849731

rank: 0, step 33, Loss: 1.246209979057312

rank: 3, step 33, Loss: 1.24626624584198


rank 2 | epoch 0 | step 34 | batch 34


Running epoch 0, step 34, batch 34

rank 1 | epoch 0 | step 34 | batch 34


Running epoch 0, step 34, batch 34

rank 3 | epoch 0 | step 34 | batch 34

rank 0 | epoch 0 | step 34 | batch 34

Running epoch 0, step 34, batch 34



Running epoch 0, step 34, batch 34
Sampled inputs[:2]: tensor([[    0,  2530,   634,  ...,    15,  8808,     9],
        [    0,   271,   266,  ...,  2805,   607, 10848]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    83,   292,  ...,   445,    11, 16109],
        [    0,  2523, 10780,  ...,  1041,    26, 13745]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1503,  369,  ..., 1336,  271, 8429],
        [   0,   12, 2085,  ...,  287,  593, 4137]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 7185,  328,  ..., 1427, 1477, 1061],
        [   0,  292,   17,  ...,  265, 6943,   14]], device='cuda:0')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 34, Loss: 1.2488341331481934
rank: 3, step 34, Loss: 1.244962453842163


rank: 2, step 34, Loss: 1.2500253915786743

rank: 0, step 34, Loss: 1.255246877670288

rank 2 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35

rank 1 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35

rank 3 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35
Sampled inputs[:2]: tensor([[    0,     9,  8720,  ...,  1657,  1090, 27975],
        [    0,    12,   266,  ...,   674,   369,   259]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  278,  565,  ..., 1125, 5222,  287],
        [   0,  792,  287,  ...,  706, 9751,  278]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1874,  300,  ...,   14, 5372,   12],
        [   0,  271, 3421,  ...,  306,  472,  346]], device='cuda:3')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 35 | batch 35


Running epoch 0, step 35, batch 35
Sampled inputs[:2]: tensor([[    0,   598,   278,  ...,   437,   266,  2388],
        [    0, 27366,   504,  ...,  1358,   365,  6883]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 35, Loss: 1.2385653257369995
rank: 3, step 35, Loss: 1.232827067375183
rank: 0, step 35, Loss: 1.2438647747039795

rank: 2, step 35, Loss: 1.2516798973083496



rank 3 | epoch 0 | step 36 | batch 36


Running epoch 0, step 36, batch 36

rank 2 | epoch 0 | step 36 | batch 36


Running epoch 0, step 36, batch 36

rank 1 | epoch 0 | step 36 | batch 36


Running epoch 0, step 36, batch 36

rank 0 | epoch 0 | step 36 | batch 36
Sampled inputs[:2]: tensor([[   0, 3179,  221,  ...,  910,  706, 1102],
        [   0,  292,  685,  ...,  278, 3281,  298]], device='cuda:3')

Running epoch 0, step 36, batch 36

Sampled inputs[:2]: tensor([[    0,   300, 16683,  ...,  8709,    40,  9817],
        [    0,    14,   475,  ...,  4103,   278,  4190]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 18901,     5,  ...,  2253,   278, 17423],
        [    0, 17471,  4778,  ...,  2177,   271,   266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1184,   271,  ...,  7225,   292,   474],
        [    0,   365,  1941,  ..., 38029,  1790, 44066]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 36, Loss: 1.2308443784713745
rank: 0, step 36, Loss: 1.2486106157302856
rank: 3, step 36, Loss: 1.2442479133605957

rank: 1, step 36, Loss: 1.253018856048584



rank 2 | epoch 0 | step 37 | batch 37


Running epoch 0, step 37, batch 37

rank 1 | epoch 0 | step 37 | batch 37


Running epoch 0, step 37, batch 37

rank 3 | epoch 0 | step 37 | batch 37


Running epoch 0, step 37, batch 37
Sampled inputs[:2]: tensor([[    0,    13,  1581,  ...,    13, 11628, 14876],
        [    0,   462,   221,  ...,    29,   413,  1801]], device='cuda:2')

rank 0 | epoch 0 | step 37 | batch 37Sampled inputs[:2]: tensor([[    0,    14,   475,  ...,  7903,   266, 27772],
        [    0, 10026,   992,  ...,   273,  2831,  8716]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 37, batch 37Sampled inputs[:2]: tensor([[    0,  3761,    12,  ...,  3476, 20966,   391],
        [    0,  2698,   221,  ...,  8352,  5680,   782]], device='cuda:3')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   981,    12,  ...,   266, 12907,  6670],
        [    0, 23809, 27646,  ...,   266,  3373,   554]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 37, Loss: 1.2541120052337646
rank: 3, step 37, Loss: 1.2549262046813965
rank: 0, step 37, Loss: 1.2358386516571045


rank: 2, step 37, Loss: 1.2591346502304077


rank 3 | epoch 0 | step 38 | batch 38


Running epoch 0, step 38, batch 38

rank 2 | epoch 0 | step 38 | batch 38


Running epoch 0, step 38, batch 38

rank 1 | epoch 0 | step 38 | batch 38


Running epoch 0, step 38, batch 38

rank 0 | epoch 0 | step 38 | batch 38
Sampled inputs[:2]: tensor([[    0,   287,   271,  ...,  1039,  4186,    13],
        [    0,   266,  5232,  ...,  2719,    13, 25385]], device='cuda:3')


Running epoch 0, step 38, batch 38
Sampled inputs[:2]: tensor([[    0,   273,    14,  ...,   271,   266, 25408],
        [    0, 12165,    12,  ...,  2860, 10718,   278]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   287,  1070,  ...,   292,   221,   374],
        [    0,  1603,    27,  ..., 19959, 22776,   328]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  6668,   565,  ...,   360,   259,  8166],
        [    0,    12, 30621,  ...,   578,  3126,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 38, Loss: 1.2538996934890747
rank: 3, step 38, Loss: 1.256052017211914

rank: 1, step 38, Loss: 1.2408711910247803


rank: 0, step 38, Loss: 1.2556787729263306

rank 3 | epoch 0 | step 39 | batch 39

rank 2 | epoch 0 | step 39 | batch 39


Running epoch 0, step 39, batch 39


Running epoch 0, step 39, batch 39

rank 1 | epoch 0 | step 39 | batch 39


Running epoch 0, step 39, batch 39
Sampled inputs[:2]: tensor([[   0,   12, 3518,  ..., 1580, 2573,  409],
        [   0, 1858,  499,  ...,   14, 1032,   14]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  2805,   391,  ...,    12,   259,  1420],
        [    0, 31550,    14,  ...,   278,   266,  4901]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  5007,  7551,  ...,     9,  2095,   300],
        [    0, 12456,    14,  ...,  1822,  1016,   365]], device='cuda:1')

rank 0 | epoch 0 | step 39 | batch 39Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 39, batch 39
Sampled inputs[:2]: tensor([[    0, 41638,  4573,  ...,   259,   790,  1416],
        [    0,    21,    14,  ...,  1159,  1978, 33323]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 39, Loss: 1.2474440336227417
rank: 3, step 39, Loss: 1.238775610923767
rank: 0, step 39, Loss: 1.2473571300506592

rank: 2, step 39, Loss: 1.2544642686843872


Graident accumulation at epoch 0, step 39, batch 39Graident accumulation at epoch 0, step 39, batch 39

Graident accumulation at epoch 0, step 39, batch 39
Graident accumulation at epoch 0, step 39, batch 39

rank 3 | epoch 0 | step 40 | batch 40


Running epoch 0, step 40, batch 40

rank 2 | epoch 0 | step 40 | batch 40


Running epoch 0, step 40, batch 40

rank 1 | epoch 0 | step 40 | batch 40Sampled inputs[:2]: tensor([[    0,   266,  1527,  ...,  2525,    14, 11570],
        [    0, 15152,  1106,  ...,   607,   266,  2529]], device='cuda:3')



Running epoch 0, step 40, batch 40
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 40 | batch 40Sampled inputs[:2]: tensor([[    0,   259,  2697,  ...,  1722, 12673, 15053],
        [    0, 16371,    12,  ...,  1296,   680,  1098]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0, 3227,  300,  ..., 1817, 5709,  300],
        [   0, 2853,  590,  ..., 1351, 2927,   12]], device='cuda:1')

Running epoch 0, step 40, batch 40
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  2853, 21042,  ...,  4120,   607, 11176],
        [    0,   221,   527,  ...,   417,   199, 30714]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 40, Loss: 1.2393856048583984
rank: 3, step 40, Loss: 1.2186007499694824
rank: 2, step 40, Loss: 1.2332619428634644



rank: 0, step 40, Loss: 1.2395129203796387

rank 2 | epoch 0 | step 41 | batch 41


Running epoch 0, step 41, batch 41

rank 3 | epoch 0 | step 41 | batch 41


Running epoch 0, step 41, batch 41
rank 1 | epoch 0 | step 41 | batch 41



Running epoch 0, step 41, batch 41
Sampled inputs[:2]: tensor([[    0,  7879,  5435,  ...,  1586, 12115,   271],
        [    0,  9611,   278,  ...,   278,   638,   600]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 23530,  6713,  ...,  2813,   518,   266],
        [    0,  2355,  2728,  ...,   554,  9025,   368]], device='cuda:3')
rank 0 | epoch 0 | step 41 | batch 41
Sampled inputs[:2]: tensor([[    0,   409, 15720,  ...,    12,   287,  2350],
        [    0,  3779,    12,  ...,    12, 12774, 14261]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



Running epoch 0, step 41, batch 41Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   607, 32336,  ...,  4787,   367,  1255],
        [    0,   417,   199,  ...,  1853,    12,   709]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 41, Loss: 1.2370054721832275
rank: 0, step 41, Loss: 1.234062910079956
rank: 3, step 41, Loss: 1.2380213737487793

rank: 1, step 41, Loss: 1.2470393180847168



rank 2 | epoch 0 | step 42 | batch 42

rank 3 | epoch 0 | step 42 | batch 42


Running epoch 0, step 42, batch 42


Running epoch 0, step 42, batch 42

rank 1 | epoch 0 | step 42 | batch 42


Running epoch 0, step 42, batch 42

rank 0 | epoch 0 | step 42 | batch 42
Sampled inputs[:2]: tensor([[    0, 15165,   287,  ..., 15049,   278,   266],
        [    0,    13, 23070,  ...,   266,   319,    13]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    12,  4567,  ...,  4154,  1799, 11883],
        [    0,   659,   278,  ...,  4032,  1109,   721]], device='cuda:3')


Running epoch 0, step 42, batch 42
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    18,   271,  ...,  4868,   963,   271],
        [    0, 17442,  2416,  ...,  7244,    66, 16907]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   729,  3430,  ...,  9715,    13, 42383],
        [    0, 24062, 11234,  ...,  4252,   300,   970]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 42, Loss: 1.2314703464508057
rank: 1, step 42, Loss: 1.22777259349823
rank: 2, step 42, Loss: 1.2396571636199951
rank: 0, step 42, Loss: 1.2319927215576172




rank 2 | epoch 0 | step 43 | batch 43
rank 3 | epoch 0 | step 43 | batch 43



Running epoch 0, step 43, batch 43

Running epoch 0, step 43, batch 43


rank 1 | epoch 0 | step 43 | batch 43


Running epoch 0, step 43, batch 43

rank 0 | epoch 0 | step 43 | batch 43


Running epoch 0, step 43, batch 43Sampled inputs[:2]: tensor([[    0, 32444,    41,  ...,    14,    18,    59],
        [    0,   287,  3284,  ...,   221,   493,   221]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  2612,   271,  ...,   369,  9862,   287],
        [    0,   292, 12376,  ...,   380, 20878, 13900]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  272,  352,  ...,  590, 4361,  446],
        [   0,  365,  925,  ...,  909,  598,  328]], device='cuda:1')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1336,  278,  ...,  266, 3269,  278],
        [   0,  452,  298,  ...,  287, 1575, 7856]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 43, Loss: 1.2426776885986328
rank: 1, step 43, Loss: 1.2358276844024658
rank: 2, step 43, Loss: 1.2439496517181396
rank: 0, step 43, Loss: 1.2273558378219604




rank 3 | epoch 0 | step 44 | batch 44


Running epoch 0, step 44, batch 44

rank 2 | epoch 0 | step 44 | batch 44


Running epoch 0, step 44, batch 44

rank 1 | epoch 0 | step 44 | batch 44


Running epoch 0, step 44, batch 44

rank 0 | epoch 0 | step 44 | batch 44
Sampled inputs[:2]: tensor([[    0,  3592,   417,  ...,  4893,   328,   266],
        [    0,   333,   199,  ...,   287,  4299, 31928]], device='cuda:3')


Running epoch 0, step 44, batch 44
Sampled inputs[:2]: tensor([[    0,  1008,   266,  ...,  1941,   437,  1626],
        [    0,   292,   221,  ...,   796, 12886,   694]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   554,  1034,  ...,  3313,   365,   654],
        [    0, 22387,   292,  ...,   352,  3097,   996]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1796,  342,  ...,  668, 2903,  518],
        [   0,  858,   13,  ..., 2253,  847,  300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 44, Loss: 1.2176023721694946
rank: 0, step 44, Loss: 1.2474337816238403
rank: 3, step 44, Loss: 1.2315071821212769
rank: 1, step 44, Loss: 1.2394212484359741




rank 2 | epoch 0 | step 45 | batch 45
rank 3 | epoch 0 | step 45 | batch 45



Running epoch 0, step 45, batch 45

Running epoch 0, step 45, batch 45


rank 1 | epoch 0 | step 45 | batch 45


Running epoch 0, step 45, batch 45

rank 0 | epoch 0 | step 45 | batch 45
Sampled inputs[:2]: tensor([[   0,   13, 7805,  ..., 2733,   12,  287],
        [   0,  278,  266,  ..., 5503,  259, 1036]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   352, 13159,  ...,  3111,   394,    14],
        [    0,   508,   586,  ...,   445,    29,   445]], device='cuda:2')



Running epoch 0, step 45, batch 45
Sampled inputs[:2]: tensor([[   0,  287, 3609,  ..., 3661, 5944,  838],
        [   0,  344, 3693,  ..., 1782, 3679,  292]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  395, 5949,  ...,  341,   13,  635],
        [   0,   14, 1845,  ...,  806,  352,  408]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 45, Loss: 1.2383058071136475
rank: 1, step 45, Loss: 1.2472509145736694
rank: 3, step 45, Loss: 1.2337547540664673



rank: 0, step 45, Loss: 1.2288631200790405

rank 2 | epoch 0 | step 46 | batch 46

rank 3 | epoch 0 | step 46 | batch 46


Running epoch 0, step 46, batch 46


Running epoch 0, step 46, batch 46

rank 1 | epoch 0 | step 46 | batch 46


Running epoch 0, step 46, batch 46
Sampled inputs[:2]: tensor([[    0,   285,    53,  ...,   259,  5012,  3037],
        [    0,   292, 23242,  ...,  6494,  3560,  1528]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  391, 7750,  ..., 4133,  271,  668],
        [   0,  287, 4579,  ...,  909,   12,  344]], device='cuda:1')Sampled inputs[:2]: tensor([[    0,    12,  1197,  ...,   516,  1136,  9774],
        [    0,   368, 46614,  ...,  1070,   278,  1028]], device='cuda:3')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
rank 0 | epoch 0 | step 46 | batch 46



Running epoch 0, step 46, batch 46
Sampled inputs[:2]: tensor([[    0,   591,  1545,  ...,    71,   462,   221],
        [    0,   721,  1717,  ...,   278, 26029,    12]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 46, Loss: 1.249639868736267
rank: 2, step 46, Loss: 1.243324637413025
rank: 0, step 46, Loss: 1.227982521057129
rank: 3, step 46, Loss: 1.236301302909851




rank 2 | epoch 0 | step 47 | batch 47


Running epoch 0, step 47, batch 47

rank 1 | epoch 0 | step 47 | batch 47


Running epoch 0, step 47, batch 47

rank 3 | epoch 0 | step 47 | batch 47


Running epoch 0, step 47, batch 47
Sampled inputs[:2]: tensor([[    0,   650,    14,  ...,  3687,   278, 26952],
        [    0,   775,   266,  ...,   409,   328,  5768]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  3217, 16714,  ...,   462,   221,   474],
        [    0,  7203,   271,  ...,    12,   275,  3338]], device='cuda:1')

rank 0 | epoch 0 | step 47 | batch 47Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 47831,   266,  ...,    66,    17, 20005],
        [    0, 13856,   278,  ...,    14,    69,   462]], device='cuda:3')

Running epoch 0, step 47, batch 47

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   14, 1266,  ..., 2288,  417,  199],
        [   0,   17,  590,  ..., 1412,   35, 5015]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 47, Loss: 1.221824049949646
rank: 3, step 47, Loss: 1.2455781698226929
rank: 0, step 47, Loss: 1.2366849184036255


rank: 1, step 47, Loss: 1.2421727180480957

Graident accumulation at epoch 0, step 47, batch 47
Graident accumulation at epoch 0, step 47, batch 47
Graident accumulation at epoch 0, step 47, batch 47
Graident accumulation at epoch 0, step 47, batch 47

rank 3 | epoch 0 | step 48 | batch 48

rank 2 | epoch 0 | step 48 | batch 48


Running epoch 0, step 48, batch 48


Running epoch 0, step 48, batch 48

rank 1 | epoch 0 | step 48 | batch 48


Running epoch 0, step 48, batch 48
Sampled inputs[:2]: tensor([[    0,  1531,    14,  ...,  6169,    17,     9],
        [    0,   221,   380,  ...,   630,  3765, 19107]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  2548,   720,  ...,  1795,  1109, 32948],
        [    0,   199,  7513,  ...,   271,   259,   957]], device='cuda:2')

rank 0 | epoch 0 | step 48 | batch 48
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2383, 9843,  ...,  401, 3959,  300],
        [   0, 6132,  300,  ...,   37,  271,  259]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 48, batch 48
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   292,   380,  ...,  1725,   271,   266],
        [    0,   278, 11554,  ...,  4713,  1039, 17088]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 48, Loss: 1.2271336317062378
rank: 3, step 48, Loss: 1.215460181236267
rank: 0, step 48, Loss: 1.2197166681289673
rank: 2, step 48, Loss: 1.225224256515503




rank 3 | epoch 0 | step 49 | batch 49
rank 2 | epoch 0 | step 49 | batch 49



Running epoch 0, step 49, batch 49


Running epoch 0, step 49, batch 49

rank 1 | epoch 0 | step 49 | batch 49


Running epoch 0, step 49, batch 49

rank 0 | epoch 0 | step 49 | batch 49


Running epoch 0, step 49, batch 49Sampled inputs[:2]: tensor([[    0,  5182,   446,  ...,   417,   199,    50],
        [    0,    12,   546,  ..., 24994, 31107,   266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  1029,  6068,  ..., 18017,   300,   259],
        [    0,   471,  6210,  ...,  4274,   344, 11451]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,   266,  9076,  ...,   490,   437, 41298],
        [    0,  1172,   365,  ...,  1119, 15573,  3701]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   360,  3285,  ...,   423,  3579,   468],
        [    0, 23842,   342,  ...,   365,  4011, 10151]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 49, Loss: 1.211073637008667
rank: 1, step 49, Loss: 1.2386850118637085
rank: 2, step 49, Loss: 1.2238084077835083

rank: 0, step 49, Loss: 1.234521508216858



rank 3 | epoch 0 | step 50 | batch 50


Running epoch 0, step 50, batch 50

rank 2 | epoch 0 | step 50 | batch 50

rank 1 | epoch 0 | step 50 | batch 50


Running epoch 0, step 50, batch 50


Running epoch 0, step 50, batch 50

rank 0 | epoch 0 | step 50 | batch 50


Running epoch 0, step 50, batch 50Sampled inputs[:2]: tensor([[   0,  259, 2561,  ...,   77, 4830,  292],
        [   0,  328,  266,  ...,  271,  706,   13]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0, 1716,  271,  ...,  292,   78, 1365],
        [   0, 6957,  271,  ..., 9094,  266, 4320]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   221,   380,  ...,  3990,   717,    12],
        [    0,  1211, 11131,  ..., 31480,   565,   446]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   508,  3282,  ...,   334,   287, 31884],
        [    0,  6369,  3335,  ..., 23951,  8461,    66]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 50, Loss: 1.2375062704086304
rank: 0, step 50, Loss: 1.2276403903961182
rank: 3, step 50, Loss: 1.21062433719635

rank: 1, step 50, Loss: 1.2136662006378174



rank 3 | epoch 0 | step 51 | batch 51
rank 2 | epoch 0 | step 51 | batch 51



Running epoch 0, step 51, batch 51

Running epoch 0, step 51, batch 51


rank 1 | epoch 0 | step 51 | batch 51


Running epoch 0, step 51, batch 51

rank 0 | epoch 0 | step 51 | batch 51
Sampled inputs[:2]: tensor([[    0,  9029,   634,  ...,  1424,  6872,   292],
        [    0,    12, 47869,  ...,   259,  5698,    13]], device='cuda:3')

Running epoch 0, step 51, batch 51Sampled inputs[:2]: tensor([[    0,   271,   266,  ..., 14308,   278,  9452],
        [    0,  4645,  7688,  ..., 26535,   471,   287]], device='cuda:2')


Sampled inputs[:2]: tensor([[   0, 2923,  391,  ...,   14, 5424,  298],
        [   0, 1732,  292,  ..., 3440, 4010, 1487]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 25241,   717,  ...,   413,    16,    14],
        [    0,   446,   475,  ...,   300,   729, 11566]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 51, Loss: 1.2273170948028564
rank: 3, step 51, Loss: 1.2225185632705688
rank: 2, step 51, Loss: 1.2367345094680786



rank: 0, step 51, Loss: 1.2341103553771973

rank 3 | epoch 0 | step 52 | batch 52

rank 2 | epoch 0 | step 52 | batch 52


Running epoch 0, step 52, batch 52


Running epoch 0, step 52, batch 52

rank 1 | epoch 0 | step 52 | batch 52


Running epoch 0, step 52, batch 52

rank 0 | epoch 0 | step 52 | batch 52Sampled inputs[:2]: tensor([[   0,   14,  221,  ...,  298,  408, 1849],
        [   0,   14, 3609,  ...,  298,  413,   29]], device='cuda:3')Sampled inputs[:2]: tensor([[   0, 1074, 1593,  ...,  992, 1810,  300],
        [   0,  659,  278,  ...,  769, 1728,  278]], device='cuda:2')


Sampled inputs[:2]: tensor([[    0, 15372, 10123,  ...,  1782,    12,   266],
        [    0,  3699,  3058,  ...,   820,  5327,  8055]], device='cuda:1')

Running epoch 0, step 52, batch 52

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3825,  1626,  ...,  5096,  3775,   266],
        [    0, 45050,   342,  ...,  3729,   287, 27888]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 52, Loss: 1.2371336221694946
rank: 0, step 52, Loss: 1.2233607769012451
rank: 3, step 52, Loss: 1.223531723022461

rank: 2, step 52, Loss: 1.2316941022872925



rank 2 | epoch 0 | step 53 | batch 53


Running epoch 0, step 53, batch 53

rank 1 | epoch 0 | step 53 | batch 53


Running epoch 0, step 53, batch 53

rank 3 | epoch 0 | step 53 | batch 53


Running epoch 0, step 53, batch 53
Sampled inputs[:2]: tensor([[    0,  1103,   271,  ...,   957,   756,   368],
        [    0, 10215,   408,  ...,  6071,   360,  1317]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  4113,   709,  ..., 22407,  3231,  1130],
        [    0,  3941,   257,  ...,    50,   699, 13374]], device='cuda:1')

rank 0 | epoch 0 | step 53 | batch 53Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 4323, 8213,  ..., 1153,  278, 4258],
        [   0,   14, 3449,  ...,   12, 2665,    5]], device='cuda:3')


Running epoch 0, step 53, batch 53
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1075,   940,  ...,  3780,    13,  4467],
        [    0, 10205,   342,  ...,  6354, 12230,     9]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 53, Loss: 1.223923683166504
rank: 0, step 53, Loss: 1.2226277589797974
rank: 3, step 53, Loss: 1.2017279863357544

rank: 1, step 53, Loss: 1.2243268489837646



rank 2 | epoch 0 | step 54 | batch 54


Running epoch 0, step 54, batch 54

rank 3 | epoch 0 | step 54 | batch 54
rank 1 | epoch 0 | step 54 | batch 54



Running epoch 0, step 54, batch 54


Running epoch 0, step 54, batch 54
Sampled inputs[:2]: tensor([[   0,  278, 1059,  ...,  300, 1877,   13],
        [   0, 4929, 4214,  ..., 1172,  591, 4422]], device='cuda:2')

rank 0 | epoch 0 | step 54 | batch 54Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   422,    13,  ..., 14026,   368,  4999],
        [    0,  1171,   341,  ...,   278, 14713,    18]], device='cuda:1')
Sampled inputs[:2]: tensor([[    0,  1756,   271,  ...,   259, 48595, 19882],
        [    0,    24,    15,  ...,   221,   380,   417]], device='cuda:3')


Running epoch 0, step 54, batch 54
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   344, 14017,  ...,    65,   298,   634],
        [    0,  4110,   271,  ...,   944,   278,  3230]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 54, Loss: 1.2297991514205933

rank: 0, step 54, Loss: 1.2426109313964844
rank: 3, step 54, Loss: 1.2165281772613525

rank: 1, step 54, Loss: 1.2226651906967163


rank 2 | epoch 0 | step 55 | batch 55


Running epoch 0, step 55, batch 55

rank 1 | epoch 0 | step 55 | batch 55


Running epoch 0, step 55, batch 55

rank 3 | epoch 0 | step 55 | batch 55


Running epoch 0, step 55, batch 55
Sampled inputs[:2]: tensor([[    0, 19641,   437,  ...,  2992,   518,   266],
        [    0,   300,   369,  ...,    12,   970,    12]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1235,    14,  ...,  3301,   549,    14],
        [    0,  1128,   292,  ...,  1485,   287, 11833]], device='cuda:1')
rank 0 | epoch 0 | step 55 | batch 55
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



Running epoch 0, step 55, batch 55Sampled inputs[:2]: tensor([[    0,    16,    14,  ...,  5148,   259,  1951],
        [    0, 11541,  4784,  ...,  2837, 38541,    12]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   199,  1139,  ...,    13,  1303, 26330],
        [    0,  4602,  2387,  ..., 11616,    14, 18434]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 55, Loss: 1.2363373041152954
rank: 2, step 55, Loss: 1.2347356081008911
rank: 1, step 55, Loss: 1.224298119544983
rank: 3, step 55, Loss: 1.240501046180725



Graident accumulation at epoch 0, step 55, batch 55
Graident accumulation at epoch 0, step 55, batch 55
Graident accumulation at epoch 0, step 55, batch 55
Graident accumulation at epoch 0, step 55, batch 55

rank 2 | epoch 0 | step 56 | batch 56


Running epoch 0, step 56, batch 56

rank 3 | epoch 0 | step 56 | batch 56


Running epoch 0, step 56, batch 56

rank 1 | epoch 0 | step 56 | batch 56


Running epoch 0, step 56, batch 56
Sampled inputs[:2]: tensor([[    0,  1781,   659,  ...,    12,  1478,    14],
        [    0, 25228,  1168,  ...,  2728,    27,   298]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1665,  6306,  ...,   300, 10204,   582],
        [    0,    14, 12285,  ...,   616,   515,   352]], device='cuda:3')

rank 0 | epoch 0 | step 56 | batch 56
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 3630, 2199,  ..., 4157,   27, 4765],
        [   0,  342,  516,  ...,   12,  729, 3701]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 56, batch 56
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1765, 5370,  ..., 1711,  292,  380],
        [   0,  391, 1351,  ...,   13,   40,    9]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 56, Loss: 1.2271873950958252
rank: 1, step 56, Loss: 1.2166954278945923
rank: 3, step 56, Loss: 1.21807861328125
rank: 2, step 56, Loss: 1.2222728729248047




rank 3 | epoch 0 | step 57 | batch 57

rank 2 | epoch 0 | step 57 | batch 57


Running epoch 0, step 57, batch 57


Running epoch 0, step 57, batch 57

rank 1 | epoch 0 | step 57 | batch 57


Running epoch 0, step 57, batch 57

rank 0 | epoch 0 | step 57 | batch 57
Sampled inputs[:2]: tensor([[    0,  5160,   278,  ...,   496,    14, 46919],
        [    0, 18774,  4916,  ..., 35093,    19,    50]], device='cuda:2')

Running epoch 0, step 57, batch 57
Sampled inputs[:2]: tensor([[   0,    9,  278,  ...,  278,  298,  452],
        [   0, 1184, 1451,  ...,  934,  352,  266]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  494,  221,  ...,  437,  266, 2143],
        [   0,  391, 9095,  ...,  417,  199, 2038]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 4998, 1921,  ...,  968,  266, 1136],
        [   0, 1420, 6319,  ...,  292, 4895, 4050]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 57, Loss: 1.2153571844100952
rank: 1, step 57, Loss: 1.2400109767913818
rank: 3, step 57, Loss: 1.2250078916549683
rank: 2, step 57, Loss: 1.2380725145339966




rank 2 | epoch 0 | step 58 | batch 58
rank 3 | epoch 0 | step 58 | batch 58



Running epoch 0, step 58, batch 58

Running epoch 0, step 58, batch 58


rank 1 | epoch 0 | step 58 | batch 58


Running epoch 0, step 58, batch 58

rank 0 | epoch 0 | step 58 | batch 58


Running epoch 0, step 58, batch 58
Sampled inputs[:2]: tensor([[    0,  2546,   300,  ...,    14,  1075,   756],
        [    0,    76,   472,  ..., 21215,   472,   346]], device='cuda:3')Sampled inputs[:2]: tensor([[    0, 15689,   278,  ..., 12016,   271,  4353],
        [    0,  2720,    14,  ...,   300, 15867,   368]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   328,   266,  ...,   352, 13107,  4302],
        [    0,    14,    20,  ...,   607,  8386,    88]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 48214,   287,  ...,   494,  8524,    12],
        [    0,   352,   266,  ...,  2416,   287,   300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 58, Loss: 1.2215148210525513
rank: 2, step 58, Loss: 1.2333219051361084
rank: 1, step 58, Loss: 1.231215476989746
rank: 3, step 58, Loss: 1.2182462215423584




rank 2 | epoch 0 | step 59 | batch 59


Running epoch 0, step 59, batch 59

rank 1 | epoch 0 | step 59 | batch 59


Running epoch 0, step 59, batch 59

rank 3 | epoch 0 | step 59 | batch 59


Running epoch 0, step 59, batch 59
Sampled inputs[:2]: tensor([[    0, 14576,  6617,  ...,    17,   367,  1608],
        [    0,  6847,   437,  ...,    17,    14,    16]], device='cuda:2')

rank 0 | epoch 0 | step 59 | batch 59Sampled inputs[:2]: tensor([[   0,  767, 1345,  ...,  276,  327,  328],
        [   0,   13, 6913,  ...,  278, 1317, 4470]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 59, batch 59Sampled inputs[:2]: tensor([[    0, 38232,   446,  ...,   287,  2456, 29919],
        [    0,  2042,  2909,  ...,    14, 15061,  5742]], device='cuda:3')
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  266, 1336,  ..., 1841, 9705, 1219],
        [   0, 1751,  287,  ..., 6079, 1059,  287]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 59, Loss: 1.2300549745559692
rank: 1, step 59, Loss: 1.2296794652938843
rank: 2, step 59, Loss: 1.2244786024093628

rank: 0, step 59, Loss: 1.2276660203933716



rank 3 | epoch 0 | step 60 | batch 60


Running epoch 0, step 60, batch 60

rank 2 | epoch 0 | step 60 | batch 60


Running epoch 0, step 60, batch 60

rank 1 | epoch 0 | step 60 | batch 60


Running epoch 0, step 60, batch 60

rank 0 | epoch 0 | step 60 | batch 60
Sampled inputs[:2]: tensor([[   0, 2173,  292,  ...,  344, 8106,  344],
        [   0,  278, 5717,  ..., 5342, 5147,   14]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 9855,  278,  ...,  266, 3134,  278],
        [   0, 6477,   12,  ..., 2931,  221,  445]], device='cuda:2')

Running epoch 0, step 60, batch 60

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   292, 41192,  ..., 34298,  8741,   271],
        [    0,   199,  5990,  ...,   278,   638,  5513]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  346,  462,  ..., 2915,  275, 2565],
        [   0,  923,   13,  ...,  300, 8262,   12]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 60, Loss: 1.2144737243652344
rank: 1, step 60, Loss: 1.2314825057983398
rank: 0, step 60, Loss: 1.2287001609802246

rank: 2, step 60, Loss: 1.2176687717437744



rank 3 | epoch 0 | step 61 | batch 61


Running epoch 0, step 61, batch 61

rank 1 | epoch 0 | step 61 | batch 61

rank 2 | epoch 0 | step 61 | batch 61


Running epoch 0, step 61, batch 61


Running epoch 0, step 61, batch 61

rank 0 | epoch 0 | step 61 | batch 61


Running epoch 0, step 61, batch 61Sampled inputs[:2]: tensor([[   0,  927,  259,  ...,  328, 9430, 2330],
        [   0,   20,   13,  ...,  496,   14, 1032]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  300, 2607,  ..., 1279,  368,  266],
        [   0, 1854,  292,  ...,  328, 1360,   14]], device='cuda:1')
Sampled inputs[:2]: tensor([[   0, 1603,  694,  ...,   36,   18,  298],
        [   0,  270,  472,  ...,  292,   73,   14]], device='cuda:2')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   271,   266,  ...,  1034,  1928,    15],
        [    0,    13, 23904,  ...,   560,  8840,    26]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 61, Loss: 1.2364848852157593
rank: 1, step 61, Loss: 1.235880970954895
rank: 0, step 61, Loss: 1.2064446210861206

rank: 2, step 61, Loss: 1.231601595878601



rank 2 | epoch 0 | step 62 | batch 62


Running epoch 0, step 62, batch 62

rank 1 | epoch 0 | step 62 | batch 62


Running epoch 0, step 62, batch 62

rank 3 | epoch 0 | step 62 | batch 62


Running epoch 0, step 62, batch 62
Sampled inputs[:2]: tensor([[    0,  3908,   300,  ..., 10874,  2667,   518],
        [    0,   298,  2230,  ...,  2300,  3698,  4764]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   278,  2097,  ...,  1754,   287,   631],
        [    0,   341, 22766,  ...,   271,   266,  1176]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 62 | batch 62
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   843,  2621,  ...,  4589,   278, 14266],
        [    0,   266,  1513,  ...,   367,  1941,   344]], device='cuda:3')


Running epoch 0, step 62, batch 62
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1254,  2921,  ...,  1888, 33569,  3201],
        [    0,   510,    13,  ...,  3454,   513,    13]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 62, Loss: 1.2257403135299683

rank: 3, step 62, Loss: 1.233559489250183

rank: 1, step 62, Loss: 1.2118725776672363

rank: 0, step 62, Loss: 1.2311921119689941

rank 3 | epoch 0 | step 63 | batch 63
rank 2 | epoch 0 | step 63 | batch 63



Running epoch 0, step 63, batch 63


Running epoch 0, step 63, batch 63

rank 1 | epoch 0 | step 63 | batch 63


Running epoch 0, step 63, batch 63

rank 0 | epoch 0 | step 63 | batch 63
Sampled inputs[:2]: tensor([[    0,  5689,   271,  ...,   352,  9985,  3260],
        [    0,   266,  1176,  ...,   199, 17791,  3662]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,  2733,   278,  ..., 10936,    14,  6593],
        [    0,  3159,   278,  ...,   266,  2545,   863]], device='cuda:2')



Running epoch 0, step 63, batch 63
Sampled inputs[:2]: tensor([[    0,  4994,  8429,  ...,    12,   795,   596],
        [    0,    13,  2497,  ..., 27714,   278,   266]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   456,    17,  ...,  1553, 29477,  2713],
        [    0,   292,   494,  ...,   259, 14134, 11544]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 63, Loss: 1.2194875478744507
rank: 2, step 63, Loss: 1.2189769744873047
rank: 0, step 63, Loss: 1.2335025072097778
rank: 1, step 63, Loss: 1.2167458534240723


Graident accumulation at epoch 0, step 63, batch 63

Graident accumulation at epoch 0, step 63, batch 63
Graident accumulation at epoch 0, step 63, batch 63
Graident accumulation at epoch 0, step 63, batch 63

rank 2 | epoch 0 | step 64 | batch 64

rank 1 | epoch 0 | step 64 | batch 64
rank 3 | epoch 0 | step 64 | batch 64



Running epoch 0, step 64, batch 64


Running epoch 0, step 64, batch 64


Running epoch 0, step 64, batch 64
Sampled inputs[:2]: tensor([[   0,  996, 2226,  ...,  516, 3470,   14],
        [   0, 1098,  259,  ..., 6572, 1477,   12]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   342, 43937,  ...,   298,   413,    29],
        [    0,   659,   278,  ...,   593,  2177,   266]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0, 25778,  3804,  ...,  2354,    12,   554],
        [    0,   409,  3669,  ...,    12,   374,    20]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]



rank 0 | epoch 0 | step 64 | batch 64


Running epoch 0, step 64, batch 64
Sampled inputs[:2]: tensor([[    0,   677, 35427,  ..., 30465,  2783,     9],
        [    0,   346,   462,  ..., 37683,    14,  1500]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 64, Loss: 1.2123653888702393
rank: 1, step 64, Loss: 1.2141989469528198
rank: 2, step 64, Loss: 1.2079099416732788
rank: 3, step 64, Loss: 1.214743971824646




rank 3 | epoch 0 | step 65 | batch 65
rank 2 | epoch 0 | step 65 | batch 65



Running epoch 0, step 65, batch 65

Running epoch 0, step 65, batch 65


rank 1 | epoch 0 | step 65 | batch 65


Running epoch 0, step 65, batch 65

rank 0 | epoch 0 | step 65 | batch 65


Running epoch 0, step 65, batch 65
Sampled inputs[:2]: tensor([[   0, 2974,  278,  ...,  365, 8758,  271],
        [   0,   14,  292,  ..., 1385,   12,  287]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 1234,  278,  ..., 8635,  271,  546],
        [   0, 4494,   12,  ...,  341, 1619,   12]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  1039,   259,  ...,   221,   685,   546],
        [    0, 16763,  1538,  ...,   631,  3299,   437]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 8840,   26,  ...,   28,   16,   14],
        [   0,  221,  380,  ...,  508, 1853,   14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 65, Loss: 1.2199625968933105
rank: 3, step 65, Loss: 1.2152155637741089
rank: 2, step 65, Loss: 1.2201110124588013
rank: 1, step 65, Loss: 1.2237821817398071




rank 2 | epoch 0 | step 66 | batch 66


Running epoch 0, step 66, batch 66

rank 1 | epoch 0 | step 66 | batch 66


Running epoch 0, step 66, batch 66

rank 3 | epoch 0 | step 66 | batch 66


Running epoch 0, step 66, batch 66
Sampled inputs[:2]: tensor([[    0, 33792,   352,  ...,   278,   546, 30495],
        [    0,   367,  2063,  ...,  3022,   221,   733]], device='cuda:2')

rank 0 | epoch 0 | step 66 | batch 66Sampled inputs[:2]: tensor([[    0,   401,   953,  ..., 10914,   554,  2360],
        [    0,    14,   475,  ...,  6895,  5842,  2239]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[   0,  257,  298,  ..., 1878,  328,  259],
        [   0,  759, 4585,  ...,  360,  300,  670]], device='cuda:3')


Running epoch 0, step 66, batch 66Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   409, 35049,  ...,    12,   699,   394],
        [    0,   598,   696,  ...,  4048,  1795,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 66, Loss: 1.2113935947418213
rank: 0, step 66, Loss: 1.2061265707015991

rank: 3, step 66, Loss: 1.2163569927215576
rank: 1, step 66, Loss: 1.2204058170318604



rank 2 | epoch 0 | step 67 | batch 67


Running epoch 0, step 67, batch 67

rank 3 | epoch 0 | step 67 | batch 67


Running epoch 0, step 67, batch 67

rank 1 | epoch 0 | step 67 | batch 67


Running epoch 0, step 67, batch 67

rank 0 | epoch 0 | step 67 | batch 67Sampled inputs[:2]: tensor([[    0,  7061,   437,  ...,   278,  9500,    18],
        [    0,   382,  9279,  ...,   445, 37790,     9]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,  9458,   278,  ...,    15,  5251, 27858],
        [    0, 12324,  7368,  ...,   365,   726,  3595]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,    14,   496,  ...,   368,   259,   490],
        [    0, 16803,   965,  ..., 36064,    12, 13769]], device='cuda:1')

Running epoch 0, step 67, batch 67
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,     9,  9925,  ...,   527, 23286,  6062],
        [    0,   461,   654,  ...,  6548,  7171,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 67, Loss: 1.2227025032043457
rank: 2, step 67, Loss: 1.2406221628189087
rank: 0, step 67, Loss: 1.210054636001587
rank: 3, step 67, Loss: 1.210572361946106




rank 2 | epoch 0 | step 68 | batch 68


Running epoch 0, step 68, batch 68

rank 3 | epoch 0 | step 68 | batch 68

rank 1 | epoch 0 | step 68 | batch 68

Running epoch 0, step 68, batch 68



Running epoch 0, step 68, batch 68

rank 0 | epoch 0 | step 68 | batch 68Sampled inputs[:2]: tensor([[    0,  1159,   278,  ...,     9,   271,   266],
        [    0,  5597, 11929,  ...,   271,   275,   955]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,   12,  344,  ..., 2337, 1122,  408],
        [   0,  689, 2149,  ..., 4263,   14,  292]], device='cuda:3')
Sampled inputs[:2]: tensor([[    0,  6795,  1728,  ...,   578,    19,    14],
        [    0,     9,   298,  ...,    12, 24079,   287]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Running epoch 0, step 68, batch 68

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1295,   508,  ...,   829,   772,   278],
        [    0,    14, 30840,  ...,   287,   932,    14]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 68, Loss: 1.2017128467559814
rank: 0, step 68, Loss: 1.225447654724121

rank: 1, step 68, Loss: 1.2245800495147705
rank: 3, step 68, Loss: 1.2176955938339233



rank 2 | epoch 0 | step 69 | batch 69

rank 3 | epoch 0 | step 69 | batch 69


Running epoch 0, step 69, batch 69


Running epoch 0, step 69, batch 69

rank 1 | epoch 0 | step 69 | batch 69


Running epoch 0, step 69, batch 69

rank 0 | epoch 0 | step 69 | batch 69
Sampled inputs[:2]: tensor([[    0,   266, 27347,  ...,   368,  3367,    13],
        [    0,  6408,   391,  ...,   870,   278,   266]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   342,   266,  ...,   199,   395, 11578],
        [    0,  5159,   292,  ...,   772,   271,  3728]], device='cuda:3')



Running epoch 0, step 69, batch 69
Sampled inputs[:2]: tensor([[    0,  2140,    12,  ...,   696,   688,  1998],
        [    0, 16765,   367,  ..., 30192,  7038,  8135]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 6088, 1172,  ...,  546,  401,  925],
        [   0,  278, 2088,  ...,   69,   14,   71]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 69, Loss: 1.2049108743667603
rank: 3, step 69, Loss: 1.222294569015503

rank: 2, step 69, Loss: 1.2112185955047607
rank: 0, step 69, Loss: 1.2051289081573486



rank 3 | epoch 0 | step 70 | batch 70


Running epoch 0, step 70, batch 70

rank 2 | epoch 0 | step 70 | batch 70


Running epoch 0, step 70, batch 70

rank 1 | epoch 0 | step 70 | batch 70


Running epoch 0, step 70, batch 70

rank 0 | epoch 0 | step 70 | batch 70
Sampled inputs[:2]: tensor([[   0,  504,  409,  ..., 5863, 2621,  824],
        [   0, 1295, 1178,  ..., 4808,  287,  996]], device='cuda:3')

Running epoch 0, step 70, batch 70
Sampled inputs[:2]: tensor([[    0,   923,  2583,  ..., 11385,    14,  1062],
        [    0, 18125, 16419,  ...,   278,   638, 11744]], device='cuda:2')

Sampled inputs[:2]: tensor([[   0,  474,  513,  ...,  221, 2951, 7773],
        [   0, 1356,   18,  ...,   31,  333,  199]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 17471,  7279,  ...,   328,  6179,   287],
        [    0,   266,  1441,  ...,  1817,  1589,   278]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 70, Loss: 1.2225730419158936
rank: 3, step 70, Loss: 1.225156307220459


rank: 0, step 70, Loss: 1.2234876155853271
rank: 2, step 70, Loss: 1.2256410121917725


rank 3 | epoch 0 | step 71 | batch 71

rank 2 | epoch 0 | step 71 | batch 71


Running epoch 0, step 71, batch 71


Running epoch 0, step 71, batch 71

rank 1 | epoch 0 | step 71 | batch 71


Running epoch 0, step 71, batch 71

rank 0 | epoch 0 | step 71 | batch 71
Sampled inputs[:2]: tensor([[    0,   328, 16219,  ..., 14559,   351,   587],
        [    0,   680,   271,  ..., 12942,   271,   266]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 2626,   13,  ...,  300,  369,  259],
        [   0,  292,   41,  ...,  271, 9536,  287]], device='cuda:3')



Running epoch 0, step 71, batch 71
Sampled inputs[:2]: tensor([[    0,   266, 15957,  ...,  1556, 45044,   271],
        [    0,   689,    13,  ...,   756,   271, 31773]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   300,   259,  ...,   352, 12080,   634],
        [    0,  1371,   287,  ...,   689,   278, 12774]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 71, Loss: 1.2301874160766602
rank: 0, step 71, Loss: 1.2177391052246094
rank: 3, step 71, Loss: 1.2151027917861938

rank: 2, step 71, Loss: 1.2355413436889648


Graident accumulation at epoch 0, step 71, batch 71
Graident accumulation at epoch 0, step 71, batch 71
Graident accumulation at epoch 0, step 71, batch 71
Graident accumulation at epoch 0, step 71, batch 71

rank 3 | epoch 0 | step 72 | batch 72


Running epoch 0, step 72, batch 72

rank 2 | epoch 0 | step 72 | batch 72


Running epoch 0, step 72, batch 72

rank 1 | epoch 0 | step 72 | batch 72


Running epoch 0, step 72, batch 72

rank 0 | epoch 0 | step 72 | batch 72Sampled inputs[:2]: tensor([[    0, 15411,  4286,  ...,  3337,   300,  2257],
        [    0,  1607, 26394,  ...,    19,   471,    14]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  278, 6481,  ...,   13, 8970,   12],
        [   0,   12,  496,  ...,  437,  266, 3767]], device='cuda:2')


Running epoch 0, step 72, batch 72Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   634, 10095,  ...,   367, 24607,   287],
        [    0,    14,  3921,  ...,   199,  2038,  1963]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  3473,   278,  ..., 11743,   472,   346],
        [    0,   266,  1254,  ...,   369,  2870,   300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 72, Loss: 1.2120405435562134
rank: 3, step 72, Loss: 1.218603491783142
rank: 0, step 72, Loss: 1.2243794202804565
rank: 2, step 72, Loss: 1.2145172357559204




rank 2 | epoch 0 | step 73 | batch 73


Running epoch 0, step 73, batch 73

rank 3 | epoch 0 | step 73 | batch 73


Running epoch 0, step 73, batch 73

rank 1 | epoch 0 | step 73 | batch 73


Running epoch 0, step 73, batch 73

rank 0 | epoch 0 | step 73 | batch 73
Sampled inputs[:2]: tensor([[    0,  5151,   292,  ..., 13658,   401,  1070],
        [    0,   792,   342,  ..., 12152,  9904,  1239]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1526,  341,  ...,  271, 4401, 3341],
        [   0,  287,  271,  ..., 5090,  631, 3276]], device='cuda:3')


Running epoch 0, step 73, batch 73Sampled inputs[:2]: tensor([[   0, 3646, 1340,  ...,   13, 7800, 2872],
        [   0, 2379,   13,  ...,  287,  259, 2193]], device='cuda:1')

Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1979,   352,  ...,   292,  1591,   446],
        [    0, 24674,   513,  ...,  6099,    12,  4863]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 73, Loss: 1.217373013496399
rank: 2, step 73, Loss: 1.2217530012130737
rank: 3, step 73, Loss: 1.190401554107666



rank: 0, step 73, Loss: 1.2088112831115723

rank 2 | epoch 0 | step 74 | batch 74


Running epoch 0, step 74, batch 74

rank 1 | epoch 0 | step 74 | batch 74


Running epoch 0, step 74, batch 74

rank 3 | epoch 0 | step 74 | batch 74


Running epoch 0, step 74, batch 74
Sampled inputs[:2]: tensor([[   0, 2328,  271,  ...,  706,   13, 8961],
        [   0, 9657,  300,  ...,   12,  271,  266]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    14, 49045,  ...,    12,   706,   409],
        [    0,   292, 17181,  ...,   634,  5039,   266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank 0 | epoch 0 | step 74 | batch 74Sampled inputs[:2]: tensor([[    0,   287,  1410,  ...,  1255,  1699,   328],
        [    0,    14, 13078,  ...,  1994,    12,   287]], device='cuda:3')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 74, batch 74Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   381,  1659,  ...,  1403,   271,  6324],
        [    0,  3829,   278,  ..., 11978,     9,   968]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 74, Loss: 1.2148170471191406
rank: 1, step 74, Loss: 1.2065389156341553
rank: 2, step 74, Loss: 1.220167636871338
rank: 3, step 74, Loss: 1.1995594501495361




rank 2 | epoch 0 | step 75 | batch 75
rank 3 | epoch 0 | step 75 | batch 75



Running epoch 0, step 75, batch 75

Running epoch 0, step 75, batch 75


rank 1 | epoch 0 | step 75 | batch 75


Running epoch 0, step 75, batch 75

rank 0 | epoch 0 | step 75 | batch 75


Running epoch 0, step 75, batch 75
Sampled inputs[:2]: tensor([[    0,  3227,   278,  ...,  2950,    14, 15544],
        [    0,    14,  8058,  ..., 10316,   352,   266]], device='cuda:3')Sampled inputs[:2]: tensor([[    0,   278,  2305,  ...,  2529, 34181,  4555],
        [    0,  6809,   344,  ...,    14,  1266,   795]], device='cuda:2')

Sampled inputs[:2]: tensor([[    0,   287, 17044,  ...,   496,    14,  1841],
        [    0,   271,   259,  ...,  4511,    14,   333]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2667,  365,  ..., 9281, 1631, 9123],
        [   0,  586, 1016,  ..., 7151, 8280,  300]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 75, Loss: 1.2098463773727417
rank: 3, step 75, Loss: 1.2033079862594604
rank: 1, step 75, Loss: 1.2187602519989014

rank: 0, step 75, Loss: 1.223578929901123



rank 2 | epoch 0 | step 76 | batch 76

rank 3 | epoch 0 | step 76 | batch 76


Running epoch 0, step 76, batch 76


Running epoch 0, step 76, batch 76

rank 1 | epoch 0 | step 76 | batch 76


Running epoch 0, step 76, batch 76

rank 0 | epoch 0 | step 76 | batch 76
Sampled inputs[:2]: tensor([[    0, 10705,   401,  ...,   768,  2392,   368],
        [    0,   266,   824,  ...,  1799,   287,  6250]], device='cuda:3')

Running epoch 0, step 76, batch 76
Sampled inputs[:2]: tensor([[    0,    12,   344,  ..., 10482,   950, 15744],
        [    0,  3577,    12,  ...,  4222,  2137, 31332]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  300, 1635,  ...,  437,  266, 1136],
        [   0,  221,  474,  ...,   12,  259, 1220]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 1730, 2068,  ...,  445, 2704,  445],
        [   0,  342, 4781,  ...,  630,  940,  271]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 76, Loss: 1.2073347568511963
rank: 3, step 76, Loss: 1.2159451246261597
rank: 0, step 76, Loss: 1.2100005149841309
rank: 2, step 76, Loss: 1.2234264612197876




rank 3 | epoch 0 | step 77 | batch 77


Running epoch 0, step 77, batch 77

rank 2 | epoch 0 | step 77 | batch 77
rank 1 | epoch 0 | step 77 | batch 77



Running epoch 0, step 77, batch 77

Running epoch 0, step 77, batch 77


rank 0 | epoch 0 | step 77 | batch 77
Sampled inputs[:2]: tensor([[   0,  765,  292,  ...,  623,   12, 7117],
        [   0, 6508, 4305,  ...,  806, 3888, 4431]], device='cuda:3')


Running epoch 0, step 77, batch 77
Sampled inputs[:2]: tensor([[   0, 6762,  689,  ..., 7061,   14,  381],
        [   0,  635,   13,  ...,  292,   20,  445]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0,  278, 5798,  ...,  266,  729, 1798],
        [   0,   17,  292,  ..., 2269, 3887,  278]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  278,  554,  ...,  365, 3125,  271],
        [   0, 1067,  408,  ..., 4657, 1016,  271]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 77, Loss: 1.2028650045394897
rank: 1, step 77, Loss: 1.1964313983917236
rank: 0, step 77, Loss: 1.2224071025848389
rank: 2, step 77, Loss: 1.1978765726089478




rank 2 | epoch 0 | step 78 | batch 78

rank 3 | epoch 0 | step 78 | batch 78


Running epoch 0, step 78, batch 78


Running epoch 0, step 78, batch 78

rank 1 | epoch 0 | step 78 | batch 78


Running epoch 0, step 78, batch 78

rank 0 | epoch 0 | step 78 | batch 78
Sampled inputs[:2]: tensor([[    0,    12,  2212,  ..., 12415,  2131,   287],
        [    0,  3001,  3325,  ..., 16332,  2661,  1200]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,    19,     9,  ..., 11504,   446,   381],
        [    0, 19720,    12,  ...,  1239,    12, 22324]], device='cuda:3')


Running epoch 0, step 78, batch 78
Sampled inputs[:2]: tensor([[   0, 4108,   85,  ...,   40,   12, 1530],
        [   0,   16,   52,  ...,   12,  298,  374]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   221,  4070,  ...,  1061,  3189,    26],
        [    0,   271,  4136,  ...,  5052, 14552,  3339]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 78, Loss: 1.1971561908721924
rank: 1, step 78, Loss: 1.2219133377075195
rank: 2, step 78, Loss: 1.2195441722869873
rank: 0, step 78, Loss: 1.2182793617248535




rank 3 | epoch 0 | step 79 | batch 79
rank 2 | epoch 0 | step 79 | batch 79



Running epoch 0, step 79, batch 79

Running epoch 0, step 79, batch 79


rank 1 | epoch 0 | step 79 | batch 79


Running epoch 0, step 79, batch 79

rank 0 | epoch 0 | step 79 | batch 79


Running epoch 0, step 79, batch 79Sampled inputs[:2]: tensor([[    0, 48705,   292,  ...,   266,  2548,  2697],
        [    0,    34,     9,  ...,    19,    14, 45576]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   199,  2834,  ...,  1236,   768,  4316],
        [    0,   300, 13523,  ..., 42438,   786,  1416]], device='cuda:3')


Sampled inputs[:2]: tensor([[   0, 5699,   20,  ..., 3502, 2051,  266],
        [   0, 1487,  409,  ..., 6979, 1273,  496]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  292,  380,  ..., 9636,  417,  199],
        [   0,   35, 3815,  ...,  278, 7097, 4601]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 79, Loss: 1.2083138227462769
rank: 1, step 79, Loss: 1.2310903072357178
rank: 0, step 79, Loss: 1.219773769378662
rank: 2, step 79, Loss: 1.1962333917617798



Graident accumulation at epoch 0, step 79, batch 79
Graident accumulation at epoch 0, step 79, batch 79
Graident accumulation at epoch 0, step 79, batch 79
Graident accumulation at epoch 0, step 79, batch 79
Saving checkpoint at epoch 0, step 79, batch 79
Saving checkpoint at epoch 0, step 79, batch 79
Saving checkpoint at epoch 0, step 79, batch 79
Epoch 0 | Batch 79/1048 | Training PPL: 17295.30151774386 | time 7.917743682861328
Saving checkpoint at epoch 0, step 79, batch 79
Epoch 0 | Validation PPL: 15842.94824258871 | Learning rate: 1.628035421558293e-05

rank 3 | epoch 0 | step 80 | batch 80
rank 2 | epoch 0 | step 80 | batch 80


rank 1 | epoch 0 | step 80 | batch 80


Running epoch 0, step 80, batch 80


Running epoch 0, step 80, batch 80


Running epoch 0, step 80, batch 80
Sampled inputs[:2]: tensor([[    0,   445,    29,  ..., 20247,   272,   298],
        [    0,  5896,   352,  ...,  1168,   767,  1390]], device='cuda:3')
Sampled inputs[:2]: tensor([[   0, 4258,  717,  ...,   34,  609, 1169],
        [   0,  266, 2057,  ...,   88, 1801,   66]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  3756,    13,  ...,  1704,   278,  5851],
        [    0,   521,   486,  ...,   278, 25182,   271]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Checkpoint saved to exp/gpt2_scratch_neuro_tokenizer_bayes_fwd_mini/checkpoint.0_79, AFTER epoch 0, step 79

rank 0 | epoch 0 | step 80 | batch 80


Running epoch 0, step 80, batch 80
Sampled inputs[:2]: tensor([[   0,  394,  292,  ..., 1711,  365,  897],
        [   0, 3440, 5745,  ...,  360, 4998,  654]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 80, Loss: 1.197102665901184
rank: 3, step 80, Loss: 1.2149226665496826
rank: 2, step 80, Loss: 1.2239365577697754

rank: 1, step 80, Loss: 1.2301231622695923



rank 2 | epoch 0 | step 81 | batch 81


Running epoch 0, step 81, batch 81

rank 3 | epoch 0 | step 81 | batch 81


Running epoch 0, step 81, batch 81

rank 0 | epoch 0 | step 81 | batch 81

rank 1 | epoch 0 | step 81 | batch 81

Running epoch 0, step 81, batch 81


Running epoch 0, step 81, batch 81

Sampled inputs[:2]: tensor([[   0,  257,  221,  ..., 1474, 2044,  300],
        [   0,  365, 2849,  ...,    9, 3365, 5027]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 26396,    83,  ...,   292,    18,   590],
        [    0,   287, 19777,  ...,   266,  5061,   278]], device='cuda:3')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1106,   259,  ...,   271,   679,   382],
        [    0, 13245,  1503,  ...,    14,  5605,    12]], device='cuda:0')Sampled inputs[:2]: tensor([[    0,   287,  2199,  ...,   266,  1241,  3139],
        [    0,   677, 25912,  ...,  2337,   292,  4462]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 81, Loss: 1.1990737915039062
rank: 3, step 81, Loss: 1.213234543800354


rank: 2, step 81, Loss: 1.2127493619918823

rank: 0, step 81, Loss: 1.2244540452957153

rank 2 | epoch 0 | step 82 | batch 82

rank 3 | epoch 0 | step 82 | batch 82


Running epoch 0, step 82, batch 82


Running epoch 0, step 82, batch 82

rank 1 | epoch 0 | step 82 | batch 82


Running epoch 0, step 82, batch 82

rank 0 | epoch 0 | step 82 | batch 82Sampled inputs[:2]: tensor([[    0, 48007,   417,  ...,   944,   278,  2903],
        [    0,   199, 14973,  ...,   638,  1119,  1329]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 29258,   765,  ...,  4196,    19,    12],
        [    0,   894,   496,  ...,   266,   623,   587]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  368, 2035,  ...,  266, 1122,  587],
        [   0, 3019,  278,  ...,  365, 1770,   12]], device='cuda:1')


Running epoch 0, step 82, batch 82Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,   47,   12,  ..., 4367,  278,  471],
        [   0, 1099,  644,  ..., 5481,   14, 8782]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 82, Loss: 1.2007217407226562
rank: 0, step 82, Loss: 1.215041995048523

rank: 1, step 82, Loss: 1.2107874155044556
rank: 3, step 82, Loss: 1.1952189207077026



rank 3 | epoch 0 | step 83 | batch 83


Running epoch 0, step 83, batch 83

rank 2 | epoch 0 | step 83 | batch 83

rank 0 | epoch 0 | step 83 | batch 83

Running epoch 0, step 83, batch 83

Sampled inputs[:2]: tensor([[    0, 12440,   578,  ..., 25918,   287,   996],
        [    0,   271,   768,  ..., 15555,   278,   266]], device='cuda:3')

rank 1 | epoch 0 | step 83 | batch 83


Running epoch 0, step 83, batch 83

Running epoch 0, step 83, batch 83

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  5024,  3846,  ...,  5880,  1377,    12],
        [    0,    12,   287,  ..., 12678,  2503,   401]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  3306,  4057,  ...,   287,   266,  1692],
        [    0,   278, 14971,  ...,  2341,   266,   717]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0,   266, 20604,  ...,   409, 13764,  6048],
        [    0, 29883,   680,  ...,  3363,  1049,   292]], device='cuda:0')


Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 83, Loss: 1.1935803890228271
rank: 3, step 83, Loss: 1.1865259408950806
rank: 0, step 83, Loss: 1.2292084693908691
rank: 2, step 83, Loss: 1.2130695581436157




rank 2 | epoch 0 | step 84 | batch 84

rank 3 | epoch 0 | step 84 | batch 84


Running epoch 0, step 84, batch 84


Running epoch 0, step 84, batch 84

rank 1 | epoch 0 | step 84 | batch 84


Running epoch 0, step 84, batch 84

rank 0 | epoch 0 | step 84 | batch 84
Sampled inputs[:2]: tensor([[   0,   13,  711,  ...,  591,  953,  352],
        [   0,  278, 6046,  ..., 1671,  199,  395]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   298,   669,  ...,   287, 19731,    13],
        [    0, 12987,   609,  ...,   699,  9863,  3227]], device='cuda:3')



Running epoch 0, step 84, batch 84
Sampled inputs[:2]: tensor([[   0,  894,   73,  ..., 2323,  909, 4103],
        [   0, 3951,   77,  ..., 7062,  278,  600]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13, 11273,  ...,   292,  1057,    14],
        [    0,   431, 19346,  ...,    14,  3237, 18548]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 84, Loss: 1.2127420902252197
rank: 1, step 84, Loss: 1.2078008651733398
rank: 2, step 84, Loss: 1.192276120185852
rank: 0, step 84, Loss: 1.1985032558441162




rank 2 | epoch 0 | step 85 | batch 85

rank 3 | epoch 0 | step 85 | batch 85


Running epoch 0, step 85, batch 85


Running epoch 0, step 85, batch 85

rank 1 | epoch 0 | step 85 | batch 85


Running epoch 0, step 85, batch 85

rank 0 | epoch 0 | step 85 | batch 85
Sampled inputs[:2]: tensor([[   0,   12,  401,  ...,  504,  565,  590],
        [   0,   73,   14,  ...,  650,   13, 3658]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0, 20202,   300,  ..., 15185,   287,  6573],
        [    0, 44175,   744,  ..., 16394, 26528,    12]], device='cuda:3')


Running epoch 0, step 85, batch 85
Sampled inputs[:2]: tensor([[    0, 24781,   287,  ...,   266,  3873,  1400],
        [    0,   508,   586,  ...,  6157,  3146,  7647]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13, 26335,  ...,     5,  2570, 34403],
        [    0,   221,   467,  ..., 21991,   630,  3990]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 85, Loss: 1.232201337814331
rank: 1, step 85, Loss: 1.2016212940216064
rank: 3, step 85, Loss: 1.2110494375228882

rank: 2, step 85, Loss: 1.2237247228622437



rank 3 | epoch 0 | step 86 | batch 86
rank 2 | epoch 0 | step 86 | batch 86



Running epoch 0, step 86, batch 86

Running epoch 0, step 86, batch 86


rank 1 | epoch 0 | step 86 | batch 86


Running epoch 0, step 86, batch 86

rank 0 | epoch 0 | step 86 | batch 86
Sampled inputs[:2]: tensor([[    0,   271, 16217,  ...,  6352,  4546,  2558],
        [    0,   380,  8157,  ...,   943,   352,  2278]], device='cuda:2')

Running epoch 0, step 86, batch 86
Sampled inputs[:2]: tensor([[    0,   346,   462,  ...,  2208,    12,  1901],
        [    0,   720,  1122,  ...,   656,   287, 14258]], device='cuda:3')

Sampled inputs[:2]: tensor([[   0,  413,   29,  ...,  818,  278,  970],
        [   0,  287, 2997,  ...,  437,  266, 1040]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0,  300, 5201,  ..., 1997, 7423,  417],
        [   0, 1217,    9,  ..., 1821,    5,  278]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 86, Loss: 1.1953060626983643
rank: 2, step 86, Loss: 1.2266143560409546
rank: 1, step 86, Loss: 1.2072832584381104
rank: 0, step 86, Loss: 1.2223910093307495




rank 2 | epoch 0 | step 87 | batch 87

rank 3 | epoch 0 | step 87 | batch 87


Running epoch 0, step 87, batch 87


Running epoch 0, step 87, batch 87

rank 1 | epoch 0 | step 87 | batch 87


Running epoch 0, step 87, batch 87

rank 0 | epoch 0 | step 87 | batch 87
Sampled inputs[:2]: tensor([[    0, 12449,    12,  ...,   292,  2178,   413],
        [    0,   328, 27958,  ...,   417,   199,  2038]], device='cuda:2')
Sampled inputs[:2]: tensor([[   0, 1527,  292,  ..., 2122,  278, 1911],
        [   0, 3351,  352,  ...,   17,  287,  357]], device='cuda:3')


Running epoch 0, step 87, batch 87
Sampled inputs[:2]: tensor([[    0,  6538,  1805,  ...,   298,   271,   721],
        [    0,   352,  2284,  ..., 43204,    12,   709]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   401,  3704,  ...,    14,  1062,  1804],
        [    0,    13, 30044,  ...,   381, 22105,    11]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 87, Loss: 1.2096550464630127
rank: 0, step 87, Loss: 1.2088477611541748
rank: 3, step 87, Loss: 1.2149341106414795
rank: 2, step 87, Loss: 1.1915825605392456



Graident accumulation at epoch 0, step 87, batch 87
Graident accumulation at epoch 0, step 87, batch 87
Graident accumulation at epoch 0, step 87, batch 87
Graident accumulation at epoch 0, step 87, batch 87

rank 3 | epoch 0 | step 88 | batch 88


Running epoch 0, step 88, batch 88

rank 2 | epoch 0 | step 88 | batch 88


Running epoch 0, step 88, batch 88

rank 1 | epoch 0 | step 88 | batch 88
Sampled inputs[:2]: tensor([[    0,   342,   408,  ...,  5162, 25842,  4855],
        [    0,  3398,  6361,  ..., 12942,   518,  4066]], device='cuda:3')

Running epoch 0, step 88, batch 88

Sampled inputs[:2]: tensor([[   0, 2319,   30,  ...,  508, 6703,   12],
        [   0,  273,  298,  ..., 7437, 2767,  518]], device='cuda:2')Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank 0 | epoch 0 | step 88 | batch 88
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 88, batch 88Sampled inputs[:2]: tensor([[    0,   822,  5085,  ...,   293,  1608,   391],
        [    0,   259,  1513,  ...,   275, 19511,  2350]], device='cuda:1')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  2485,    12,  ...,   293,   259, 14600],
        [    0,   287,  2026,  ..., 16374,   266,  2236]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 88, Loss: 1.2176252603530884
rank: 1, step 88, Loss: 1.2143622636795044
rank: 0, step 88, Loss: 1.20703125
rank: 2, step 88, Loss: 1.2087403535842896




rank 3 | epoch 0 | step 89 | batch 89


Running epoch 0, step 89, batch 89

rank 2 | epoch 0 | step 89 | batch 89


Running epoch 0, step 89, batch 89

rank 1 | epoch 0 | step 89 | batch 89


Running epoch 0, step 89, batch 89

rank 0 | epoch 0 | step 89 | batch 89
Sampled inputs[:2]: tensor([[   0,  494,  221,  ...,  298, 1062, 4923],
        [   0, 3086,  504,  ...,   14,  759,  935]], device='cuda:3')

Running epoch 0, step 89, batch 89
Sampled inputs[:2]: tensor([[    0,  1265,   328,  ...,  2282, 35414,    13],
        [    0,  1682,   271,  ...,   300,   266, 10935]], device='cuda:2')

Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   342,   266,  ...,  4998,  4756,  5139],
        [    0, 10565,  2677,  ...,   298,   292, 11188]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[   0, 2422,  300,  ...,  630,  729, 3400],
        [   0, 2380, 2667,  ...,   14,  381, 5621]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 89, Loss: 1.2200590372085571
rank: 1, step 89, Loss: 1.2084407806396484
rank: 2, step 89, Loss: 1.2080715894699097
rank: 3, step 89, Loss: 1.2089201211929321




rank 2 | epoch 0 | step 90 | batch 90

rank 3 | epoch 0 | step 90 | batch 90


Running epoch 0, step 90, batch 90


Running epoch 0, step 90, batch 90

rank 1 | epoch 0 | step 90 | batch 90


Running epoch 0, step 90, batch 90

rank 0 | epoch 0 | step 90 | batch 90
Sampled inputs[:2]: tensor([[   0,   17,   12,  ...,   12,  461,  806],
        [   0, 4538,  271,  ..., 1603,  591,  688]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,  2086, 10663,  ...,   271,   266,  6927],
        [    0,  1726,  3775,  ...,   300,   266,  1686]], device='cuda:3')


Running epoch 0, step 90, batch 90
Sampled inputs[:2]: tensor([[    0,    13, 15578,  ...,   221,   494,   221],
        [    0,  3532,   300,  ...,    12,   461,   806]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   221,   527,  ...,   298,   335,   298],
        [    0,   278,   266,  ...,   352, 10572,   345]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 90, Loss: 1.2075227499008179
rank: 0, step 90, Loss: 1.1936538219451904
rank: 3, step 90, Loss: 1.2225679159164429
rank: 1, step 90, Loss: 1.20698082447052




rank 2 | epoch 0 | step 91 | batch 91

rank 3 | epoch 0 | step 91 | batch 91


Running epoch 0, step 91, batch 91


Running epoch 0, step 91, batch 91

rank 1 | epoch 0 | step 91 | batch 91


Running epoch 0, step 91, batch 91

rank 0 | epoch 0 | step 91 | batch 91
Sampled inputs[:2]: tensor([[    0, 16286,  5356,  ...,   590,  2161,     5],
        [    0,   767,  9289,  ...,   494,   287,  8957]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   271, 12472,  ...,   374,    29,    16],
        [    0,   607,   443,  ...,   259,  2646,  1597]], device='cuda:3')

Running epoch 0, step 91, batch 91

Sampled inputs[:2]: tensor([[   0,  638, 1862,  ...,   14, 7869,   14],
        [   0,  266,  452,  ..., 1725, 2200,  342]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   271, 16084,  ...,   688,  1122,    12],
        [    0,  3529,   271,  ...,  1553,   365,  2714]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 91, Loss: 1.2145335674285889
rank: 3, step 91, Loss: 1.2248923778533936
rank: 1, step 91, Loss: 1.2032452821731567


rank: 2, step 91, Loss: 1.2089581489562988


rank 1 | epoch 0 | step 92 | batch 92

rank 2 | epoch 0 | step 92 | batch 92


Running epoch 0, step 92, batch 92


Running epoch 0, step 92, batch 92

rank 3 | epoch 0 | step 92 | batch 92


Running epoch 0, step 92, batch 92

rank 0 | epoch 0 | step 92 | batch 92Sampled inputs[:2]: tensor([[    0,   221,   422,  ...,  2693,   733,   381],
        [    0, 44210,    89,  ...,    43,  1707,   266]], device='cuda:1')Sampled inputs[:2]: tensor([[   0,  298,  369,  ..., 5936,  968,  259],
        [   0,  518, 9048,  ..., 1354,  352,  266]], device='cuda:2')




Running epoch 0, step 92, batch 92Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Sampled inputs[:2]: tensor([[    0, 19444,  6307,  ...,    13, 38005,  1447],
        [    0, 23749, 27341,  ..., 34110,   342,  9672]], device='cuda:3')



Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0, 13964,    13,  ...,    14,   560,   199],
        [    0,   278,   795,  ...,  1774, 14474,   367]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 92, Loss: 1.2072253227233887
rank: 3, step 92, Loss: 1.2169578075408936
rank: 2, step 92, Loss: 1.2041137218475342



rank: 0, step 92, Loss: 1.198766827583313

rank 2 | epoch 0 | step 93 | batch 93
rank 3 | epoch 0 | step 93 | batch 93



Running epoch 0, step 93, batch 93

Running epoch 0, step 93, batch 93


rank 1 | epoch 0 | step 93 | batch 93


Running epoch 0, step 93, batch 93

rank 0 | epoch 0 | step 93 | batch 93
Sampled inputs[:2]: tensor([[   0, 6124, 1209,  ..., 1176, 3164,  271],
        [   0,   12, 4856,  ...,  342,  266, 1040]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,   266, 10726,  ..., 13973, 22191, 15913],
        [    0,  1932,    15,  ...,   344,   984,   344]], device='cuda:3')



Running epoch 0, step 93, batch 93
Sampled inputs[:2]: tensor([[    0,    13,  1924,  ...,  2117,   300, 26473],
        [    0,   271, 21394,  ...,  1487,   287,   292]], device='cuda:1')
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  4890,  1528,  ...,   847,   328,  1703],
        [    0, 41921,  1955,  ...,    75,   221,   334]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 93, Loss: 1.2169674634933472
rank: 1, step 93, Loss: 1.2050154209136963
rank: 0, step 93, Loss: 1.221701741218567

rank: 2, step 93, Loss: 1.2015345096588135



rank 2 | epoch 0 | step 94 | batch 94
rank 3 | epoch 0 | step 94 | batch 94



Running epoch 0, step 94, batch 94

Running epoch 0, step 94, batch 94


rank 1 | epoch 0 | step 94 | batch 94


Running epoch 0, step 94, batch 94

rank 0 | epoch 0 | step 94 | batch 94


Running epoch 0, step 94, batch 94Sampled inputs[:2]: tensor([[    0, 18981,    13,  ...,   365,  2714,   408],
        [    0,  4878,   607,  ...,    14, 17331,   287]], device='cuda:2')Sampled inputs[:2]: tensor([[    0,  3543,   391,  ...,  3370,  2926,  8090],
        [    0,   380,  3584,  ..., 24402,  2057,     9]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,  1624,   391,  ...,   391, 36249,   259],
        [    0,   259,  2283,  ...,   462,   221,   474]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,    13,    19,  ..., 22111,  2489,    14],
        [    0,    55,  2258,  ..., 32764,    75,   338]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 94, Loss: 1.2034183740615845
rank: 2, step 94, Loss: 1.224137544631958
rank: 1, step 94, Loss: 1.22374427318573
rank: 0, step 94, Loss: 1.21312415599823




rank 2 | epoch 0 | step 95 | batch 95
rank 3 | epoch 0 | step 95 | batch 95



Running epoch 0, step 95, batch 95

Running epoch 0, step 95, batch 95


rank 1 | epoch 0 | step 95 | batch 95


Running epoch 0, step 95, batch 95

rank 0 | epoch 0 | step 95 | batch 95
Sampled inputs[:2]: tensor([[    0,   292,    33,  ..., 32754,   300, 14476],
        [    0, 21891,     9,  ...,  5216,   717,   287]], device='cuda:2')

Running epoch 0, step 95, batch 95
Sampled inputs[:2]: tensor([[    0,  8450,   292,  ...,   352,   722, 37719],
        [    0,  3103,  2134,  ...,  6627,   275,  1911]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,  1832,   292,  ...,  2176,  1345,    14],
        [    0, 23230,    12,  ...,  5092,   741,   266]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  1034,  5599,  ...,   259,   586,  1403],
        [    0,  7314,    19,  ...,  8350,   365, 13801]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 95, Loss: 1.2065160274505615
rank: 0, step 95, Loss: 1.22315514087677
rank: 3, step 95, Loss: 1.2109051942825317
rank: 2, step 95, Loss: 1.2245888710021973



Graident accumulation at epoch 0, step 95, batch 95
Graident accumulation at epoch 0, step 95, batch 95
Graident accumulation at epoch 0, step 95, batch 95
Graident accumulation at epoch 0, step 95, batch 95

rank 2 | epoch 0 | step 96 | batch 96


Running epoch 0, step 96, batch 96

rank 1 | epoch 0 | step 96 | batch 96


Running epoch 0, step 96, batch 96

rank 3 | epoch 0 | step 96 | batch 96


Running epoch 0, step 96, batch 96
Sampled inputs[:2]: tensor([[    0,  1075, 14981,  ...,   221,   380,  1075],
        [    0,  1254,  1773,  ..., 19459,  2447,  2613]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   401,  3408,  ...,   287, 19892,   328],
        [    0,    12,   328,  ...,   908,  1086,    12]], device='cuda:1')Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


rank 0 | epoch 0 | step 96 | batch 96Sampled inputs[:2]: tensor([[   0,  298,  894,  ..., 7605, 3220,  259],
        [   0,   12,  287,  ...,  298, 9855,  278]], device='cuda:3')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 96, batch 96Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Sampled inputs[:2]: tensor([[    0,   278,   266,  ..., 10639,   292,  4723],
        [    0,  3393,  3380,  ...,   292,  6502,   950]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 2, step 96, Loss: 1.2155466079711914
rank: 0, step 96, Loss: 1.1784539222717285
rank: 3, step 96, Loss: 1.2027665376663208
rank: 1, step 96, Loss: 1.1993941068649292




rank 2 | epoch 0 | step 97 | batch 97
rank 3 | epoch 0 | step 97 | batch 97



Running epoch 0, step 97, batch 97

Running epoch 0, step 97, batch 97


rank 1 | epoch 0 | step 97 | batch 97


Running epoch 0, step 97, batch 97

rank 0 | epoch 0 | step 97 | batch 97


Running epoch 0, step 97, batch 97Sampled inputs[:2]: tensor([[   0, 1640, 1103,  ...,  685, 1478,   14],
        [   0, 6010,  829,  ...,  668, 1784,  587]], device='cuda:2')
Sampled inputs[:2]: tensor([[    0,   515,   352,  ...,    40, 25575,   292],
        [    0,    22,  2577,  ...,  4970,     9,  3868]], device='cuda:3')

Sampled inputs[:2]: tensor([[    0,   471,    14,  ...,  1260,  2129,   367],
        [    0, 43587,  1390,  ...,    12,   768,  1952]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,  9577,  2789,  ...,  1042,  9086,   623],
        [    0, 42306,   278,  ...,  1110,  3427,  4224]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 3, step 97, Loss: 1.2214046716690063
rank: 0, step 97, Loss: 1.2104783058166504
rank: 1, step 97, Loss: 1.1887714862823486
rank: 2, step 97, Loss: 1.1993523836135864




rank 2 | epoch 0 | step 98 | batch 98
rank 3 | epoch 0 | step 98 | batch 98



Running epoch 0, step 98, batch 98

Running epoch 0, step 98, batch 98


rank 1 | epoch 0 | step 98 | batch 98


Running epoch 0, step 98, batch 98

rank 0 | epoch 0 | step 98 | batch 98


Running epoch 0, step 98, batch 98Sampled inputs[:2]: tensor([[    0,   685,   344,  ...,   680,   401,   616],
        [    0,   389, 18984,  ...,   287,   768,  1070]], device='cuda:2')Sampled inputs[:2]: tensor([[   0, 1503, 1785,  ...,  221,  380, 1869],
        [   0,   12,  344,  ...,   14, 2295,  516]], device='cuda:3')


Sampled inputs[:2]: tensor([[    0,    12,   287,  ...,    12,  5576,    12],
        [    0,   508, 12163,  ...,  4920,   344, 11003]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   892,   271,  ...,   278,   266, 10237],
        [    0,    69,   462,  ...,   437,   266,   634]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 0, step 98, Loss: 1.1921991109848022
rank: 3, step 98, Loss: 1.2112118005752563
rank: 2, step 98, Loss: 1.1979190111160278
rank: 1, step 98, Loss: 1.2174376249313354




rank 2 | epoch 0 | step 99 | batch 99


Running epoch 0, step 99, batch 99

rank 1 | epoch 0 | step 99 | batch 99


Running epoch 0, step 99, batch 99

rank 3 | epoch 0 | step 99 | batch 99


Running epoch 0, step 99, batch 99
Sampled inputs[:2]: tensor([[   0,  591,  688,  ...,  271, 3390,   12],
        [   0, 1580,  271,  ...,  656,  943, 1883]], device='cuda:2')

rank 0 | epoch 0 | step 99 | batch 99
Sampled inputs[:2]: tensor([[    0,  1358,   367,  ...,  1758,  2921,    12],
        [    0,   259, 19567,  ...,   266,  3899,  2123]], device='cuda:1')
Random states for rank 2:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]


Running epoch 0, step 99, batch 99Sampled inputs[:2]: tensor([[    0,  5041,    14,  ...,  1027,  1722,  6554],
        [    0,  7294, 23782,  ...,   471, 11528,  3437]], device='cuda:3')

Random states for rank 1:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Random states for rank 3:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
Sampled inputs[:2]: tensor([[    0,   271,  4787,  ...,   292,   494,   221],
        [    0,  4601,   328,  ..., 10258,  2282,    12]], device='cuda:0')
Random states for rank 0:
random=(2147483648, 163610392, 3414454684, 213706556, 4107842212, 2345084137, 1370141154, 308032203, 1333762497, 62788148),
np_random=[         1 1812433254 3713160357 3109174145   64984499 3392658084
  446538473 2629760756 2453345558 1394803949],
torch=[1, 0, 0, 0, 0, 0, 0, 0, 111, 2],
torch_cuda=[255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

rank: 1, step 99, Loss: 1.2069308757781982
rank: 0, step 99, Loss: 1.189834713935852
rank: 3, step 99, Loss: 1.2065831422805786
rank: 2, step 99, Loss: 1.2047874927520752



wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:          Batch ‚ñÅ‚ñÅ
wandb:          Epoch ‚ñÅ‚ñÅ
wandb:  Learning Rate ‚ñÅ‚ñÅ
wandb:   Training PPL ‚ñÅ
wandb: Validation PPL ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          Batch 79
wandb:          Epoch 0
wandb:  Learning Rate 2e-05
wandb:   Training PPL 17295.30152
wandb: Validation PPL 15842.94824
wandb: 
wandb: üöÄ View run frosty-sound-328 at: https://wandb.ai/kenotron/brainlessgpt/runs/p9p7llg2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250326_150128-p9p7llg2/logs
